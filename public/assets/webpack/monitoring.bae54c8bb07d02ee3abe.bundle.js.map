{"version":3,"sources":["webpack:///monitoring.bae54c8bb07d02ee3abe.bundle.js","webpack:///./lib/utils/http_status.js?3fa3***","webpack:///./monitoring/constants.js","webpack:///./monitoring/deployments.js","webpack:///./monitoring/monitoring_bundle.js","webpack:///./monitoring/prometheus_graph.js"],"names":["webpackJsonp","./lib/utils/http_status.js","module","__webpack_exports__","__webpack_require__","NO_CONTENT","OK","./monitoring/constants.js","d","dateFormat","timeFormat","__WEBPACK_IMPORTED_MODULE_0_d3__","__WEBPACK_IMPORTED_MODULE_0_d3___default","n","a","time","format","./monitoring/deployments.js","$","_classCallCheck","instance","Constructor","TypeError","__WEBPACK_IMPORTED_MODULE_1__constants__","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","Deployments","width","height","this","endpoint","document","getElementById","dataset","deploymentEndpoint","createGradientDef","value","chartData","x","scale","range","domain","extent","charts","selectAll","getData","_this","ajax","url","dataType","fail","Flash","done","data","deployments","reduce","deploymentDataArray","deployment","Date","created_at","xPos","Math","floor","setSeconds","getSeconds","push","id","sha","tag","ref","name","plotData","_this2","each","svg","select","chart","node","getAttribute","createLine","createDeployInfoBox","append","attr","offset","stop-color","stop-opacity","selectParentNode","class","enter","transform","y","fill","x1","x2","y1","y2","querySelector","rx","text","refText","mouseXPos","dataFound","forEach","toggleDeployTextbox","parentNode","deploy","showInfoBox","classed","slice","call","./monitoring/monitoring_bundle.js","__WEBPACK_IMPORTED_MODULE_0__prometheus_graph__","addEventListener","onLoad","removeEventListener","./monitoring/prometheus_graph.js","__WEBPACK_IMPORTED_MODULE_1__lib_utils_http_status__","__WEBPACK_IMPORTED_MODULE_2__deployments__","__WEBPACK_IMPORTED_MODULE_3__lib_utils_common_utils__","__WEBPACK_IMPORTED_MODULE_4__lib_utils_number_utils__","__WEBPACK_IMPORTED_MODULE_5__flash__","__WEBPACK_IMPORTED_MODULE_6__constants__","prometheusContainer","prometheusGraphsContainer","bisectDate","bisector","left","extraAddedWidthParent","PrometheusGraph","$prometheusContainer","hasMetrics","docLink","integrationLink","state","ajaxError","margin","top","right","bottom","marginLabelContainer","parentContainerWidth","parent","originalWidth","originalHeight","backOffRequestCounter","configureGraph","init","prevState","updateState","keys","graphSpecificProperties","plotValues","then","metricsResponse","enoughData","metrics","values","hide","show","transformData","createGraph","firstMetricData","graphSpecifics","linear","xScale","yScale","prometheusGraphContainer","axisLabelContainer","max","map","metricValue","xAxis","axis","ticks","commonGraphProperties","axis_no_ticks","orient","yAxis","tickSize","outerTickSize","createAxisLabelContainers","area","y0","interpolate","line","datum","area_fill_color","line_color","area_stroke_width","on","handleMouseOverGraph","bind","graph_legend_title","style","_this3","rectOverlay","currentXCoordinate","mouse","currentGraphProps","timeValueOverlay","invert","overlayIndex","d0","d1","evalTime","currentData","currentTimeCoordinate","currentDeployXPos","mouseOverDeployInfo","currentPrometheusGraphContainer","maxValueFromData","maxMetricValue","remove","currentChart","circle_radius_metric","rectTextMetric","rect_text_width","rect_text_height","currentMetricValue","cpu_values","memory_values","median_total_characters","_this4","gl","utils","backOff","next","stop","statusText","resp","status","Error","success","catch","_this5","metricValues","metric","$statesContainer","addClass","removeClass"],"mappings":"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","file":"monitoring.bae54c8bb07d02ee3abe.bundle.js","sourcesContent":["webpackJsonp([\"monitoring\"],{\n\n/***/ \"./lib/utils/http_status.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/**\n * exports HTTP status codes\n */\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  NO_CONTENT: 204,\n  OK: 200\n});\n\n/***/ }),\n\n/***/ \"./monitoring/constants.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return dateFormat; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return timeFormat; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_d3__ = __webpack_require__(\"../../../node_modules/d3/d3.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_d3___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_d3__);\n\n\nvar dateFormat = __WEBPACK_IMPORTED_MODULE_0_d3___default.a.time.format('%b %d, %Y');\nvar timeFormat = __WEBPACK_IMPORTED_MODULE_0_d3___default.a.time.format('%H:%M%p');\n\n/***/ }),\n\n/***/ \"./monitoring/deployments.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function($) {/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_d3__ = __webpack_require__(\"../../../node_modules/d3/d3.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_d3___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_d3__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__constants__ = __webpack_require__(\"./monitoring/constants.js\");\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/* global Flash */\n\n\n\nvar Deployments = function () {\n  function Deployments(width, height) {\n    _classCallCheck(this, Deployments);\n\n    this.width = width;\n    this.height = height;\n\n    this.endpoint = document.getElementById('js-metrics').dataset.deploymentEndpoint;\n\n    this.createGradientDef();\n  }\n\n  _createClass(Deployments, [{\n    key: 'init',\n    value: function init(chartData) {\n      this.chartData = chartData;\n\n      this.x = __WEBPACK_IMPORTED_MODULE_0_d3___default.a.time.scale().range([0, this.width]);\n      this.x.domain(__WEBPACK_IMPORTED_MODULE_0_d3___default.a.extent(this.chartData, function (d) {\n        return d.time;\n      }));\n\n      this.charts = __WEBPACK_IMPORTED_MODULE_0_d3___default.a.selectAll('.prometheus-graph');\n\n      this.getData();\n    }\n  }, {\n    key: 'getData',\n    value: function getData() {\n      var _this = this;\n\n      $.ajax({\n        url: this.endpoint,\n        dataType: 'JSON'\n      }).fail(function () {\n        return new Flash('Error getting deployment information.');\n      }).done(function (data) {\n        _this.data = data.deployments.reduce(function (deploymentDataArray, deployment) {\n          var time = new Date(deployment.created_at);\n          var xPos = Math.floor(_this.x(time));\n\n          time.setSeconds(_this.chartData[0].time.getSeconds());\n\n          if (xPos >= 0) {\n            deploymentDataArray.push({\n              id: deployment.id,\n              time: time,\n              sha: deployment.sha,\n              tag: deployment.tag,\n              ref: deployment.ref.name,\n              xPos: xPos\n            });\n          }\n\n          return deploymentDataArray;\n        }, []);\n\n        _this.plotData();\n      });\n    }\n  }, {\n    key: 'plotData',\n    value: function plotData() {\n      var _this2 = this;\n\n      this.charts.each(function (d, i) {\n        var svg = __WEBPACK_IMPORTED_MODULE_0_d3___default.a.select(_this2.charts[0][i]);\n        var chart = svg.select('.graph-container');\n        var key = svg.node().getAttribute('graph-type');\n\n        _this2.createLine(chart, key);\n        _this2.createDeployInfoBox(chart, key);\n      });\n    }\n  }, {\n    key: 'createGradientDef',\n    value: function createGradientDef() {\n      var defs = __WEBPACK_IMPORTED_MODULE_0_d3___default.a.select('body').append('svg').attr({\n        height: 0,\n        width: 0\n      }).append('defs');\n\n      defs.append('linearGradient').attr({\n        id: 'shadow-gradient'\n      }).append('stop').attr({\n        offset: '0%',\n        'stop-color': '#000',\n        'stop-opacity': 0.4\n      }).select(this.selectParentNode).append('stop').attr({\n        offset: '100%',\n        'stop-color': '#000',\n        'stop-opacity': 0\n      });\n    }\n  }, {\n    key: 'createLine',\n    value: function createLine(chart, key) {\n      chart.append('g').attr({\n        class: 'deploy-info'\n      }).selectAll('.deploy-info').data(this.data).enter().append('g').attr({\n        class: function _class(d) {\n          return 'deploy-info-' + d.id + '-' + key;\n        },\n        transform: function transform(d) {\n          return 'translate(' + (Math.floor(d.xPos) + 1) + ', 0)';\n        }\n      }).append('rect').attr({\n        x: 1,\n        y: 0,\n        height: this.height + 1,\n        width: 3,\n        fill: 'url(#shadow-gradient)'\n      }).select(this.selectParentNode).append('line').attr({\n        class: 'deployment-line',\n        x1: 0,\n        x2: 0,\n        y1: 0,\n        y2: this.height + 1\n      });\n    }\n  }, {\n    key: 'createDeployInfoBox',\n    value: function createDeployInfoBox(chart, key) {\n      chart.selectAll('.deploy-info').selectAll('.js-deploy-info-box').data(this.data).enter().select(function (d) {\n        return document.querySelector('.deploy-info-' + d.id + '-' + key);\n      }).append('svg').attr({\n        class: 'js-deploy-info-box hidden',\n        x: 3,\n        y: 0,\n        width: 92,\n        height: 60\n      }).append('rect').attr({\n        class: 'rect-text-metric deploy-info-rect rect-metric',\n        x: 1,\n        y: 1,\n        rx: 2,\n        width: 90,\n        height: 58\n      }).select(this.selectParentNode).append('g').attr({\n        transform: 'translate(5, 2)'\n      }).append('text').attr({\n        class: 'deploy-info-text text-metric-bold'\n      }).text(Deployments.refText).select(this.selectParentNode).append('text').attr({\n        class: 'deploy-info-text',\n        y: 18\n      }).text(function (d) {\n        return __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__constants__[\"b\" /* dateFormat */])(d.time);\n      }).select(this.selectParentNode).append('text').attr({\n        class: 'deploy-info-text text-metric-bold',\n        y: 38\n      }).text(function (d) {\n        return __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__constants__[\"a\" /* timeFormat */])(d.time);\n      });\n    }\n  }, {\n    key: 'mouseOverDeployInfo',\n    value: function mouseOverDeployInfo(mouseXPos, key) {\n      if (!this.data) return false;\n\n      var dataFound = false;\n\n      this.data.forEach(function (d) {\n        if (d.xPos >= mouseXPos - 10 && d.xPos <= mouseXPos + 10 && !dataFound) {\n          dataFound = d.xPos + 1;\n\n          Deployments.toggleDeployTextbox(d, key, true);\n        } else {\n          Deployments.toggleDeployTextbox(d, key, false);\n        }\n      });\n\n      return dataFound;\n    }\n\n    /* `this` is bound to the D3 node */\n\n  }, {\n    key: 'selectParentNode',\n    value: function selectParentNode() {\n      return this.parentNode;\n    }\n  }], [{\n    key: 'toggleDeployTextbox',\n    value: function toggleDeployTextbox(deploy, key, showInfoBox) {\n      __WEBPACK_IMPORTED_MODULE_0_d3___default.a.selectAll('.deploy-info-' + deploy.id + '-' + key + ' .js-deploy-info-box').classed('hidden', !showInfoBox);\n    }\n  }, {\n    key: 'refText',\n    value: function refText(d) {\n      return d.tag ? d.ref : d.sha.slice(0, 6);\n    }\n  }]);\n\n  return Deployments;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Deployments);\n/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(\"../../../node_modules/jquery/dist/jquery.js\")))\n\n/***/ }),\n\n/***/ \"./monitoring/monitoring_bundle.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__prometheus_graph__ = __webpack_require__(\"./monitoring/prometheus_graph.js\");\n\n\ndocument.addEventListener('DOMContentLoaded', function onLoad() {\n  document.removeEventListener('DOMContentLoaded', onLoad, false);\n  return new __WEBPACK_IMPORTED_MODULE_0__prometheus_graph__[\"a\" /* default */]();\n}, false);\n\n/***/ }),\n\n/***/ \"./monitoring/prometheus_graph.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function($) {/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_d3__ = __webpack_require__(\"../../../node_modules/d3/d3.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_d3___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_d3__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__lib_utils_http_status__ = __webpack_require__(\"./lib/utils/http_status.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__deployments__ = __webpack_require__(\"./monitoring/deployments.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__lib_utils_common_utils__ = __webpack_require__(\"./lib/utils/common_utils.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__lib_utils_common_utils___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3__lib_utils_common_utils__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__lib_utils_number_utils__ = __webpack_require__(\"./lib/utils/number_utils.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__flash__ = __webpack_require__(\"./flash.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__flash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5__flash__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__constants__ = __webpack_require__(\"./monitoring/constants.js\");\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/* eslint-disable no-new */\n/* global Flash */\n\n\n\n\n\n\n\n\n\nvar prometheusContainer = '.prometheus-container';\nvar prometheusParentGraphContainer = '.prometheus-graphs';\nvar prometheusGraphsContainer = '.prometheus-graph';\nvar prometheusStatesContainer = '.prometheus-state';\nvar metricsEndpoint = 'metrics.json';\nvar bisectDate = __WEBPACK_IMPORTED_MODULE_0_d3___default.a.bisector(function (d) {\n  return d.time;\n}).left;\nvar extraAddedWidthParent = 100;\n\nvar PrometheusGraph = function () {\n  function PrometheusGraph() {\n    _classCallCheck(this, PrometheusGraph);\n\n    var $prometheusContainer = $(prometheusContainer);\n    var hasMetrics = $prometheusContainer.data('has-metrics');\n    this.docLink = $prometheusContainer.data('doc-link');\n    this.integrationLink = $prometheusContainer.data('prometheus-integration');\n    this.state = '';\n\n    $(document).ajaxError(function () {});\n\n    if (hasMetrics) {\n      this.margin = { top: 80, right: 180, bottom: 80, left: 100 };\n      this.marginLabelContainer = { top: 40, right: 0, bottom: 40, left: 0 };\n      var parentContainerWidth = $(prometheusGraphsContainer).parent().width() + extraAddedWidthParent;\n      this.originalWidth = parentContainerWidth;\n      this.originalHeight = 330;\n      this.width = parentContainerWidth - this.margin.left - this.margin.right;\n      this.height = this.originalHeight - this.margin.top - this.margin.bottom;\n      this.backOffRequestCounter = 0;\n      this.deployments = new __WEBPACK_IMPORTED_MODULE_2__deployments__[\"a\" /* default */](this.width, this.height);\n      this.configureGraph();\n      this.init();\n    } else {\n      var prevState = this.state;\n      this.state = '.js-getting-started';\n      this.updateState(prevState);\n    }\n  }\n\n  _createClass(PrometheusGraph, [{\n    key: 'createGraph',\n    value: function createGraph() {\n      var _this = this;\n\n      Object.keys(this.graphSpecificProperties).forEach(function (key) {\n        var value = _this.graphSpecificProperties[key];\n        if (value.data.length > 0) {\n          _this.plotValues(key);\n        }\n      });\n    }\n  }, {\n    key: 'init',\n    value: function init() {\n      var _this2 = this;\n\n      return this.getData().then(function (metricsResponse) {\n        var enoughData = true;\n        if (typeof metricsResponse === 'undefined') {\n          enoughData = false;\n        } else {\n          Object.keys(metricsResponse.metrics).forEach(function (key) {\n            if (key === 'cpu_values' || key === 'memory_values') {\n              var currentData = metricsResponse.metrics[key][0];\n              if (currentData.values.length <= 2) {\n                enoughData = false;\n              }\n            }\n          });\n        }\n        if (enoughData) {\n          $(prometheusStatesContainer).hide();\n          $(prometheusParentGraphContainer).show();\n          _this2.transformData(metricsResponse);\n          _this2.createGraph();\n\n          var firstMetricData = _this2.graphSpecificProperties[Object.keys(_this2.graphSpecificProperties)[0]].data;\n\n          _this2.deployments.init(firstMetricData);\n        }\n      });\n    }\n  }, {\n    key: 'plotValues',\n    value: function plotValues(key) {\n      var graphSpecifics = this.graphSpecificProperties[key];\n\n      var x = __WEBPACK_IMPORTED_MODULE_0_d3___default.a.time.scale().range([0, this.width]);\n\n      var y = __WEBPACK_IMPORTED_MODULE_0_d3___default.a.scale.linear().range([this.height, 0]);\n\n      graphSpecifics.xScale = x;\n      graphSpecifics.yScale = y;\n\n      var prometheusGraphContainer = prometheusGraphsContainer + '[graph-type=' + key + ']';\n\n      var chart = __WEBPACK_IMPORTED_MODULE_0_d3___default.a.select(prometheusGraphContainer).attr('width', this.width + this.margin.left + this.margin.right).attr('height', this.height + this.margin.bottom + this.margin.top).append('g').attr('class', 'graph-container').attr('transform', 'translate(' + this.margin.left + ',' + this.margin.top + ')');\n\n      var axisLabelContainer = __WEBPACK_IMPORTED_MODULE_0_d3___default.a.select(prometheusGraphContainer).attr('width', this.originalWidth).attr('height', this.originalHeight).append('g').attr('transform', 'translate(' + this.marginLabelContainer.left + ',' + this.marginLabelContainer.top + ')');\n\n      x.domain(__WEBPACK_IMPORTED_MODULE_0_d3___default.a.extent(graphSpecifics.data, function (d) {\n        return d.time;\n      }));\n      y.domain([0, __WEBPACK_IMPORTED_MODULE_0_d3___default.a.max(graphSpecifics.data.map(function (metricValue) {\n        return metricValue.value;\n      }))]);\n\n      var xAxis = __WEBPACK_IMPORTED_MODULE_0_d3___default.a.svg.axis().scale(x).ticks(this.commonGraphProperties.axis_no_ticks).orient('bottom');\n\n      var yAxis = __WEBPACK_IMPORTED_MODULE_0_d3___default.a.svg.axis().scale(y).ticks(this.commonGraphProperties.axis_no_ticks).tickSize(-this.width).outerTickSize(0).orient('left');\n\n      this.createAxisLabelContainers(axisLabelContainer, key);\n\n      chart.append('g').attr('class', 'x-axis').attr('transform', 'translate(0,' + this.height + ')').call(xAxis);\n\n      chart.append('g').attr('class', 'y-axis').call(yAxis);\n\n      var area = __WEBPACK_IMPORTED_MODULE_0_d3___default.a.svg.area().x(function (d) {\n        return x(d.time);\n      }).y0(this.height).y1(function (d) {\n        return y(d.value);\n      }).interpolate('linear');\n\n      var line = __WEBPACK_IMPORTED_MODULE_0_d3___default.a.svg.line().x(function (d) {\n        return x(d.time);\n      }).y(function (d) {\n        return y(d.value);\n      });\n\n      chart.append('path').datum(graphSpecifics.data).attr('d', area).attr('class', 'metric-area').attr('fill', graphSpecifics.area_fill_color);\n\n      chart.append('path').datum(graphSpecifics.data).attr('class', 'metric-line').attr('stroke', graphSpecifics.line_color).attr('fill', 'none').attr('stroke-width', this.commonGraphProperties.area_stroke_width).attr('d', line);\n\n      // Overlay area for the mouseover events\n      chart.append('rect').attr('class', 'prometheus-graph-overlay').attr('width', this.width).attr('height', this.height).on('mousemove', this.handleMouseOverGraph.bind(this, prometheusGraphContainer));\n    }\n\n    // The legends from the metric\n\n  }, {\n    key: 'createAxisLabelContainers',\n    value: function createAxisLabelContainers(axisLabelContainer, key) {\n      var graphSpecifics = this.graphSpecificProperties[key];\n\n      axisLabelContainer.append('line').attr('class', 'label-x-axis-line').attr('stroke', '#000000').attr('stroke-width', '1').attr({\n        x1: 10,\n        y1: this.originalHeight - this.margin.top,\n        x2: this.originalWidth - this.margin.right + 10,\n        y2: this.originalHeight - this.margin.top\n      });\n\n      axisLabelContainer.append('line').attr('class', 'label-y-axis-line').attr('stroke', '#000000').attr('stroke-width', '1').attr({\n        x1: 10,\n        y1: 0,\n        x2: 10,\n        y2: this.originalHeight - this.margin.top\n      });\n\n      axisLabelContainer.append('rect').attr('class', 'rect-axis-text').attr('x', 0).attr('y', 50).attr('width', 30).attr('height', 150);\n\n      axisLabelContainer.append('text').attr('class', 'label-axis-text').attr('text-anchor', 'middle').attr('transform', 'translate(15, ' + (this.originalHeight - this.margin.top) / 2 + ') rotate(-90)').text(graphSpecifics.graph_legend_title);\n\n      axisLabelContainer.append('rect').attr('class', 'rect-axis-text').attr('x', this.originalWidth / 2 - this.margin.right).attr('y', this.originalHeight - 100).attr('width', 30).attr('height', 80);\n\n      axisLabelContainer.append('text').attr('class', 'label-axis-text').attr('x', this.originalWidth / 2 - this.margin.right).attr('y', this.originalHeight - this.margin.top).attr('dy', '.35em').text('Time');\n\n      // Legends\n\n      // Metric Usage\n      axisLabelContainer.append('rect').attr('x', this.originalWidth - 170).attr('y', this.originalHeight / 2 - 60).style('fill', graphSpecifics.area_fill_color).attr('width', 20).attr('height', 35);\n\n      axisLabelContainer.append('text').attr('class', 'text-metric-title').attr('x', this.originalWidth - 140).attr('y', this.originalHeight / 2 - 50).text('Average');\n\n      axisLabelContainer.append('text').attr('class', 'text-metric-usage').attr('x', this.originalWidth - 140).attr('y', this.originalHeight / 2 - 25);\n    }\n  }, {\n    key: 'handleMouseOverGraph',\n    value: function handleMouseOverGraph(prometheusGraphContainer) {\n      var _this3 = this;\n\n      var rectOverlay = document.querySelector(prometheusGraphContainer + ' .prometheus-graph-overlay');\n      var currentXCoordinate = __WEBPACK_IMPORTED_MODULE_0_d3___default.a.mouse(rectOverlay)[0];\n\n      Object.keys(this.graphSpecificProperties).forEach(function (key) {\n        var currentGraphProps = _this3.graphSpecificProperties[key];\n        var timeValueOverlay = currentGraphProps.xScale.invert(currentXCoordinate);\n        var overlayIndex = bisectDate(currentGraphProps.data, timeValueOverlay, 1);\n        var d0 = currentGraphProps.data[overlayIndex - 1];\n        var d1 = currentGraphProps.data[overlayIndex];\n        var evalTime = timeValueOverlay - d0.time > d1.time - timeValueOverlay;\n        var currentData = evalTime ? d1 : d0;\n        var currentTimeCoordinate = Math.floor(currentGraphProps.xScale(currentData.time));\n        var currentDeployXPos = _this3.deployments.mouseOverDeployInfo(currentXCoordinate, key);\n        var currentPrometheusGraphContainer = prometheusGraphsContainer + '[graph-type=' + key + ']';\n        var maxValueFromData = __WEBPACK_IMPORTED_MODULE_0_d3___default.a.max(currentGraphProps.data.map(function (metricValue) {\n          return metricValue.value;\n        }));\n        var maxMetricValue = currentGraphProps.yScale(maxValueFromData);\n\n        // Clear up all the pieces of the flag\n        __WEBPACK_IMPORTED_MODULE_0_d3___default.a.selectAll(currentPrometheusGraphContainer + ' .selected-metric-line').remove();\n        __WEBPACK_IMPORTED_MODULE_0_d3___default.a.selectAll(currentPrometheusGraphContainer + ' .circle-metric').remove();\n        __WEBPACK_IMPORTED_MODULE_0_d3___default.a.selectAll(currentPrometheusGraphContainer + ' .rect-text-metric:not(.deploy-info-rect)').remove();\n\n        var currentChart = __WEBPACK_IMPORTED_MODULE_0_d3___default.a.select(currentPrometheusGraphContainer).select('g');\n        currentChart.append('line').attr({\n          class: (currentDeployXPos ? 'hidden' : '') + ' selected-metric-line',\n          x1: currentTimeCoordinate,\n          y1: currentGraphProps.yScale(0),\n          x2: currentTimeCoordinate,\n          y2: maxMetricValue\n        });\n\n        currentChart.append('circle').attr('class', 'circle-metric').attr('fill', currentGraphProps.line_color).attr('cx', currentDeployXPos || currentTimeCoordinate).attr('cy', currentGraphProps.yScale(currentData.value)).attr('r', _this3.commonGraphProperties.circle_radius_metric);\n\n        if (currentDeployXPos) return;\n\n        // The little box with text\n        var rectTextMetric = currentChart.append('svg').attr({\n          class: 'rect-text-metric',\n          x: currentTimeCoordinate,\n          y: 0\n        });\n\n        rectTextMetric.append('rect').attr({\n          class: 'rect-metric',\n          x: 4,\n          y: 1,\n          rx: 2,\n          width: _this3.commonGraphProperties.rect_text_width,\n          height: _this3.commonGraphProperties.rect_text_height\n        });\n\n        rectTextMetric.append('text').attr({\n          class: 'text-metric text-metric-bold',\n          x: 8,\n          y: 35\n        }).text(__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_6__constants__[\"a\" /* timeFormat */])(currentData.time));\n\n        rectTextMetric.append('text').attr({\n          class: 'text-metric-date',\n          x: 8,\n          y: 15\n        }).text(__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_6__constants__[\"b\" /* dateFormat */])(currentData.time));\n\n        var currentMetricValue = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_utils_number_utils__[\"b\" /* formatRelevantDigits */])(currentData.value);\n        if (key === 'cpu_values') {\n          currentMetricValue = currentMetricValue + '%';\n        } else {\n          currentMetricValue = currentMetricValue + ' MB';\n        }\n\n        __WEBPACK_IMPORTED_MODULE_0_d3___default.a.select(currentPrometheusGraphContainer + ' .text-metric-usage').text(currentMetricValue);\n      });\n    }\n  }, {\n    key: 'configureGraph',\n    value: function configureGraph() {\n      this.graphSpecificProperties = {\n        cpu_values: {\n          area_fill_color: '#edf3fc',\n          line_color: '#5b99f7',\n          graph_legend_title: 'CPU Usage (Cores)',\n          data: [],\n          xScale: {},\n          yScale: {}\n        },\n        memory_values: {\n          area_fill_color: '#fca326',\n          line_color: '#fc6d26',\n          graph_legend_title: 'Memory Usage (MB)',\n          data: [],\n          xScale: {},\n          yScale: {}\n        }\n      };\n\n      this.commonGraphProperties = {\n        area_stroke_width: 2,\n        median_total_characters: 8,\n        circle_radius_metric: 5,\n        rect_text_width: 90,\n        rect_text_height: 40,\n        axis_no_ticks: 3\n      };\n    }\n  }, {\n    key: 'getData',\n    value: function getData() {\n      var _this4 = this;\n\n      var maxNumberOfRequests = 3;\n      this.state = '.js-loading';\n      this.updateState();\n      return gl.utils.backOff(function (next, stop) {\n        $.ajax({\n          url: metricsEndpoint,\n          dataType: 'json'\n        }).done(function (data, statusText, resp) {\n          if (resp.status === __WEBPACK_IMPORTED_MODULE_1__lib_utils_http_status__[\"a\" /* default */].NO_CONTENT) {\n            _this4.backOffRequestCounter = _this4.backOffRequestCounter += 1;\n            if (_this4.backOffRequestCounter < maxNumberOfRequests) {\n              next();\n            } else if (_this4.backOffRequestCounter >= maxNumberOfRequests) {\n              stop(new Error('loading'));\n            }\n          } else if (!data.success) {\n            stop(new Error('loading'));\n          } else {\n            stop({\n              status: resp.status,\n              metrics: data\n            });\n          }\n        }).fail(stop);\n      }).then(function (resp) {\n        if (resp.status === __WEBPACK_IMPORTED_MODULE_1__lib_utils_http_status__[\"a\" /* default */].NO_CONTENT) {\n          return {};\n        }\n        return resp.metrics;\n      }).catch(function () {\n        var prevState = _this4.state;\n        _this4.state = '.js-unable-to-connect';\n        _this4.updateState(prevState);\n      });\n    }\n  }, {\n    key: 'transformData',\n    value: function transformData(metricsResponse) {\n      var _this5 = this;\n\n      Object.keys(metricsResponse.metrics).forEach(function (key) {\n        if (key === 'cpu_values' || key === 'memory_values') {\n          var metricValues = metricsResponse.metrics[key][0];\n          _this5.graphSpecificProperties[key].data = metricValues.values.map(function (metric) {\n            return {\n              time: new Date(metric[0] * 1000),\n              value: metric[1]\n            };\n          });\n        }\n      });\n    }\n  }, {\n    key: 'updateState',\n    value: function updateState(prevState) {\n      var $statesContainer = $(prometheusStatesContainer);\n      $(prometheusParentGraphContainer).hide();\n      if (prevState) {\n        $('' + prevState, $statesContainer).addClass('hidden');\n      }\n      $('' + this.state, $statesContainer).removeClass('hidden');\n      $(prometheusStatesContainer).show();\n    }\n  }]);\n\n  return PrometheusGraph;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (PrometheusGraph);\n/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(\"../../../node_modules/jquery/dist/jquery.js\")))\n\n/***/ })\n\n},[\"./monitoring/monitoring_bundle.js\"]);\n\n\n// WEBPACK FOOTER //\n// monitoring.bae54c8bb07d02ee3abe.bundle.js","/**\n * exports HTTP status codes\n */\n\nexport default {\n  NO_CONTENT: 204,\n  OK: 200,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./lib/utils/http_status.js","import d3 from 'd3';\n\nexport const dateFormat = d3.time.format('%b %d, %Y');\nexport const timeFormat = d3.time.format('%H:%M%p');\n\n\n\n// WEBPACK FOOTER //\n// ./monitoring/constants.js","/* global Flash */\nimport d3 from 'd3';\nimport {\n  dateFormat,\n  timeFormat,\n} from './constants';\n\nexport default class Deployments {\n  constructor(width, height) {\n    this.width = width;\n    this.height = height;\n\n    this.endpoint = document.getElementById('js-metrics').dataset.deploymentEndpoint;\n\n    this.createGradientDef();\n  }\n\n  init(chartData) {\n    this.chartData = chartData;\n\n    this.x = d3.time.scale().range([0, this.width]);\n    this.x.domain(d3.extent(this.chartData, d => d.time));\n\n    this.charts = d3.selectAll('.prometheus-graph');\n\n    this.getData();\n  }\n\n  getData() {\n    $.ajax({\n      url: this.endpoint,\n      dataType: 'JSON',\n    })\n    .fail(() => new Flash('Error getting deployment information.'))\n    .done((data) => {\n      this.data = data.deployments.reduce((deploymentDataArray, deployment) => {\n        const time = new Date(deployment.created_at);\n        const xPos = Math.floor(this.x(time));\n\n        time.setSeconds(this.chartData[0].time.getSeconds());\n\n        if (xPos >= 0) {\n          deploymentDataArray.push({\n            id: deployment.id,\n            time,\n            sha: deployment.sha,\n            tag: deployment.tag,\n            ref: deployment.ref.name,\n            xPos,\n          });\n        }\n\n        return deploymentDataArray;\n      }, []);\n\n      this.plotData();\n    });\n  }\n\n  plotData() {\n    this.charts.each((d, i) => {\n      const svg = d3.select(this.charts[0][i]);\n      const chart = svg.select('.graph-container');\n      const key = svg.node().getAttribute('graph-type');\n\n      this.createLine(chart, key);\n      this.createDeployInfoBox(chart, key);\n    });\n  }\n\n  createGradientDef() {\n    const defs = d3.select('body')\n      .append('svg')\n      .attr({\n        height: 0,\n        width: 0,\n      })\n      .append('defs');\n\n    defs.append('linearGradient')\n      .attr({\n        id: 'shadow-gradient',\n      })\n      .append('stop')\n      .attr({\n        offset: '0%',\n        'stop-color': '#000',\n        'stop-opacity': 0.4,\n      })\n      .select(this.selectParentNode)\n      .append('stop')\n      .attr({\n        offset: '100%',\n        'stop-color': '#000',\n        'stop-opacity': 0,\n      });\n  }\n\n  createLine(chart, key) {\n    chart.append('g')\n      .attr({\n        class: 'deploy-info',\n      })\n      .selectAll('.deploy-info')\n      .data(this.data)\n      .enter()\n      .append('g')\n      .attr({\n        class: d => `deploy-info-${d.id}-${key}`,\n        transform: d => `translate(${Math.floor(d.xPos) + 1}, 0)`,\n      })\n      .append('rect')\n      .attr({\n        x: 1,\n        y: 0,\n        height: this.height + 1,\n        width: 3,\n        fill: 'url(#shadow-gradient)',\n      })\n      .select(this.selectParentNode)\n      .append('line')\n      .attr({\n        class: 'deployment-line',\n        x1: 0,\n        x2: 0,\n        y1: 0,\n        y2: this.height + 1,\n      });\n  }\n\n  createDeployInfoBox(chart, key) {\n    chart.selectAll('.deploy-info')\n      .selectAll('.js-deploy-info-box')\n      .data(this.data)\n      .enter()\n      .select(d => document.querySelector(`.deploy-info-${d.id}-${key}`))\n      .append('svg')\n      .attr({\n        class: 'js-deploy-info-box hidden',\n        x: 3,\n        y: 0,\n        width: 92,\n        height: 60,\n      })\n      .append('rect')\n      .attr({\n        class: 'rect-text-metric deploy-info-rect rect-metric',\n        x: 1,\n        y: 1,\n        rx: 2,\n        width: 90,\n        height: 58,\n      })\n      .select(this.selectParentNode)\n      .append('g')\n      .attr({\n        transform: 'translate(5, 2)',\n      })\n      .append('text')\n      .attr({\n        class: 'deploy-info-text text-metric-bold',\n      })\n      .text(Deployments.refText)\n      .select(this.selectParentNode)\n      .append('text')\n      .attr({\n        class: 'deploy-info-text',\n        y: 18,\n      })\n      .text(d => dateFormat(d.time))\n      .select(this.selectParentNode)\n      .append('text')\n      .attr({\n        class: 'deploy-info-text text-metric-bold',\n        y: 38,\n      })\n      .text(d => timeFormat(d.time));\n  }\n\n  static toggleDeployTextbox(deploy, key, showInfoBox) {\n    d3.selectAll(`.deploy-info-${deploy.id}-${key} .js-deploy-info-box`)\n      .classed('hidden', !showInfoBox);\n  }\n\n  mouseOverDeployInfo(mouseXPos, key) {\n    if (!this.data) return false;\n\n    let dataFound = false;\n\n    this.data.forEach((d) => {\n      if (d.xPos >= mouseXPos - 10 && d.xPos <= mouseXPos + 10 && !dataFound) {\n        dataFound = d.xPos + 1;\n\n        Deployments.toggleDeployTextbox(d, key, true);\n      } else {\n        Deployments.toggleDeployTextbox(d, key, false);\n      }\n    });\n\n    return dataFound;\n  }\n\n  /* `this` is bound to the D3 node */\n  selectParentNode() {\n    return this.parentNode;\n  }\n\n  static refText(d) {\n    return d.tag ? d.ref : d.sha.slice(0, 6);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./monitoring/deployments.js","import PrometheusGraph from './prometheus_graph';\n\ndocument.addEventListener('DOMContentLoaded', function onLoad() {\n  document.removeEventListener('DOMContentLoaded', onLoad, false);\n  return new PrometheusGraph();\n}, false);\n\n\n\n// WEBPACK FOOTER //\n// ./monitoring/monitoring_bundle.js","/* eslint-disable no-new */\n/* global Flash */\n\nimport d3 from 'd3';\nimport statusCodes from '~/lib/utils/http_status';\nimport Deployments from './deployments';\nimport '../lib/utils/common_utils';\nimport { formatRelevantDigits } from '../lib/utils/number_utils';\nimport '../flash';\nimport {\n  dateFormat,\n  timeFormat,\n} from './constants';\n\nconst prometheusContainer = '.prometheus-container';\nconst prometheusParentGraphContainer = '.prometheus-graphs';\nconst prometheusGraphsContainer = '.prometheus-graph';\nconst prometheusStatesContainer = '.prometheus-state';\nconst metricsEndpoint = 'metrics.json';\nconst bisectDate = d3.bisector(d => d.time).left;\nconst extraAddedWidthParent = 100;\n\nclass PrometheusGraph {\n  constructor() {\n    const $prometheusContainer = $(prometheusContainer);\n    const hasMetrics = $prometheusContainer.data('has-metrics');\n    this.docLink = $prometheusContainer.data('doc-link');\n    this.integrationLink = $prometheusContainer.data('prometheus-integration');\n    this.state = '';\n\n    $(document).ajaxError(() => {});\n\n    if (hasMetrics) {\n      this.margin = { top: 80, right: 180, bottom: 80, left: 100 };\n      this.marginLabelContainer = { top: 40, right: 0, bottom: 40, left: 0 };\n      const parentContainerWidth = $(prometheusGraphsContainer).parent().width() +\n      extraAddedWidthParent;\n      this.originalWidth = parentContainerWidth;\n      this.originalHeight = 330;\n      this.width = parentContainerWidth - this.margin.left - this.margin.right;\n      this.height = this.originalHeight - this.margin.top - this.margin.bottom;\n      this.backOffRequestCounter = 0;\n      this.deployments = new Deployments(this.width, this.height);\n      this.configureGraph();\n      this.init();\n    } else {\n      const prevState = this.state;\n      this.state = '.js-getting-started';\n      this.updateState(prevState);\n    }\n  }\n\n  createGraph() {\n    Object.keys(this.graphSpecificProperties).forEach((key) => {\n      const value = this.graphSpecificProperties[key];\n      if (value.data.length > 0) {\n        this.plotValues(key);\n      }\n    });\n  }\n\n  init() {\n    return this.getData().then((metricsResponse) => {\n      let enoughData = true;\n      if (typeof metricsResponse === 'undefined') {\n        enoughData = false;\n      } else {\n        Object.keys(metricsResponse.metrics).forEach((key) => {\n          if (key === 'cpu_values' || key === 'memory_values') {\n            const currentData = (metricsResponse.metrics[key])[0];\n            if (currentData.values.length <= 2) {\n              enoughData = false;\n            }\n          }\n        });\n      }\n      if (enoughData) {\n        $(prometheusStatesContainer).hide();\n        $(prometheusParentGraphContainer).show();\n        this.transformData(metricsResponse);\n        this.createGraph();\n\n        const firstMetricData = this.graphSpecificProperties[\n          Object.keys(this.graphSpecificProperties)[0]\n        ].data;\n\n        this.deployments.init(firstMetricData);\n      }\n    });\n  }\n\n  plotValues(key) {\n    const graphSpecifics = this.graphSpecificProperties[key];\n\n    const x = d3.time.scale()\n        .range([0, this.width]);\n\n    const y = d3.scale.linear()\n        .range([this.height, 0]);\n\n    graphSpecifics.xScale = x;\n    graphSpecifics.yScale = y;\n\n    const prometheusGraphContainer = `${prometheusGraphsContainer}[graph-type=${key}]`;\n\n    const chart = d3.select(prometheusGraphContainer)\n      .attr('width', this.width + this.margin.left + this.margin.right)\n      .attr('height', this.height + this.margin.bottom + this.margin.top)\n      .append('g')\n      .attr('class', 'graph-container')\n        .attr('transform', `translate(${this.margin.left},${this.margin.top})`);\n\n    const axisLabelContainer = d3.select(prometheusGraphContainer)\n      .attr('width', this.originalWidth)\n      .attr('height', this.originalHeight)\n      .append('g')\n        .attr('transform', `translate(${this.marginLabelContainer.left},${this.marginLabelContainer.top})`);\n\n    x.domain(d3.extent(graphSpecifics.data, d => d.time));\n    y.domain([0, d3.max(graphSpecifics.data.map(metricValue => metricValue.value))]);\n\n    const xAxis = d3.svg.axis()\n      .scale(x)\n      .ticks(this.commonGraphProperties.axis_no_ticks)\n      .orient('bottom');\n\n    const yAxis = d3.svg.axis()\n      .scale(y)\n      .ticks(this.commonGraphProperties.axis_no_ticks)\n      .tickSize(-this.width)\n      .outerTickSize(0)\n      .orient('left');\n\n    this.createAxisLabelContainers(axisLabelContainer, key);\n\n    chart.append('g')\n      .attr('class', 'x-axis')\n      .attr('transform', `translate(0,${this.height})`)\n      .call(xAxis);\n\n    chart.append('g')\n      .attr('class', 'y-axis')\n      .call(yAxis);\n\n    const area = d3.svg.area()\n      .x(d => x(d.time))\n      .y0(this.height)\n      .y1(d => y(d.value))\n      .interpolate('linear');\n\n    const line = d3.svg.line()\n    .x(d => x(d.time))\n    .y(d => y(d.value));\n\n    chart.append('path')\n      .datum(graphSpecifics.data)\n      .attr('d', area)\n      .attr('class', 'metric-area')\n      .attr('fill', graphSpecifics.area_fill_color);\n\n    chart.append('path')\n      .datum(graphSpecifics.data)\n      .attr('class', 'metric-line')\n      .attr('stroke', graphSpecifics.line_color)\n      .attr('fill', 'none')\n      .attr('stroke-width', this.commonGraphProperties.area_stroke_width)\n      .attr('d', line);\n\n    // Overlay area for the mouseover events\n    chart.append('rect')\n      .attr('class', 'prometheus-graph-overlay')\n      .attr('width', this.width)\n      .attr('height', this.height)\n      .on('mousemove', this.handleMouseOverGraph.bind(this, prometheusGraphContainer));\n  }\n\n  // The legends from the metric\n  createAxisLabelContainers(axisLabelContainer, key) {\n    const graphSpecifics = this.graphSpecificProperties[key];\n\n    axisLabelContainer.append('line')\n      .attr('class', 'label-x-axis-line')\n      .attr('stroke', '#000000')\n      .attr('stroke-width', '1')\n      .attr({\n        x1: 10,\n        y1: this.originalHeight - this.margin.top,\n        x2: (this.originalWidth - this.margin.right) + 10,\n        y2: this.originalHeight - this.margin.top,\n      });\n\n    axisLabelContainer.append('line')\n      .attr('class', 'label-y-axis-line')\n      .attr('stroke', '#000000')\n      .attr('stroke-width', '1')\n      .attr({\n        x1: 10,\n        y1: 0,\n        x2: 10,\n        y2: this.originalHeight - this.margin.top,\n      });\n\n    axisLabelContainer.append('rect')\n      .attr('class', 'rect-axis-text')\n      .attr('x', 0)\n      .attr('y', 50)\n      .attr('width', 30)\n      .attr('height', 150);\n\n    axisLabelContainer.append('text')\n      .attr('class', 'label-axis-text')\n      .attr('text-anchor', 'middle')\n      .attr('transform', `translate(15, ${(this.originalHeight - this.margin.top) / 2}) rotate(-90)`)\n      .text(graphSpecifics.graph_legend_title);\n\n    axisLabelContainer.append('rect')\n      .attr('class', 'rect-axis-text')\n      .attr('x', (this.originalWidth / 2) - this.margin.right)\n      .attr('y', this.originalHeight - 100)\n      .attr('width', 30)\n      .attr('height', 80);\n\n    axisLabelContainer.append('text')\n      .attr('class', 'label-axis-text')\n      .attr('x', (this.originalWidth / 2) - this.margin.right)\n      .attr('y', this.originalHeight - this.margin.top)\n      .attr('dy', '.35em')\n      .text('Time');\n\n    // Legends\n\n    // Metric Usage\n    axisLabelContainer.append('rect')\n      .attr('x', this.originalWidth - 170)\n      .attr('y', (this.originalHeight / 2) - 60)\n      .style('fill', graphSpecifics.area_fill_color)\n      .attr('width', 20)\n      .attr('height', 35);\n\n    axisLabelContainer.append('text')\n      .attr('class', 'text-metric-title')\n      .attr('x', this.originalWidth - 140)\n      .attr('y', (this.originalHeight / 2) - 50)\n      .text('Average');\n\n    axisLabelContainer.append('text')\n      .attr('class', 'text-metric-usage')\n      .attr('x', this.originalWidth - 140)\n      .attr('y', (this.originalHeight / 2) - 25);\n  }\n\n  handleMouseOverGraph(prometheusGraphContainer) {\n    const rectOverlay = document.querySelector(`${prometheusGraphContainer} .prometheus-graph-overlay`);\n    const currentXCoordinate = d3.mouse(rectOverlay)[0];\n\n    Object.keys(this.graphSpecificProperties).forEach((key) => {\n      const currentGraphProps = this.graphSpecificProperties[key];\n      const timeValueOverlay = currentGraphProps.xScale.invert(currentXCoordinate);\n      const overlayIndex = bisectDate(currentGraphProps.data, timeValueOverlay, 1);\n      const d0 = currentGraphProps.data[overlayIndex - 1];\n      const d1 = currentGraphProps.data[overlayIndex];\n      const evalTime = timeValueOverlay - d0.time > d1.time - timeValueOverlay;\n      const currentData = evalTime ? d1 : d0;\n      const currentTimeCoordinate = Math.floor(currentGraphProps.xScale(currentData.time));\n      const currentDeployXPos = this.deployments.mouseOverDeployInfo(currentXCoordinate, key);\n      const currentPrometheusGraphContainer = `${prometheusGraphsContainer}[graph-type=${key}]`;\n      const maxValueFromData = d3.max(currentGraphProps.data.map(metricValue => metricValue.value));\n      const maxMetricValue = currentGraphProps.yScale(maxValueFromData);\n\n      // Clear up all the pieces of the flag\n      d3.selectAll(`${currentPrometheusGraphContainer} .selected-metric-line`).remove();\n      d3.selectAll(`${currentPrometheusGraphContainer} .circle-metric`).remove();\n      d3.selectAll(`${currentPrometheusGraphContainer} .rect-text-metric:not(.deploy-info-rect)`).remove();\n\n      const currentChart = d3.select(currentPrometheusGraphContainer).select('g');\n      currentChart.append('line')\n      .attr({\n        class: `${currentDeployXPos ? 'hidden' : ''} selected-metric-line`,\n        x1: currentTimeCoordinate,\n        y1: currentGraphProps.yScale(0),\n        x2: currentTimeCoordinate,\n        y2: maxMetricValue,\n      });\n\n      currentChart.append('circle')\n        .attr('class', 'circle-metric')\n        .attr('fill', currentGraphProps.line_color)\n        .attr('cx', currentDeployXPos || currentTimeCoordinate)\n        .attr('cy', currentGraphProps.yScale(currentData.value))\n        .attr('r', this.commonGraphProperties.circle_radius_metric);\n\n      if (currentDeployXPos) return;\n\n      // The little box with text\n      const rectTextMetric = currentChart.append('svg')\n        .attr({\n          class: 'rect-text-metric',\n          x: currentTimeCoordinate,\n          y: 0,\n        });\n\n      rectTextMetric.append('rect')\n        .attr({\n          class: 'rect-metric',\n          x: 4,\n          y: 1,\n          rx: 2,\n          width: this.commonGraphProperties.rect_text_width,\n          height: this.commonGraphProperties.rect_text_height,\n        });\n\n      rectTextMetric.append('text')\n        .attr({\n          class: 'text-metric text-metric-bold',\n          x: 8,\n          y: 35,\n        })\n        .text(timeFormat(currentData.time));\n\n      rectTextMetric.append('text')\n        .attr({\n          class: 'text-metric-date',\n          x: 8,\n          y: 15,\n        })\n        .text(dateFormat(currentData.time));\n\n      let currentMetricValue = formatRelevantDigits(currentData.value);\n      if (key === 'cpu_values') {\n        currentMetricValue = `${currentMetricValue}%`;\n      } else {\n        currentMetricValue = `${currentMetricValue} MB`;\n      }\n\n      d3.select(`${currentPrometheusGraphContainer} .text-metric-usage`)\n        .text(currentMetricValue);\n    });\n  }\n\n  configureGraph() {\n    this.graphSpecificProperties = {\n      cpu_values: {\n        area_fill_color: '#edf3fc',\n        line_color: '#5b99f7',\n        graph_legend_title: 'CPU Usage (Cores)',\n        data: [],\n        xScale: {},\n        yScale: {},\n      },\n      memory_values: {\n        area_fill_color: '#fca326',\n        line_color: '#fc6d26',\n        graph_legend_title: 'Memory Usage (MB)',\n        data: [],\n        xScale: {},\n        yScale: {},\n      },\n    };\n\n    this.commonGraphProperties = {\n      area_stroke_width: 2,\n      median_total_characters: 8,\n      circle_radius_metric: 5,\n      rect_text_width: 90,\n      rect_text_height: 40,\n      axis_no_ticks: 3,\n    };\n  }\n\n  getData() {\n    const maxNumberOfRequests = 3;\n    this.state = '.js-loading';\n    this.updateState();\n    return gl.utils.backOff((next, stop) => {\n      $.ajax({\n        url: metricsEndpoint,\n        dataType: 'json',\n      })\n      .done((data, statusText, resp) => {\n        if (resp.status === statusCodes.NO_CONTENT) {\n          this.backOffRequestCounter = this.backOffRequestCounter += 1;\n          if (this.backOffRequestCounter < maxNumberOfRequests) {\n            next();\n          } else if (this.backOffRequestCounter >= maxNumberOfRequests) {\n            stop(new Error('loading'));\n          }\n        } else if (!data.success) {\n          stop(new Error('loading'));\n        } else {\n          stop({\n            status: resp.status,\n            metrics: data,\n          });\n        }\n      }).fail(stop);\n    })\n    .then((resp) => {\n      if (resp.status === statusCodes.NO_CONTENT) {\n        return {};\n      }\n      return resp.metrics;\n    })\n    .catch(() => {\n      const prevState = this.state;\n      this.state = '.js-unable-to-connect';\n      this.updateState(prevState);\n    });\n  }\n\n  transformData(metricsResponse) {\n    Object.keys(metricsResponse.metrics).forEach((key) => {\n      if (key === 'cpu_values' || key === 'memory_values') {\n        const metricValues = (metricsResponse.metrics[key])[0];\n        this.graphSpecificProperties[key].data = metricValues.values.map(metric => ({\n          time: new Date(metric[0] * 1000),\n          value: metric[1],\n        }));\n      }\n    });\n  }\n\n  updateState(prevState) {\n    const $statesContainer = $(prometheusStatesContainer);\n    $(prometheusParentGraphContainer).hide();\n    if (prevState) {\n      $(`${prevState}`, $statesContainer).addClass('hidden');\n    }\n    $(`${this.state}`, $statesContainer).removeClass('hidden');\n    $(prometheusStatesContainer).show();\n  }\n}\n\nexport default PrometheusGraph;\n\n\n\n// WEBPACK FOOTER //\n// ./monitoring/prometheus_graph.js"],"sourceRoot":""}