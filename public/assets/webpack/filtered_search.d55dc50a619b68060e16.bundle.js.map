{"version":3,"sources":["webpack:///filtered_search.d55dc50a619b68060e16.bundle.js","webpack:///./droplab/plugins/ajax.js","webpack:///./droplab/plugins/ajax_filter.js","webpack:///./droplab/plugins/filter.js","webpack:///./filtered_search/components/recent_searches_dropdown_content.js","webpack:///./filtered_search/container.js?f7fa","webpack:///./filtered_search/dropdown_hint.js","webpack:///./filtered_search/dropdown_non_user.js","webpack:///./filtered_search/dropdown_user.js","webpack:///./filtered_search/dropdown_utils.js","webpack:///./filtered_search/event_hub.js","webpack:///./filtered_search/filtered_search_dropdown.js","webpack:///./filtered_search/filtered_search_dropdown_manager.js","webpack:///./filtered_search/filtered_search_manager.js","webpack:///./filtered_search/filtered_search_token_keys.js","webpack:///./filtered_search/filtered_search_tokenizer.js","webpack:///./filtered_search/filtered_search_visual_tokens.js","webpack:///./filtered_search/recent_searches_root.js","webpack:///./filtered_search/services/recent_searches_service.js","webpack:///./filtered_search/services/recent_searches_service_error.js","webpack:///./filtered_search/stores/recent_searches_store.js","webpack:///./lib/utils/users_cache.js"],"names":["webpackJsonp","./droplab/plugins/ajax.js","module","__webpack_exports__","__webpack_require__","__WEBPACK_IMPORTED_MODULE_0__lib_utils_ajax_cache__","Ajax","_loadData","data","config","self","loadingTemplate","dataLoadingTemplate","hook","list","querySelector","outerHTML","listTemplate","destroyed","method","call","init","this","endpoint","dynamicList","document","createElement","innerHTML","setAttribute","retrieve","then","catch","onError","destroy","./droplab/plugins/ajax_filter.js","AjaxFilter","notLoading","eventWrapper","debounceTrigger","bind","trigger","addEventListener","loading","e","NON_CHARACTER_KEYS","invalidKeyPressed","indexOf","detail","which","keyCode","focusEvent","type","timeout","clearTimeout","setTimeout","getEntireList","_this","searchValue","value","searchKey","searchValueFunction","undefined","length","show","params","url","buildParams","onLoadingFinished","hookListChildren","children","hasAttribute","hide","setData","currentIndex","Object","keys","map","param","join","removeEventListener","./droplab/plugins/filter.js","Filter","keydown","filterFunction","hiddenCount","dataHiddenCount","toLowerCase","matches","o","droplab_hidden","template","filter","debounceKeydown","./filtered_search/components/recent_searches_dropdown_content.js","__WEBPACK_IMPORTED_MODULE_0__event_hub__","name","props","items","Array","required","isLocalStorageAvailable","Boolean","default","allowedKeys","computed","processedItems","item","_gl$FilteredSearchTok","gl","FilteredSearchTokenizer","processTokens","tokens","searchToken","text","token","prefix","key","suffix","symbol","hasItems","methods","onItemActivated","$emit","onRequestClearRecentSearches","stopPropagation","./filtered_search/container.js","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","i","descriptor","enumerable","configurable","writable","defineProperty","protoProps","staticProps","prototype","container","FilteredSearchContainerClass","set","containerParam","get","./filtered_search/dropdown_hint.js","_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","__WEBPACK_IMPORTED_MODULE_0__droplab_plugins_filter__","__WEBPACK_IMPORTED_MODULE_1__filtered_search_dropdown__","n","DropdownHint","_gl$FilteredSearchDro","droplab","dropdown","input","tokenKeys","getPrototypeOf","DropdownUtils","filterHint","getKeys","selected","tagName","dismissDropdown","getAttribute","dispatchFormSubmitEvent","innerText","trim","tag","previousInputValues","split","searchTerms","forEach","index","push","pop","FilteredSearchVisualTokens","addSearchVisualToken","FilteredSearchDropdownManager","addWordToInput","replace","dispatchInputEvent","dropdownData","FilteredSearchTokenKeys","tokenKey","icon","hint","changeHookList","hookId","addHook","FilteredSearchDropdown","window","./filtered_search/dropdown_non_user.js","__WEBPACK_IMPORTED_MODULE_0__droplab_plugins_ajax__","__WEBPACK_IMPORTED_MODULE_1__droplab_plugins_filter__","__WEBPACK_IMPORTED_MODULE_2__filtered_search_dropdown__","_get","object","property","receiver","Function","desc","getOwnPropertyDescriptor","parent","getter","DropdownNonUser","Flash","filterWithSymbol","_this2","title","getEscapedText","forceShowList","arguments","./filtered_search/dropdown_user.js","__WEBPACK_IMPORTED_MODULE_0__droplab_plugins_ajax_filter__","DropdownUser","gon","relative_url_root","per_page","active","project_id","getProjectId","current_user","getSearchInput","hideCurrentUser","classList","add","query","lastToken","slice","./filtered_search/dropdown_utils.js","__WEBPACK_IMPORTED_MODULE_0__container__","escapedText","hasSpace","hasDoubleQuote","filterSymbol","updatedItem","searchInput","matchWithoutSymbol","match","getSearchQuery","lastKey","allowMultiple","itemInExistingTokens","some","t","last","tokenName","dataValue","untilInput","querySelectorAll","values","inputIndex","_","findIndex","contains","splice","valueContainer","dataset","valueText","originalValue","className","_gl$FilteredSearchVis","getLastVisualTokenBeforeInput","isLastVisualTokenValid","inputValue","previous","filteredSearchInput","_gl$DropdownUtils$get","getInputSelectionPosition","right","selectionStart","str","search","left","./filtered_search/event_hub.js","__WEBPACK_IMPORTED_MODULE_0_vue__","./filtered_search/filtered_search_bundle.js","__WEBPACK_IMPORTED_MODULE_4__filtered_search_token_keys__","__WEBPACK_IMPORTED_MODULE_6__filtered_search_dropdown__","./filtered_search/filtered_search_dropdown.js","exports","id","bindEvents","itemClickedWrapper","itemClicked","hooks","h","getValueFunction","setDataValueIfSelected","resetFilters","offset","innerWidth","style","currentHook","getCurrentHook","hidden","forceRenderContent","setAsDropdown","renderContent","focus","dispatchEvent","CustomEvent","bubbles","cancelable","form","Event","results","updated","render","./filtered_search/filtered_search_dropdown_manager.js","__WEBPACK_IMPORTED_MODULE_0__droplab_drop_lab__","__WEBPACK_IMPORTED_MODULE_1__container__","baseEndpoint","tokenizer","page","filteredSearchTokenKeys","setupMapping","cleanupWrapper","cleanup","mapping","author","reference","element","assignee","milestone","extraArguments","label","updateDropdownOffset","currentDropdown","getBoundingClientRect","currentDropdownWidth","clientWidth","offsetMaxWidth","setOffset","firstLoad","mappingKey","glClass","dl","defaultArguments","glArguments","concat","apply","dropdownName","searchByKey","shouldOpenFilterDropdown","shouldOpenHintDropdown","load","_tokenizer$processTok","updateCurrentDropdownOffset","loadDropdown","hideDropdown","setDropdown","tokenValue","clicked","addFilterVisualToken","moveInputToTheRight","./filtered_search/filtered_search_manager.js","__WEBPACK_IMPORTED_MODULE_1__recent_searches_root__","__WEBPACK_IMPORTED_MODULE_2__stores_recent_searches_store__","__WEBPACK_IMPORTED_MODULE_3__services_recent_searches_service__","__WEBPACK_IMPORTED_MODULE_4__event_hub__","FilteredSearchManager","filteredSearchInputForm","clearSearchButton","tokensContainer","recentSearchesStore","isAvailable","searchHistoryDropdownElement","projectPath","projectFullPath","recentSearchesPagePrefix","recentSearchesKey","recentSearchesService","fetchingRecentSearchesPromise","fetch","error","searches","resultantSearches","setRecentSearches","state","recentSearches","save","dropdownManager","recentSearchesRoot","loadSearchParamsFromURL","unbindEvents","stateFilters","searchStateWrapper","searchState","mergedState","handleFormSubmit","setDropdownWrapper","toggleClearSearchButtonWrapper","toggleClearSearchButton","handleInputPlaceholderWrapper","handleInputPlaceholder","handleInputVisualTokenWrapper","handleInputVisualToken","checkForEnterWrapper","checkForEnter","onClearSearchWrapper","onClearSearch","checkForBackspaceWrapper","checkForBackspace","removeSelectedTokenKeydownWrapper","removeSelectedTokenKeydown","unselectEditTokensWrapper","unselectEditTokens","editTokenWrapper","editToken","tokenChange","addInputContainerFocusWrapper","addInputContainerFocus","removeInputContainerFocusWrapper","removeInputContainerFocus","onrecentSearchesItemSelectedWrapper","onrecentSearchesItemSelected","removeTokenWrapper","removeToken","$on","bindStateEvents","$off","unbindStateEvents","lastVisualToken","sanitizedTokenName","textContent","canEdit","getLastTokenPartial","removeLastTokenPartial","preventDefault","setSelectionRange","dropdownEl","activeElements","isHandledAsync","stopImmediatePropagation","blur","resetDropdowns","destroyDroplab","inputContainer","closest","isElementInFilteredSearch","isElementInDynamicFilterDropdown","isElementInStaticFilterDropdown","remove","button","selectToken","removeSelectedToken","isElementInFilterDropdown","isElementTokensContainer","hasHidden","currentPlaceholder","placeholder","clearSearch","removeElements","el","parentElement","removeChild","fragments","inputValues","valueCompletedRegex","searchQuery","addRecentSearch","_this3","utils","getUrlParamsArray","usernameParams","getUsernameParams","hasFilteredSearch","p","keyParam","decodeURIComponent","condition","searchByConditionUrl","sanitizedValue","searchByKeyParam","sanitizedKey","quotationsToUse","parseInt","saveCurrentSearchQuery","currentTarget","_this4","paths","_tokenizer$processTok2","currentState","getParameterByName","searchByConditionKeyValue","_ref","tokenPath","encodeURIComponent","sanitized","parameterizedUrl","updateObject","visitUrl","usernamesById","attribute","JSON","parse","user","username","currentDropdownRef","./filtered_search/filtered_search_token_keys.js","alternativeTokenKeys","tokenKeysWithAlternative","conditions","find","tokenKeyParam","./filtered_search/filtered_search_tokenizer.js","__WEBPACK_IMPORTED_MODULE_0__filtered_search_token_keys__","tokenRegex","RegExp","tokenIndexes","v1","v2","v3","tokenSymbol","tokenIndex","lastString","lastIndexOf","./filtered_search/filtered_search_visual_tokens.js","__WEBPACK_IMPORTED_MODULE_1__flash__","__WEBPACK_IMPORTED_MODULE_2__container__","__WEBPACK_IMPORTED_MODULE_3__lib_utils_users_cache__","inputLi","previousElementSibling","otherTokens","tokenButton","forceSelection","unselectTokens","li","removeTokenMarkup","tokenValueContainer","labelsEndpoint","labels","matchingLabel","tokenValueStyle","backgroundColor","color","text_color","tokenValueElement","Promise","resolve","avatar_url","tokenType","updateLabelTokenColor","updateUserTokenAppearance","isSearchTerm","createVisualTokenElementHTML","renderVisualTokenValue","insertBefore","_FilteredSearchVisual","_FilteredSearchVisual2","addVisualTokenElement","previousTokenName","searchTerm","_FilteredSearchVisual3","_FilteredSearchVisual4","nameText","_FilteredSearchVisual5","addValueToPreviousVisualTokenElement","tokenizeInput","tokenContainer","replaceChild","nameElement","valueContainerElement","inputEvent","lastElementChild","isEqualNode","lastPartial","appendChild","./filtered_search/recent_searches_root.js","__WEBPACK_IMPORTED_MODULE_1__components_recent_searches_dropdown_content__","__WEBPACK_IMPORTED_MODULE_2__event_hub__","RecentSearchesRoot","wrapperElement","store","service","onRequestClearRecentSearchesWrapper","vm","components","recent-searches-dropdown-content","$destroy","./filtered_search/services/recent_searches_service.js","__WEBPACK_IMPORTED_MODULE_0__recent_searches_service_error__","__WEBPACK_IMPORTED_MODULE_1__lib_utils_accessor__","RecentSearchesService","localStorageKey","reject","localStorage","getItem","err","setItem","stringify","isLocalStorageAccessSafe","./filtered_search/services/recent_searches_service_error.js","RecentSearchesServiceError","message","Error","./filtered_search/stores/recent_searches_store.js","__WEBPACK_IMPORTED_MODULE_0_underscore__","__WEBPACK_IMPORTED_MODULE_0_underscore___default","RecentSearchesStore","initialState","assign","newSearch","trimmedSearches","a","uniq","./lib/utils/users_cache.js","__WEBPACK_IMPORTED_MODULE_0__api__","__WEBPACK_IMPORTED_MODULE_1__cache__","UsersCache","_Cache","hasData","users","internalStorage"],"mappings":"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","file":"filtered_search.d55dc50a619b68060e16.bundle.js","sourcesContent":["webpackJsonp([\"filtered_search\"],{\n\n/***/ \"./droplab/plugins/ajax.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__lib_utils_ajax_cache__ = __webpack_require__(\"./lib/utils/ajax_cache.js\");\n/* eslint-disable */\n\n\n\nvar Ajax = {\n  _loadData: function _loadData(data, config, self) {\n    if (config.loadingTemplate) {\n      var dataLoadingTemplate = self.hook.list.list.querySelector('[data-loading-template]');\n      if (dataLoadingTemplate) dataLoadingTemplate.outerHTML = self.listTemplate;\n    }\n\n    if (!self.destroyed) self.hook.list[config.method].call(self.hook.list, data);\n  },\n  init: function init(hook) {\n    var self = this;\n    self.destroyed = false;\n    var config = hook.config.Ajax;\n    this.hook = hook;\n    if (!config || !config.endpoint || !config.method) {\n      return;\n    }\n    if (config.method !== 'setData' && config.method !== 'addData') {\n      return;\n    }\n    if (config.loadingTemplate) {\n      var dynamicList = hook.list.list.querySelector('[data-dynamic]');\n      var loadingTemplate = document.createElement('div');\n      loadingTemplate.innerHTML = config.loadingTemplate;\n      loadingTemplate.setAttribute('data-loading-template', '');\n      this.listTemplate = dynamicList.outerHTML;\n      dynamicList.outerHTML = loadingTemplate.outerHTML;\n    }\n\n    __WEBPACK_IMPORTED_MODULE_0__lib_utils_ajax_cache__[\"a\" /* default */].retrieve(config.endpoint).then(function (data) {\n      return self._loadData(data, config, self);\n    }).catch(config.onError);\n  },\n  destroy: function destroy() {\n    this.destroyed = true;\n  }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Ajax);\n\n/***/ }),\n\n/***/ \"./droplab/plugins/ajax_filter.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__lib_utils_ajax_cache__ = __webpack_require__(\"./lib/utils/ajax_cache.js\");\n/* eslint-disable */\n\n\nvar AjaxFilter = {\n  init: function init(hook) {\n    this.destroyed = false;\n    this.hook = hook;\n    this.notLoading();\n\n    this.eventWrapper = {};\n    this.eventWrapper.debounceTrigger = this.debounceTrigger.bind(this);\n    this.hook.trigger.addEventListener('keydown.dl', this.eventWrapper.debounceTrigger);\n    this.hook.trigger.addEventListener('focus', this.eventWrapper.debounceTrigger);\n\n    this.trigger(true);\n  },\n\n  notLoading: function notLoading() {\n    this.loading = false;\n  },\n\n  debounceTrigger: function debounceTrigger(e) {\n    var NON_CHARACTER_KEYS = [16, 17, 18, 20, 37, 38, 39, 40, 91, 93];\n    var invalidKeyPressed = NON_CHARACTER_KEYS.indexOf(e.detail.which || e.detail.keyCode) > -1;\n    var focusEvent = e.type === 'focus';\n    if (invalidKeyPressed || this.loading) {\n      return;\n    }\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n    }\n    this.timeout = setTimeout(this.trigger.bind(this, focusEvent), 200);\n  },\n\n  trigger: function trigger(getEntireList) {\n    var _this = this;\n\n    var config = this.hook.config.AjaxFilter;\n    var searchValue = this.trigger.value;\n    if (!config || !config.endpoint || !config.searchKey) {\n      return;\n    }\n    if (config.searchValueFunction) {\n      searchValue = config.searchValueFunction();\n    }\n    if (config.loadingTemplate && this.hook.list.data === undefined || this.hook.list.data.length === 0) {\n      var dynamicList = this.hook.list.list.querySelector('[data-dynamic]');\n      var loadingTemplate = document.createElement('div');\n      loadingTemplate.innerHTML = config.loadingTemplate;\n      loadingTemplate.setAttribute('data-loading-template', true);\n      this.listTemplate = dynamicList.outerHTML;\n      dynamicList.outerHTML = loadingTemplate.outerHTML;\n    }\n    if (getEntireList) {\n      searchValue = '';\n    }\n    if (config.searchKey === searchValue) {\n      return this.list.show();\n    }\n    this.loading = true;\n    var params = config.params || {};\n    params[config.searchKey] = searchValue;\n    var url = config.endpoint + this.buildParams(params);\n    return __WEBPACK_IMPORTED_MODULE_0__lib_utils_ajax_cache__[\"a\" /* default */].retrieve(url).then(function (data) {\n      _this._loadData(data, config);\n      if (config.onLoadingFinished) {\n        config.onLoadingFinished(data);\n      }\n    }).catch(config.onError);\n  },\n\n  _loadData: function _loadData(data, config) {\n    var list = this.hook.list;\n    if (config.loadingTemplate && list.data === undefined || list.data.length === 0) {\n      var dataLoadingTemplate = list.list.querySelector('[data-loading-template]');\n      if (dataLoadingTemplate) {\n        dataLoadingTemplate.outerHTML = this.listTemplate;\n      }\n    }\n    if (!this.destroyed) {\n      var hookListChildren = list.list.children;\n      var onlyDynamicList = hookListChildren.length === 1 && hookListChildren[0].hasAttribute('data-dynamic');\n      if (onlyDynamicList && data.length === 0) {\n        list.hide();\n      }\n      list.setData.call(list, data);\n    }\n    this.notLoading();\n    list.currentIndex = 0;\n  },\n\n\n  buildParams: function buildParams(params) {\n    if (!params) return '';\n    var paramsArray = Object.keys(params).map(function (param) {\n      return param + '=' + (params[param] || '');\n    });\n    return '?' + paramsArray.join('&');\n  },\n\n  destroy: function destroy() {\n    if (this.timeout) clearTimeout(this.timeout);\n    this.destroyed = true;\n\n    this.hook.trigger.removeEventListener('keydown.dl', this.eventWrapper.debounceTrigger);\n    this.hook.trigger.removeEventListener('focus', this.eventWrapper.debounceTrigger);\n  }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (AjaxFilter);\n\n/***/ }),\n\n/***/ \"./droplab/plugins/filter.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* eslint-disable */\n\nvar Filter = {\n  keydown: function keydown(e) {\n    if (this.destroyed) return;\n\n    var hiddenCount = 0;\n    var dataHiddenCount = 0;\n\n    var list = e.detail.hook.list;\n    var data = list.data;\n    var value = e.detail.hook.trigger.value.toLowerCase();\n    var config = e.detail.hook.config.Filter;\n    var matches = [];\n    var filterFunction;\n    // will only work on dynamically set data\n    if (!data) {\n      return;\n    }\n\n    if (config && config.filterFunction && typeof config.filterFunction === 'function') {\n      filterFunction = config.filterFunction;\n    } else {\n      filterFunction = function filterFunction(o) {\n        // cheap string search\n        o.droplab_hidden = o[config.template].toLowerCase().indexOf(value) === -1;\n        return o;\n      };\n    }\n\n    dataHiddenCount = data.filter(function (o) {\n      return !o.droplab_hidden;\n    }).length;\n\n    matches = data.map(function (o) {\n      return filterFunction(o, value);\n    });\n\n    hiddenCount = matches.filter(function (o) {\n      return !o.droplab_hidden;\n    }).length;\n\n    if (dataHiddenCount !== hiddenCount) {\n      list.setData(matches);\n      list.currentIndex = 0;\n    }\n  },\n\n  debounceKeydown: function debounceKeydown(e) {\n    if ([13, // enter\n    16, // shift\n    17, // ctrl\n    18, // alt\n    20, // caps lock\n    37, // left arrow\n    38, // up arrow\n    39, // right arrow\n    40, // down arrow\n    91, // left window\n    92, // right window\n    93].indexOf(e.detail.which || e.detail.keyCode) > -1) return;\n\n    if (this.timeout) clearTimeout(this.timeout);\n    this.timeout = setTimeout(this.keydown.bind(this, e), 200);\n  },\n\n  init: function init(hook) {\n    var config = hook.config.Filter;\n\n    if (!config || !config.template) return;\n\n    this.hook = hook;\n    this.destroyed = false;\n\n    this.eventWrapper = {};\n    this.eventWrapper.debounceKeydown = this.debounceKeydown.bind(this);\n\n    this.hook.trigger.addEventListener('keydown.dl', this.eventWrapper.debounceKeydown);\n    this.hook.trigger.addEventListener('mousedown.dl', this.eventWrapper.debounceKeydown);\n\n    this.debounceKeydown({ detail: { hook: this.hook } });\n  },\n\n  destroy: function destroy() {\n    if (this.timeout) clearTimeout(this.timeout);\n    this.destroyed = true;\n\n    this.hook.trigger.removeEventListener('keydown.dl', this.eventWrapper.debounceKeydown);\n    this.hook.trigger.removeEventListener('mousedown.dl', this.eventWrapper.debounceKeydown);\n  }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Filter);\n\n/***/ }),\n\n/***/ \"./filtered_search/components/recent_searches_dropdown_content.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__event_hub__ = __webpack_require__(\"./filtered_search/event_hub.js\");\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  name: 'RecentSearchesDropdownContent',\n\n  props: {\n    items: {\n      type: Array,\n      required: true\n    },\n    isLocalStorageAvailable: {\n      type: Boolean,\n      required: false,\n      default: true\n    },\n    allowedKeys: {\n      type: Array,\n      required: true\n    }\n  },\n\n  computed: {\n    processedItems: function processedItems() {\n      var _this = this;\n\n      return this.items.map(function (item) {\n        var _gl$FilteredSearchTok = gl.FilteredSearchTokenizer.processTokens(item, _this.allowedKeys),\n            tokens = _gl$FilteredSearchTok.tokens,\n            searchToken = _gl$FilteredSearchTok.searchToken;\n\n        var resultantTokens = tokens.map(function (token) {\n          return {\n            prefix: token.key + ':',\n            suffix: '' + token.symbol + token.value\n          };\n        });\n\n        return {\n          text: item,\n          tokens: resultantTokens,\n          searchToken: searchToken\n        };\n      });\n    },\n    hasItems: function hasItems() {\n      return this.items.length > 0;\n    }\n  },\n\n  methods: {\n    onItemActivated: function onItemActivated(text) {\n      __WEBPACK_IMPORTED_MODULE_0__event_hub__[\"a\" /* default */].$emit('recentSearchesItemSelected', text);\n    },\n    onRequestClearRecentSearches: function onRequestClearRecentSearches(e) {\n      // Stop the dropdown from closing\n      e.stopPropagation();\n\n      __WEBPACK_IMPORTED_MODULE_0__event_hub__[\"a\" /* default */].$emit('requestClearRecentSearches');\n    }\n  },\n\n  template: '\\n    <div>\\n      <div\\n        v-if=\"!isLocalStorageAvailable\"\\n        class=\"dropdown-info-note\">\\n        This feature requires local storage to be enabled\\n      </div>\\n      <ul v-else-if=\"hasItems\">\\n        <li\\n          v-for=\"(item, index) in processedItems\"\\n          :key=\"index\">\\n          <button\\n            type=\"button\"\\n            class=\"filtered-search-history-dropdown-item\"\\n            @click=\"onItemActivated(item.text)\">\\n            <span>\\n              <span\\n                v-for=\"(token, tokenIndex) in item.tokens\"\\n                class=\"filtered-search-history-dropdown-token\">\\n                <span class=\"name\">{{ token.prefix }}</span><span class=\"value\">{{ token.suffix }}</span>\\n              </span>\\n            </span>\\n            <span class=\"filtered-search-history-dropdown-search-token\">\\n              {{ item.searchToken }}\\n            </span>\\n          </button>\\n        </li>\\n        <li class=\"divider\"></li>\\n        <li>\\n          <button\\n            type=\"button\"\\n            class=\"filtered-search-history-clear-button\"\\n            @click=\"onRequestClearRecentSearches($event)\">\\n            Clear recent searches\\n          </button>\\n        </li>\\n      </ul>\\n      <div\\n        v-else\\n        class=\"dropdown-info-note\">\\n        You don\\'t have any recent searches\\n      </div>\\n    </div>\\n  '\n});\n\n/***/ }),\n\n/***/ \"./filtered_search/container.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/* eslint-disable class-methods-use-this */\nvar container = document;\n\nvar FilteredSearchContainerClass = function () {\n  function FilteredSearchContainerClass() {\n    _classCallCheck(this, FilteredSearchContainerClass);\n  }\n\n  _createClass(FilteredSearchContainerClass, [{\n    key: \"container\",\n    set: function set(containerParam) {\n      container = containerParam;\n    },\n    get: function get() {\n      return container;\n    }\n  }]);\n\n  return FilteredSearchContainerClass;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (new FilteredSearchContainerClass());\n\n/***/ }),\n\n/***/ \"./filtered_search/dropdown_hint.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__droplab_plugins_filter__ = __webpack_require__(\"./droplab/plugins/filter.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__filtered_search_dropdown__ = __webpack_require__(\"./filtered_search/filtered_search_dropdown.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__filtered_search_dropdown___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__filtered_search_dropdown__);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\nvar DropdownHint = function (_gl$FilteredSearchDro) {\n  _inherits(DropdownHint, _gl$FilteredSearchDro);\n\n  function DropdownHint(droplab, dropdown, input, tokenKeys, filter) {\n    _classCallCheck(this, DropdownHint);\n\n    var _this = _possibleConstructorReturn(this, (DropdownHint.__proto__ || Object.getPrototypeOf(DropdownHint)).call(this, droplab, dropdown, input, filter));\n\n    _this.config = {\n      Filter: {\n        template: 'hint',\n        filterFunction: gl.DropdownUtils.filterHint.bind(null, {\n          input: input,\n          allowedKeys: tokenKeys.getKeys()\n        })\n      }\n    };\n    _this.tokenKeys = tokenKeys;\n    return _this;\n  }\n\n  _createClass(DropdownHint, [{\n    key: 'itemClicked',\n    value: function itemClicked(e) {\n      var selected = e.detail.selected;\n\n\n      if (selected.tagName === 'LI') {\n        if (selected.hasAttribute('data-value')) {\n          this.dismissDropdown();\n        } else if (selected.getAttribute('data-action') === 'submit') {\n          this.dismissDropdown();\n          this.dispatchFormSubmitEvent();\n        } else {\n          var token = selected.querySelector('.js-filter-hint').innerText.trim();\n          var tag = selected.querySelector('.js-filter-tag').innerText.trim();\n\n          if (tag.length) {\n            // Get previous input values in the input field and convert them into visual tokens\n            var previousInputValues = this.input.value.split(' ');\n            var searchTerms = [];\n\n            previousInputValues.forEach(function (value, index) {\n              searchTerms.push(value);\n\n              if (index === previousInputValues.length - 1 && token.indexOf(value.toLowerCase()) !== -1) {\n                searchTerms.pop();\n              }\n            });\n\n            if (searchTerms.length > 0) {\n              gl.FilteredSearchVisualTokens.addSearchVisualToken(searchTerms.join(' '));\n            }\n\n            gl.FilteredSearchDropdownManager.addWordToInput(token.replace(':', ''), '', false, this.container);\n          }\n          this.dismissDropdown();\n          this.dispatchInputEvent();\n        }\n      }\n    }\n  }, {\n    key: 'renderContent',\n    value: function renderContent() {\n      var dropdownData = gl.FilteredSearchTokenKeys.get().map(function (tokenKey) {\n        return {\n          icon: 'fa-' + tokenKey.icon,\n          hint: tokenKey.key,\n          tag: '<' + tokenKey.symbol + tokenKey.key + '>',\n          type: tokenKey.type\n        };\n      });\n\n      this.droplab.changeHookList(this.hookId, this.dropdown, [__WEBPACK_IMPORTED_MODULE_0__droplab_plugins_filter__[\"a\" /* default */]], this.config);\n      this.droplab.setData(this.hookId, dropdownData);\n    }\n  }, {\n    key: 'init',\n    value: function init() {\n      this.droplab.addHook(this.input, this.dropdown, [__WEBPACK_IMPORTED_MODULE_0__droplab_plugins_filter__[\"a\" /* default */]], this.config).init();\n    }\n  }]);\n\n  return DropdownHint;\n}(gl.FilteredSearchDropdown);\n\nwindow.gl = window.gl || {};\ngl.DropdownHint = DropdownHint;\n\n/***/ }),\n\n/***/ \"./filtered_search/dropdown_non_user.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__droplab_plugins_ajax__ = __webpack_require__(\"./droplab/plugins/ajax.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__droplab_plugins_filter__ = __webpack_require__(\"./droplab/plugins/filter.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__filtered_search_dropdown__ = __webpack_require__(\"./filtered_search/filtered_search_dropdown.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__filtered_search_dropdown___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2__filtered_search_dropdown__);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/* global Flash */\n\n\n\n\n\nvar DropdownNonUser = function (_gl$FilteredSearchDro) {\n  _inherits(DropdownNonUser, _gl$FilteredSearchDro);\n\n  function DropdownNonUser(droplab, dropdown, input, tokenKeys, filter, endpoint, symbol) {\n    _classCallCheck(this, DropdownNonUser);\n\n    var _this = _possibleConstructorReturn(this, (DropdownNonUser.__proto__ || Object.getPrototypeOf(DropdownNonUser)).call(this, droplab, dropdown, input, filter));\n\n    _this.symbol = symbol;\n    _this.config = {\n      Ajax: {\n        endpoint: endpoint,\n        method: 'setData',\n        loadingTemplate: _this.loadingTemplate,\n        onError: function onError() {\n          /* eslint-disable no-new */\n          new Flash('An error occured fetching the dropdown data.');\n          /* eslint-enable no-new */\n        }\n      },\n      Filter: {\n        filterFunction: gl.DropdownUtils.filterWithSymbol.bind(null, _this.symbol, input),\n        template: 'title'\n      }\n    };\n    return _this;\n  }\n\n  _createClass(DropdownNonUser, [{\n    key: 'itemClicked',\n    value: function itemClicked(e) {\n      var _this2 = this;\n\n      _get(DropdownNonUser.prototype.__proto__ || Object.getPrototypeOf(DropdownNonUser.prototype), 'itemClicked', this).call(this, e, function (selected) {\n        var title = selected.querySelector('.js-data-value').innerText.trim();\n        return '' + _this2.symbol + gl.DropdownUtils.getEscapedText(title);\n      });\n    }\n  }, {\n    key: 'renderContent',\n    value: function renderContent() {\n      var forceShowList = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      this.droplab.changeHookList(this.hookId, this.dropdown, [__WEBPACK_IMPORTED_MODULE_0__droplab_plugins_ajax__[\"a\" /* default */], __WEBPACK_IMPORTED_MODULE_1__droplab_plugins_filter__[\"a\" /* default */]], this.config);\n      _get(DropdownNonUser.prototype.__proto__ || Object.getPrototypeOf(DropdownNonUser.prototype), 'renderContent', this).call(this, forceShowList);\n    }\n  }, {\n    key: 'init',\n    value: function init() {\n      this.droplab.addHook(this.input, this.dropdown, [__WEBPACK_IMPORTED_MODULE_0__droplab_plugins_ajax__[\"a\" /* default */], __WEBPACK_IMPORTED_MODULE_1__droplab_plugins_filter__[\"a\" /* default */]], this.config).init();\n    }\n  }]);\n\n  return DropdownNonUser;\n}(gl.FilteredSearchDropdown);\n\nwindow.gl = window.gl || {};\ngl.DropdownNonUser = DropdownNonUser;\n\n/***/ }),\n\n/***/ \"./filtered_search/dropdown_user.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__droplab_plugins_ajax_filter__ = __webpack_require__(\"./droplab/plugins/ajax_filter.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__filtered_search_dropdown__ = __webpack_require__(\"./filtered_search/filtered_search_dropdown.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__filtered_search_dropdown___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__filtered_search_dropdown__);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/* global Flash */\n\n\n\n\nvar DropdownUser = function (_gl$FilteredSearchDro) {\n  _inherits(DropdownUser, _gl$FilteredSearchDro);\n\n  function DropdownUser(droplab, dropdown, input, tokenKeys, filter) {\n    _classCallCheck(this, DropdownUser);\n\n    var _this = _possibleConstructorReturn(this, (DropdownUser.__proto__ || Object.getPrototypeOf(DropdownUser)).call(this, droplab, dropdown, input, filter));\n\n    _this.config = {\n      AjaxFilter: {\n        endpoint: (gon.relative_url_root || '') + '/autocomplete/users.json',\n        searchKey: 'search',\n        params: {\n          per_page: 20,\n          active: true,\n          project_id: _this.getProjectId(),\n          current_user: true\n        },\n        searchValueFunction: _this.getSearchInput.bind(_this),\n        loadingTemplate: _this.loadingTemplate,\n        onLoadingFinished: function onLoadingFinished() {\n          _this.hideCurrentUser();\n        },\n        onError: function onError() {\n          /* eslint-disable no-new */\n          new Flash('An error occured fetching the dropdown data.');\n          /* eslint-enable no-new */\n        }\n      }\n    };\n    _this.tokenKeys = tokenKeys;\n    return _this;\n  }\n\n  _createClass(DropdownUser, [{\n    key: 'hideCurrentUser',\n    value: function hideCurrentUser() {\n      var currenUserItem = this.dropdown.querySelector('.js-current-user');\n      currenUserItem.classList.add('hidden');\n    }\n  }, {\n    key: 'itemClicked',\n    value: function itemClicked(e) {\n      _get(DropdownUser.prototype.__proto__ || Object.getPrototypeOf(DropdownUser.prototype), 'itemClicked', this).call(this, e, function (selected) {\n        return selected.querySelector('.dropdown-light-content').innerText.trim();\n      });\n    }\n  }, {\n    key: 'renderContent',\n    value: function renderContent() {\n      var forceShowList = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      this.droplab.changeHookList(this.hookId, this.dropdown, [__WEBPACK_IMPORTED_MODULE_0__droplab_plugins_ajax_filter__[\"a\" /* default */]], this.config);\n      _get(DropdownUser.prototype.__proto__ || Object.getPrototypeOf(DropdownUser.prototype), 'renderContent', this).call(this, forceShowList);\n    }\n  }, {\n    key: 'getProjectId',\n    value: function getProjectId() {\n      return this.input.getAttribute('data-project-id');\n    }\n  }, {\n    key: 'getSearchInput',\n    value: function getSearchInput() {\n      var query = gl.DropdownUtils.getSearchInput(this.input);\n\n      var _gl$FilteredSearchTok = gl.FilteredSearchTokenizer.processTokens(query, this.tokenKeys.get()),\n          lastToken = _gl$FilteredSearchTok.lastToken;\n\n      var value = lastToken || '';\n\n      if (value[0] === '@') {\n        value = value.slice(1);\n      }\n\n      // Removes the first character if it is a quotation so that we can search\n      // with multiple words\n      if (value[0] === '\"' || value[0] === '\\'') {\n        value = value.slice(1);\n      }\n\n      return value;\n    }\n  }, {\n    key: 'init',\n    value: function init() {\n      this.droplab.addHook(this.input, this.dropdown, [__WEBPACK_IMPORTED_MODULE_0__droplab_plugins_ajax_filter__[\"a\" /* default */]], this.config).init();\n    }\n  }]);\n\n  return DropdownUser;\n}(gl.FilteredSearchDropdown);\n\nwindow.gl = window.gl || {};\ngl.DropdownUser = DropdownUser;\n\n/***/ }),\n\n/***/ \"./filtered_search/dropdown_utils.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__container__ = __webpack_require__(\"./filtered_search/container.js\");\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\nvar DropdownUtils = function () {\n  function DropdownUtils() {\n    _classCallCheck(this, DropdownUtils);\n  }\n\n  _createClass(DropdownUtils, null, [{\n    key: 'getEscapedText',\n    value: function getEscapedText(text) {\n      var escapedText = text;\n      var hasSpace = text.indexOf(' ') !== -1;\n      var hasDoubleQuote = text.indexOf('\"') !== -1;\n\n      // Encapsulate value with quotes if it has spaces\n      // Known side effect: values's with both single and double quotes\n      // won't escape properly\n      if (hasSpace) {\n        if (hasDoubleQuote) {\n          escapedText = '\\'' + text + '\\'';\n        } else {\n          // Encapsulate singleQuotes or if it hasSpace\n          escapedText = '\"' + text + '\"';\n        }\n      }\n\n      return escapedText;\n    }\n  }, {\n    key: 'filterWithSymbol',\n    value: function filterWithSymbol(filterSymbol, input, item) {\n      var updatedItem = item;\n      var searchInput = gl.DropdownUtils.getSearchInput(input);\n\n      var title = updatedItem.title.toLowerCase();\n      var value = searchInput.toLowerCase();\n      var symbol = '';\n\n      // Remove the symbol for filter\n      if (value[0] === filterSymbol) {\n        symbol = value[0];\n        value = value.slice(1);\n      }\n\n      // Removes the first character if it is a quotation so that we can search\n      // with multiple words\n      if ((value[0] === '\"' || value[0] === '\\'') && title.indexOf(' ') !== -1) {\n        value = value.slice(1);\n      }\n\n      // Eg. filterSymbol = ~ for labels\n      var matchWithoutSymbol = symbol === filterSymbol && title.indexOf(value) !== -1;\n      var match = title.indexOf('' + symbol + value) !== -1;\n\n      updatedItem.droplab_hidden = !match && !matchWithoutSymbol;\n\n      return updatedItem;\n    }\n  }, {\n    key: 'filterHint',\n    value: function filterHint(config, item) {\n      var input = config.input,\n          allowedKeys = config.allowedKeys;\n\n      var updatedItem = item;\n      var searchInput = gl.DropdownUtils.getSearchQuery(input);\n\n      var _gl$FilteredSearchTok = gl.FilteredSearchTokenizer.processTokens(searchInput, allowedKeys),\n          lastToken = _gl$FilteredSearchTok.lastToken,\n          tokens = _gl$FilteredSearchTok.tokens;\n\n      var lastKey = lastToken.key || lastToken || '';\n      var allowMultiple = item.type === 'array';\n      var itemInExistingTokens = tokens.some(function (t) {\n        return t.key === item.hint;\n      });\n\n      if (!allowMultiple && itemInExistingTokens) {\n        updatedItem.droplab_hidden = true;\n      } else if (!lastKey || searchInput.split('').last() === ' ') {\n        updatedItem.droplab_hidden = false;\n      } else if (lastKey) {\n        var split = lastKey.split(':');\n        var tokenName = split[0].split(' ').last();\n\n        var match = updatedItem.hint.indexOf(tokenName.toLowerCase()) === -1;\n        updatedItem.droplab_hidden = tokenName ? match : false;\n      }\n\n      return updatedItem;\n    }\n  }, {\n    key: 'setDataValueIfSelected',\n    value: function setDataValueIfSelected(filter, selected) {\n      var dataValue = selected.getAttribute('data-value');\n\n      if (dataValue) {\n        gl.FilteredSearchDropdownManager.addWordToInput(filter, dataValue, true);\n      }\n\n      // Return boolean based on whether it was set\n      return dataValue !== null;\n    }\n\n    // Determines the full search query (visual tokens + input)\n\n  }, {\n    key: 'getSearchQuery',\n    value: function getSearchQuery() {\n      var untilInput = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      var container = __WEBPACK_IMPORTED_MODULE_0__container__[\"a\" /* default */].container;\n      var tokens = [].slice.call(container.querySelectorAll('.tokens-container li'));\n      var values = [];\n\n      if (untilInput) {\n        var inputIndex = _.findIndex(tokens, function (t) {\n          return t.classList.contains('input-token');\n        });\n        // Add one to include input-token to the tokens array\n        tokens.splice(inputIndex + 1);\n      }\n\n      tokens.forEach(function (token) {\n        if (token.classList.contains('js-visual-token')) {\n          var name = token.querySelector('.name');\n          var value = token.querySelector('.value');\n          var valueContainer = token.querySelector('.value-container');\n          var symbol = value && value.dataset.symbol ? value.dataset.symbol : '';\n          var valueText = '';\n\n          if (valueContainer && valueContainer.dataset.originalValue) {\n            valueText = valueContainer.dataset.originalValue;\n          } else if (value && value.innerText) {\n            valueText = value.innerText;\n          }\n\n          if (token.className.indexOf('filtered-search-token') !== -1) {\n            values.push(name.innerText.toLowerCase() + ':' + symbol + valueText);\n          } else {\n            values.push(name.innerText);\n          }\n        } else if (token.classList.contains('input-token')) {\n          var _gl$FilteredSearchVis = gl.FilteredSearchVisualTokens.getLastVisualTokenBeforeInput(),\n              isLastVisualTokenValid = _gl$FilteredSearchVis.isLastVisualTokenValid;\n\n          var input = __WEBPACK_IMPORTED_MODULE_0__container__[\"a\" /* default */].container.querySelector('.filtered-search');\n          var inputValue = input && input.value;\n\n          if (isLastVisualTokenValid) {\n            values.push(inputValue);\n          } else {\n            var previous = values.pop();\n            values.push('' + previous + inputValue);\n          }\n        }\n      });\n\n      return values.map(function (value) {\n        return value.trim();\n      }).join(' ');\n    }\n  }, {\n    key: 'getSearchInput',\n    value: function getSearchInput(filteredSearchInput) {\n      var inputValue = filteredSearchInput.value;\n\n      var _gl$DropdownUtils$get = gl.DropdownUtils.getInputSelectionPosition(filteredSearchInput),\n          right = _gl$DropdownUtils$get.right;\n\n      return inputValue.slice(0, right);\n    }\n  }, {\n    key: 'getInputSelectionPosition',\n    value: function getInputSelectionPosition(input) {\n      var selectionStart = input.selectionStart;\n      var inputValue = input.value;\n      // Replace all spaces inside quote marks with underscores\n      // (will continue to match entire string until an end quote is found if any)\n      // This helps with matching the beginning & end of a token:key\n      inputValue = inputValue.replace(/(('[^']*'{0,1})|(\"[^\"]*\"{0,1})|:\\s+)/g, function (str) {\n        return str.replace(/\\s/g, '_');\n      });\n\n      // Get the right position for the word selected\n      // Regex matches first space\n      var right = inputValue.slice(selectionStart).search(/\\s/);\n\n      if (right >= 0) {\n        right += selectionStart;\n      } else if (right < 0) {\n        right = inputValue.length;\n      }\n\n      // Get the left position for the word selected\n      // Regex matches last non-whitespace character\n      var left = inputValue.slice(0, right).search(/\\S+$/);\n\n      if (selectionStart === 0) {\n        left = 0;\n      } else if (selectionStart === inputValue.length && left < 0) {\n        left = inputValue.length;\n      } else if (left < 0) {\n        left = selectionStart;\n      }\n\n      return {\n        left: left,\n        right: right\n      };\n    }\n  }]);\n\n  return DropdownUtils;\n}();\n\nwindow.gl = window.gl || {};\ngl.DropdownUtils = DropdownUtils;\n\n/***/ }),\n\n/***/ \"./filtered_search/event_hub.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_vue__ = __webpack_require__(\"../../../node_modules/vue/dist/vue.esm.js\");\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (new __WEBPACK_IMPORTED_MODULE_0_vue__[\"default\"]());\n\n/***/ }),\n\n/***/ \"./filtered_search/filtered_search_bundle.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__dropdown_hint__ = __webpack_require__(\"./filtered_search/dropdown_hint.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__dropdown_non_user__ = __webpack_require__(\"./filtered_search/dropdown_non_user.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__dropdown_user__ = __webpack_require__(\"./filtered_search/dropdown_user.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__dropdown_utils__ = __webpack_require__(\"./filtered_search/dropdown_utils.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__filtered_search_token_keys__ = __webpack_require__(\"./filtered_search/filtered_search_token_keys.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__filtered_search_token_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4__filtered_search_token_keys__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__filtered_search_dropdown_manager__ = __webpack_require__(\"./filtered_search/filtered_search_dropdown_manager.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__filtered_search_dropdown__ = __webpack_require__(\"./filtered_search/filtered_search_dropdown.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__filtered_search_dropdown___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6__filtered_search_dropdown__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__filtered_search_manager__ = __webpack_require__(\"./filtered_search/filtered_search_manager.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__filtered_search_tokenizer__ = __webpack_require__(\"./filtered_search/filtered_search_tokenizer.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__filtered_search_visual_tokens__ = __webpack_require__(\"./filtered_search/filtered_search_visual_tokens.js\");\n\n\n\n\n\n\n\n\n\n\n\n/***/ }),\n\n/***/ \"./filtered_search/filtered_search_dropdown.js\":\n/***/ (function(module, exports) {\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar DATA_DROPDOWN_TRIGGER = 'data-dropdown-trigger';\n\nvar FilteredSearchDropdown = function () {\n  function FilteredSearchDropdown(droplab, dropdown, input, filter) {\n    _classCallCheck(this, FilteredSearchDropdown);\n\n    this.droplab = droplab;\n    this.hookId = input && input.id;\n    this.input = input;\n    this.filter = filter;\n    this.dropdown = dropdown;\n    this.loadingTemplate = '<div class=\"filter-dropdown-loading\">\\n      <i class=\"fa fa-spinner fa-spin\"></i>\\n    </div>';\n    this.bindEvents();\n  }\n\n  _createClass(FilteredSearchDropdown, [{\n    key: 'bindEvents',\n    value: function bindEvents() {\n      this.itemClickedWrapper = this.itemClicked.bind(this);\n      this.dropdown.addEventListener('click.dl', this.itemClickedWrapper);\n    }\n  }, {\n    key: 'unbindEvents',\n    value: function unbindEvents() {\n      this.dropdown.removeEventListener('click.dl', this.itemClickedWrapper);\n    }\n  }, {\n    key: 'getCurrentHook',\n    value: function getCurrentHook() {\n      var _this = this;\n\n      return this.droplab.hooks.filter(function (h) {\n        return h.id === _this.hookId;\n      })[0] || null;\n    }\n  }, {\n    key: 'itemClicked',\n    value: function itemClicked(e, getValueFunction) {\n      var selected = e.detail.selected;\n\n\n      if (selected.tagName === 'LI' && selected.innerHTML) {\n        var dataValueSet = gl.DropdownUtils.setDataValueIfSelected(this.filter, selected);\n\n        if (!dataValueSet) {\n          var value = getValueFunction(selected);\n          gl.FilteredSearchDropdownManager.addWordToInput(this.filter, value, true);\n        }\n\n        this.resetFilters();\n        this.dismissDropdown();\n        this.dispatchInputEvent();\n      }\n    }\n  }, {\n    key: 'setAsDropdown',\n    value: function setAsDropdown() {\n      this.input.setAttribute(DATA_DROPDOWN_TRIGGER, '#' + this.dropdown.id);\n    }\n  }, {\n    key: 'setOffset',\n    value: function setOffset() {\n      var offset = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n      if (window.innerWidth > 480) {\n        this.dropdown.style.left = offset + 'px';\n      } else {\n        this.dropdown.style.left = '0px';\n      }\n    }\n  }, {\n    key: 'renderContent',\n    value: function renderContent() {\n      var forceShowList = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      var currentHook = this.getCurrentHook();\n      if (forceShowList && currentHook && currentHook.list.hidden) {\n        currentHook.list.show();\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var forceRenderContent = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var forceShowList = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      this.setAsDropdown();\n\n      var currentHook = this.getCurrentHook();\n      var firstTimeInitialized = currentHook === null;\n\n      if (firstTimeInitialized || forceRenderContent) {\n        this.renderContent(forceShowList);\n      } else if (currentHook.list.list.id !== this.dropdown.id) {\n        this.renderContent(forceShowList);\n      }\n    }\n  }, {\n    key: 'dismissDropdown',\n    value: function dismissDropdown() {\n      // Focusing on the input will dismiss dropdown\n      // (default droplab functionality)\n      this.input.focus();\n    }\n  }, {\n    key: 'dispatchInputEvent',\n    value: function dispatchInputEvent() {\n      // Propogate input change to FilteredSearchDropdownManager\n      // so that it can determine which dropdowns to open\n      this.input.dispatchEvent(new CustomEvent('input', {\n        bubbles: true,\n        cancelable: true\n      }));\n    }\n  }, {\n    key: 'dispatchFormSubmitEvent',\n    value: function dispatchFormSubmitEvent() {\n      // dispatchEvent() is necessary as form.submit() does not\n      // trigger event handlers\n      this.input.form.dispatchEvent(new Event('submit'));\n    }\n  }, {\n    key: 'hideDropdown',\n    value: function hideDropdown() {\n      var currentHook = this.getCurrentHook();\n      if (currentHook) {\n        currentHook.list.hide();\n      }\n    }\n  }, {\n    key: 'resetFilters',\n    value: function resetFilters() {\n      var hook = this.getCurrentHook();\n\n      if (hook) {\n        var data = hook.list.data || [];\n        var results = data.map(function (o) {\n          var updated = o;\n          updated.droplab_hidden = false;\n          return updated;\n        });\n        hook.list.render(results);\n      }\n    }\n  }]);\n\n  return FilteredSearchDropdown;\n}();\n\nwindow.gl = window.gl || {};\ngl.FilteredSearchDropdown = FilteredSearchDropdown;\n\n/***/ }),\n\n/***/ \"./filtered_search/filtered_search_dropdown_manager.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__droplab_drop_lab__ = __webpack_require__(\"./droplab/drop_lab.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__container__ = __webpack_require__(\"./filtered_search/container.js\");\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\n\nvar FilteredSearchDropdownManager = function () {\n  function FilteredSearchDropdownManager() {\n    var baseEndpoint = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var tokenizer = arguments[1];\n    var page = arguments[2];\n\n    _classCallCheck(this, FilteredSearchDropdownManager);\n\n    this.container = __WEBPACK_IMPORTED_MODULE_1__container__[\"a\" /* default */].container;\n    this.baseEndpoint = baseEndpoint.replace(/\\/$/, '');\n    this.tokenizer = tokenizer;\n    this.filteredSearchTokenKeys = gl.FilteredSearchTokenKeys;\n    this.filteredSearchInput = this.container.querySelector('.filtered-search');\n    this.page = page;\n\n    this.setupMapping();\n\n    this.cleanupWrapper = this.cleanup.bind(this);\n    document.addEventListener('beforeunload', this.cleanupWrapper);\n  }\n\n  _createClass(FilteredSearchDropdownManager, [{\n    key: 'cleanup',\n    value: function cleanup() {\n      if (this.droplab) {\n        this.droplab.destroy();\n        this.droplab = null;\n      }\n\n      this.setupMapping();\n\n      document.removeEventListener('beforeunload', this.cleanupWrapper);\n    }\n  }, {\n    key: 'setupMapping',\n    value: function setupMapping() {\n      this.mapping = {\n        author: {\n          reference: null,\n          gl: 'DropdownUser',\n          element: this.container.querySelector('#js-dropdown-author')\n        },\n        assignee: {\n          reference: null,\n          gl: 'DropdownUser',\n          element: this.container.querySelector('#js-dropdown-assignee')\n        },\n        milestone: {\n          reference: null,\n          gl: 'DropdownNonUser',\n          extraArguments: [this.baseEndpoint + '/milestones.json', '%'],\n          element: this.container.querySelector('#js-dropdown-milestone')\n        },\n        label: {\n          reference: null,\n          gl: 'DropdownNonUser',\n          extraArguments: [this.baseEndpoint + '/labels.json', '~'],\n          element: this.container.querySelector('#js-dropdown-label')\n        },\n        hint: {\n          reference: null,\n          gl: 'DropdownHint',\n          element: this.container.querySelector('#js-dropdown-hint')\n        }\n      };\n    }\n  }, {\n    key: 'updateCurrentDropdownOffset',\n    value: function updateCurrentDropdownOffset() {\n      this.updateDropdownOffset(this.currentDropdown);\n    }\n  }, {\n    key: 'updateDropdownOffset',\n    value: function updateDropdownOffset(key) {\n      // Always align dropdown with the input field\n      var offset = this.filteredSearchInput.getBoundingClientRect().left - this.container.querySelector('.scroll-container').getBoundingClientRect().left;\n\n      var maxInputWidth = 240;\n      var currentDropdownWidth = this.mapping[key].element.clientWidth || maxInputWidth;\n\n      // Make sure offset never exceeds the input container\n      var offsetMaxWidth = this.container.querySelector('.scroll-container').clientWidth - currentDropdownWidth;\n      if (offsetMaxWidth < offset) {\n        offset = offsetMaxWidth;\n      }\n\n      this.mapping[key].reference.setOffset(offset);\n    }\n  }, {\n    key: 'load',\n    value: function load(key) {\n      var firstLoad = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      var mappingKey = this.mapping[key];\n      var glClass = mappingKey.gl;\n      var element = mappingKey.element;\n      var forceShowList = false;\n\n      if (!mappingKey.reference) {\n        var dl = this.droplab;\n        var defaultArguments = [null, dl, element, this.filteredSearchInput, this.filteredSearchTokenKeys, key];\n        var glArguments = defaultArguments.concat(mappingKey.extraArguments || []);\n\n        // Passing glArguments to `new gl[glClass](<arguments>)`\n        mappingKey.reference = new (Function.prototype.bind.apply(gl[glClass], glArguments))();\n      }\n\n      if (firstLoad) {\n        mappingKey.reference.init();\n      }\n\n      if (this.currentDropdown === 'hint') {\n        // Force the dropdown to show if it was clicked from the hint dropdown\n        forceShowList = true;\n      }\n\n      this.updateDropdownOffset(key);\n      mappingKey.reference.render(firstLoad, forceShowList);\n\n      this.currentDropdown = key;\n    }\n  }, {\n    key: 'loadDropdown',\n    value: function loadDropdown() {\n      var dropdownName = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n\n      var firstLoad = false;\n\n      if (!this.droplab) {\n        firstLoad = true;\n        this.droplab = new __WEBPACK_IMPORTED_MODULE_0__droplab_drop_lab__[\"a\" /* default */]();\n      }\n\n      var match = this.filteredSearchTokenKeys.searchByKey(dropdownName.toLowerCase());\n      var shouldOpenFilterDropdown = match && this.currentDropdown !== match.key && this.mapping[match.key];\n      var shouldOpenHintDropdown = !match && this.currentDropdown !== 'hint';\n\n      if (shouldOpenFilterDropdown || shouldOpenHintDropdown) {\n        var key = match && match.key ? match.key : 'hint';\n        this.load(key, firstLoad);\n      }\n    }\n  }, {\n    key: 'setDropdown',\n    value: function setDropdown() {\n      var query = gl.DropdownUtils.getSearchQuery(true);\n\n      var _tokenizer$processTok = this.tokenizer.processTokens(query, this.filteredSearchTokenKeys.getKeys()),\n          lastToken = _tokenizer$processTok.lastToken,\n          searchToken = _tokenizer$processTok.searchToken;\n\n      if (this.currentDropdown) {\n        this.updateCurrentDropdownOffset();\n      }\n\n      if (lastToken === searchToken && lastToken !== null) {\n        // Token is not fully initialized yet because it has no value\n        // Eg. token = 'label:'\n\n        var split = lastToken.split(':');\n        var dropdownName = split[0].split(' ').last();\n        this.loadDropdown(split.length > 1 ? dropdownName : '');\n      } else if (lastToken) {\n        // Token has been initialized into an object because it has a value\n        this.loadDropdown(lastToken.key);\n      } else {\n        this.loadDropdown('hint');\n      }\n    }\n  }, {\n    key: 'resetDropdowns',\n    value: function resetDropdowns() {\n      if (!this.currentDropdown) {\n        return;\n      }\n\n      // Force current dropdown to hide\n      this.mapping[this.currentDropdown].reference.hideDropdown();\n\n      // Re-Load dropdown\n      this.setDropdown();\n\n      // Reset filters for current dropdown\n      this.mapping[this.currentDropdown].reference.resetFilters();\n\n      // Reposition dropdown so that it is aligned with cursor\n      this.updateDropdownOffset(this.currentDropdown);\n    }\n  }, {\n    key: 'destroyDroplab',\n    value: function destroyDroplab() {\n      this.droplab.destroy();\n    }\n  }], [{\n    key: 'addWordToInput',\n    value: function addWordToInput(tokenName) {\n      var tokenValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n      var clicked = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n      var input = __WEBPACK_IMPORTED_MODULE_1__container__[\"a\" /* default */].container.querySelector('.filtered-search');\n\n      gl.FilteredSearchVisualTokens.addFilterVisualToken(tokenName, tokenValue);\n      input.value = '';\n\n      if (clicked) {\n        gl.FilteredSearchVisualTokens.moveInputToTheRight();\n      }\n    }\n  }]);\n\n  return FilteredSearchDropdownManager;\n}();\n\nwindow.gl = window.gl || {};\ngl.FilteredSearchDropdownManager = FilteredSearchDropdownManager;\n\n/***/ }),\n\n/***/ \"./filtered_search/filtered_search_manager.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__container__ = __webpack_require__(\"./filtered_search/container.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__recent_searches_root__ = __webpack_require__(\"./filtered_search/recent_searches_root.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__stores_recent_searches_store__ = __webpack_require__(\"./filtered_search/stores/recent_searches_store.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__services_recent_searches_service__ = __webpack_require__(\"./filtered_search/services/recent_searches_service.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__event_hub__ = __webpack_require__(\"./filtered_search/event_hub.js\");\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\n\n\n\n\nvar FilteredSearchManager = function () {\n  function FilteredSearchManager(page) {\n    _classCallCheck(this, FilteredSearchManager);\n\n    this.page = page;\n    this.container = __WEBPACK_IMPORTED_MODULE_0__container__[\"a\" /* default */].container;\n    this.filteredSearchInput = this.container.querySelector('.filtered-search');\n    this.filteredSearchInputForm = this.filteredSearchInput.form;\n    this.clearSearchButton = this.container.querySelector('.clear-search');\n    this.tokensContainer = this.container.querySelector('.tokens-container');\n    this.filteredSearchTokenKeys = gl.FilteredSearchTokenKeys;\n\n    this.recentSearchesStore = new __WEBPACK_IMPORTED_MODULE_2__stores_recent_searches_store__[\"a\" /* default */]({\n      isLocalStorageAvailable: __WEBPACK_IMPORTED_MODULE_3__services_recent_searches_service__[\"a\" /* default */].isAvailable(),\n      allowedKeys: this.filteredSearchTokenKeys.getKeys()\n    });\n    this.searchHistoryDropdownElement = document.querySelector('.js-filtered-search-history-dropdown');\n    var projectPath = this.searchHistoryDropdownElement ? this.searchHistoryDropdownElement.dataset.projectFullPath : 'project';\n    var recentSearchesPagePrefix = 'issue-recent-searches';\n    if (this.page === 'merge_requests') {\n      recentSearchesPagePrefix = 'merge-request-recent-searches';\n    }\n    var recentSearchesKey = projectPath + '-' + recentSearchesPagePrefix;\n    this.recentSearchesService = new __WEBPACK_IMPORTED_MODULE_3__services_recent_searches_service__[\"a\" /* default */](recentSearchesKey);\n  }\n\n  _createClass(FilteredSearchManager, [{\n    key: 'setup',\n    value: function setup() {\n      var _this = this;\n\n      // Fetch recent searches from localStorage\n      this.fetchingRecentSearchesPromise = this.recentSearchesService.fetch().catch(function (error) {\n        if (error.name === 'RecentSearchesServiceError') return undefined;\n        // eslint-disable-next-line no-new\n        new window.Flash('An error occured while parsing recent searches');\n        // Gracefully fail to empty array\n        return [];\n      }).then(function (searches) {\n        // Put any searches that may have come in before\n        // we fetched the saved searches ahead of the already saved ones\n        var resultantSearches = _this.recentSearchesStore.setRecentSearches(_this.recentSearchesStore.state.recentSearches.concat(searches));\n        _this.recentSearchesService.save(resultantSearches);\n      });\n\n      if (this.filteredSearchInput) {\n        this.tokenizer = gl.FilteredSearchTokenizer;\n        this.dropdownManager = new gl.FilteredSearchDropdownManager(this.filteredSearchInput.getAttribute('data-base-endpoint') || '', this.tokenizer, this.page);\n\n        this.recentSearchesRoot = new __WEBPACK_IMPORTED_MODULE_1__recent_searches_root__[\"a\" /* default */](this.recentSearchesStore, this.recentSearchesService, this.searchHistoryDropdownElement);\n        this.recentSearchesRoot.init();\n\n        this.bindEvents();\n        this.loadSearchParamsFromURL();\n        this.dropdownManager.setDropdown();\n\n        this.cleanupWrapper = this.cleanup.bind(this);\n        document.addEventListener('beforeunload', this.cleanupWrapper);\n      }\n    }\n  }, {\n    key: 'cleanup',\n    value: function cleanup() {\n      this.unbindEvents();\n      document.removeEventListener('beforeunload', this.cleanupWrapper);\n\n      if (this.recentSearchesRoot) {\n        this.recentSearchesRoot.destroy();\n      }\n    }\n  }, {\n    key: 'bindStateEvents',\n    value: function bindStateEvents() {\n      this.stateFilters = document.querySelector('.container-fluid .issues-state-filters');\n\n      if (this.stateFilters) {\n        this.searchStateWrapper = this.searchState.bind(this);\n\n        this.stateFilters.querySelector('[data-state=\"opened\"]').addEventListener('click', this.searchStateWrapper);\n        this.stateFilters.querySelector('[data-state=\"closed\"]').addEventListener('click', this.searchStateWrapper);\n        this.stateFilters.querySelector('[data-state=\"all\"]').addEventListener('click', this.searchStateWrapper);\n\n        this.mergedState = this.stateFilters.querySelector('[data-state=\"merged\"]');\n        if (this.mergedState) {\n          this.mergedState.addEventListener('click', this.searchStateWrapper);\n        }\n      }\n    }\n  }, {\n    key: 'unbindStateEvents',\n    value: function unbindStateEvents() {\n      if (this.stateFilters) {\n        this.stateFilters.querySelector('[data-state=\"opened\"]').removeEventListener('click', this.searchStateWrapper);\n        this.stateFilters.querySelector('[data-state=\"closed\"]').removeEventListener('click', this.searchStateWrapper);\n        this.stateFilters.querySelector('[data-state=\"all\"]').removeEventListener('click', this.searchStateWrapper);\n\n        if (this.mergedState) {\n          this.mergedState.removeEventListener('click', this.searchStateWrapper);\n        }\n      }\n    }\n  }, {\n    key: 'bindEvents',\n    value: function bindEvents() {\n      this.handleFormSubmit = this.handleFormSubmit.bind(this);\n      this.setDropdownWrapper = this.dropdownManager.setDropdown.bind(this.dropdownManager);\n      this.toggleClearSearchButtonWrapper = this.toggleClearSearchButton.bind(this);\n      this.handleInputPlaceholderWrapper = this.handleInputPlaceholder.bind(this);\n      this.handleInputVisualTokenWrapper = this.handleInputVisualToken.bind(this);\n      this.checkForEnterWrapper = this.checkForEnter.bind(this);\n      this.onClearSearchWrapper = this.onClearSearch.bind(this);\n      this.checkForBackspaceWrapper = this.checkForBackspace.bind(this);\n      this.removeSelectedTokenKeydownWrapper = this.removeSelectedTokenKeydown.bind(this);\n      this.unselectEditTokensWrapper = this.unselectEditTokens.bind(this);\n      this.editTokenWrapper = this.editToken.bind(this);\n      this.tokenChange = this.tokenChange.bind(this);\n      this.addInputContainerFocusWrapper = this.addInputContainerFocus.bind(this);\n      this.removeInputContainerFocusWrapper = this.removeInputContainerFocus.bind(this);\n      this.onrecentSearchesItemSelectedWrapper = this.onrecentSearchesItemSelected.bind(this);\n      this.removeTokenWrapper = this.removeToken.bind(this);\n\n      this.filteredSearchInputForm.addEventListener('submit', this.handleFormSubmit);\n      this.filteredSearchInput.addEventListener('input', this.setDropdownWrapper);\n      this.filteredSearchInput.addEventListener('input', this.toggleClearSearchButtonWrapper);\n      this.filteredSearchInput.addEventListener('input', this.handleInputPlaceholderWrapper);\n      this.filteredSearchInput.addEventListener('input', this.handleInputVisualTokenWrapper);\n      this.filteredSearchInput.addEventListener('keydown', this.checkForEnterWrapper);\n      this.filteredSearchInput.addEventListener('keyup', this.checkForBackspaceWrapper);\n      this.filteredSearchInput.addEventListener('click', this.tokenChange);\n      this.filteredSearchInput.addEventListener('keyup', this.tokenChange);\n      this.filteredSearchInput.addEventListener('focus', this.addInputContainerFocusWrapper);\n      this.tokensContainer.addEventListener('click', this.removeTokenWrapper);\n      this.tokensContainer.addEventListener('click', this.editTokenWrapper);\n      this.clearSearchButton.addEventListener('click', this.onClearSearchWrapper);\n      document.addEventListener('click', this.unselectEditTokensWrapper);\n      document.addEventListener('click', this.removeInputContainerFocusWrapper);\n      document.addEventListener('keydown', this.removeSelectedTokenKeydownWrapper);\n      __WEBPACK_IMPORTED_MODULE_4__event_hub__[\"a\" /* default */].$on('recentSearchesItemSelected', this.onrecentSearchesItemSelectedWrapper);\n\n      this.bindStateEvents();\n    }\n  }, {\n    key: 'unbindEvents',\n    value: function unbindEvents() {\n      this.filteredSearchInputForm.removeEventListener('submit', this.handleFormSubmit);\n      this.filteredSearchInput.removeEventListener('input', this.setDropdownWrapper);\n      this.filteredSearchInput.removeEventListener('input', this.toggleClearSearchButtonWrapper);\n      this.filteredSearchInput.removeEventListener('input', this.handleInputPlaceholderWrapper);\n      this.filteredSearchInput.removeEventListener('input', this.handleInputVisualTokenWrapper);\n      this.filteredSearchInput.removeEventListener('keydown', this.checkForEnterWrapper);\n      this.filteredSearchInput.removeEventListener('keyup', this.checkForBackspaceWrapper);\n      this.filteredSearchInput.removeEventListener('click', this.tokenChange);\n      this.filteredSearchInput.removeEventListener('keyup', this.tokenChange);\n      this.filteredSearchInput.removeEventListener('focus', this.addInputContainerFocusWrapper);\n      this.tokensContainer.removeEventListener('click', this.removeTokenWrapper);\n      this.tokensContainer.removeEventListener('click', this.editTokenWrapper);\n      this.clearSearchButton.removeEventListener('click', this.onClearSearchWrapper);\n      document.removeEventListener('click', this.unselectEditTokensWrapper);\n      document.removeEventListener('click', this.removeInputContainerFocusWrapper);\n      document.removeEventListener('keydown', this.removeSelectedTokenKeydownWrapper);\n      __WEBPACK_IMPORTED_MODULE_4__event_hub__[\"a\" /* default */].$off('recentSearchesItemSelected', this.onrecentSearchesItemSelectedWrapper);\n\n      this.unbindStateEvents();\n    }\n  }, {\n    key: 'checkForBackspace',\n    value: function checkForBackspace(e) {\n      // 8 = Backspace Key\n      // 46 = Delete Key\n      if (e.keyCode === 8 || e.keyCode === 46) {\n        var _gl$FilteredSearchVis = gl.FilteredSearchVisualTokens.getLastVisualTokenBeforeInput(),\n            lastVisualToken = _gl$FilteredSearchVis.lastVisualToken;\n\n        var sanitizedTokenName = lastVisualToken && lastVisualToken.querySelector('.name').textContent.trim();\n        var canEdit = sanitizedTokenName && this.canEdit && this.canEdit(sanitizedTokenName);\n        if (this.filteredSearchInput.value === '' && lastVisualToken && canEdit) {\n          this.filteredSearchInput.value = gl.FilteredSearchVisualTokens.getLastTokenPartial();\n          gl.FilteredSearchVisualTokens.removeLastTokenPartial();\n        }\n\n        // Reposition dropdown so that it is aligned with cursor\n        this.dropdownManager.updateCurrentDropdownOffset();\n      }\n    }\n  }, {\n    key: 'checkForEnter',\n    value: function checkForEnter(e) {\n      if (e.keyCode === 38 || e.keyCode === 40) {\n        var selectionStart = this.filteredSearchInput.selectionStart;\n\n        e.preventDefault();\n        this.filteredSearchInput.setSelectionRange(selectionStart, selectionStart);\n      }\n\n      if (e.keyCode === 13) {\n        var dropdown = this.dropdownManager.mapping[this.dropdownManager.currentDropdown];\n        var dropdownEl = dropdown.element;\n        var activeElements = dropdownEl.querySelectorAll('.droplab-item-active');\n\n        e.preventDefault();\n\n        if (!activeElements.length) {\n          if (this.isHandledAsync) {\n            e.stopImmediatePropagation();\n\n            this.filteredSearchInput.blur();\n            this.dropdownManager.resetDropdowns();\n          } else {\n            // Prevent droplab from opening dropdown\n            this.dropdownManager.destroyDroplab();\n          }\n\n          this.search();\n        }\n      }\n    }\n  }, {\n    key: 'addInputContainerFocus',\n    value: function addInputContainerFocus() {\n      var inputContainer = this.filteredSearchInput.closest('.filtered-search-box');\n\n      if (inputContainer) {\n        inputContainer.classList.add('focus');\n      }\n    }\n  }, {\n    key: 'removeInputContainerFocus',\n    value: function removeInputContainerFocus(e) {\n      var inputContainer = this.filteredSearchInput.closest('.filtered-search-box');\n      var isElementInFilteredSearch = inputContainer && inputContainer.contains(e.target);\n      var isElementInDynamicFilterDropdown = e.target.closest('.filter-dropdown') !== null;\n      var isElementInStaticFilterDropdown = e.target.closest('ul[data-dropdown]') !== null;\n\n      if (!isElementInFilteredSearch && !isElementInDynamicFilterDropdown && !isElementInStaticFilterDropdown && inputContainer) {\n        inputContainer.classList.remove('focus');\n      }\n    }\n  }, {\n    key: 'removeToken',\n    value: function removeToken(e) {\n      var removeButtonSelected = e.target.closest('.remove-token');\n\n      if (removeButtonSelected) {\n        e.preventDefault();\n        // Prevent editToken from being triggered after token is removed\n        e.stopImmediatePropagation();\n\n        var button = e.target.closest('.selectable');\n        gl.FilteredSearchVisualTokens.selectToken(button, true);\n        this.removeSelectedToken();\n      }\n    }\n  }, {\n    key: 'unselectEditTokens',\n    value: function unselectEditTokens(e) {\n      var inputContainer = this.container.querySelector('.filtered-search-box');\n      var isElementInFilteredSearch = inputContainer && inputContainer.contains(e.target);\n      var isElementInFilterDropdown = e.target.closest('.filter-dropdown') !== null;\n      var isElementTokensContainer = e.target.classList.contains('tokens-container');\n\n      if (!isElementInFilteredSearch && !isElementInFilterDropdown || isElementTokensContainer) {\n        gl.FilteredSearchVisualTokens.moveInputToTheRight();\n        this.dropdownManager.resetDropdowns();\n      }\n    }\n  }, {\n    key: 'editToken',\n    value: function editToken(e) {\n      var token = e.target.closest('.js-visual-token');\n      var sanitizedTokenName = token && token.querySelector('.name').textContent.trim();\n      var canEdit = this.canEdit && this.canEdit(sanitizedTokenName);\n\n      if (token && canEdit) {\n        e.preventDefault();\n        e.stopPropagation();\n        gl.FilteredSearchVisualTokens.editToken(token);\n        this.tokenChange();\n      }\n    }\n  }, {\n    key: 'toggleClearSearchButton',\n    value: function toggleClearSearchButton() {\n      var query = gl.DropdownUtils.getSearchQuery();\n      var hidden = 'hidden';\n      var hasHidden = this.clearSearchButton.classList.contains(hidden);\n\n      if (query.length === 0 && !hasHidden) {\n        this.clearSearchButton.classList.add(hidden);\n      } else if (query.length && hasHidden) {\n        this.clearSearchButton.classList.remove(hidden);\n      }\n    }\n  }, {\n    key: 'handleInputPlaceholder',\n    value: function handleInputPlaceholder() {\n      var query = gl.DropdownUtils.getSearchQuery();\n      var placeholder = 'Search or filter results...';\n      var currentPlaceholder = this.filteredSearchInput.placeholder;\n\n      if (query.length === 0 && currentPlaceholder !== placeholder) {\n        this.filteredSearchInput.placeholder = placeholder;\n      } else if (query.length > 0 && currentPlaceholder !== '') {\n        this.filteredSearchInput.placeholder = '';\n      }\n    }\n  }, {\n    key: 'removeSelectedTokenKeydown',\n    value: function removeSelectedTokenKeydown(e) {\n      // 8 = Backspace Key\n      // 46 = Delete Key\n      if (e.keyCode === 8 || e.keyCode === 46) {\n        this.removeSelectedToken();\n      }\n    }\n  }, {\n    key: 'removeSelectedToken',\n    value: function removeSelectedToken() {\n      gl.FilteredSearchVisualTokens.removeSelectedToken();\n      this.handleInputPlaceholder();\n      this.toggleClearSearchButton();\n      this.dropdownManager.updateCurrentDropdownOffset();\n    }\n  }, {\n    key: 'onClearSearch',\n    value: function onClearSearch(e) {\n      e.preventDefault();\n      this.clearSearch();\n    }\n  }, {\n    key: 'clearSearch',\n    value: function clearSearch() {\n      this.filteredSearchInput.value = '';\n\n      var removeElements = [];\n\n      [].forEach.call(this.tokensContainer.children, function (t) {\n        if (t.classList.contains('js-visual-token')) {\n          removeElements.push(t);\n        }\n      });\n\n      removeElements.forEach(function (el) {\n        el.parentElement.removeChild(el);\n      });\n\n      this.clearSearchButton.classList.add('hidden');\n      this.handleInputPlaceholder();\n\n      this.dropdownManager.resetDropdowns();\n\n      if (this.isHandledAsync) {\n        this.search();\n      }\n    }\n  }, {\n    key: 'handleInputVisualToken',\n    value: function handleInputVisualToken() {\n      var input = this.filteredSearchInput;\n\n      var _tokenizer$processTok = this.tokenizer.processTokens(input.value, this.filteredSearchTokenKeys.getKeys()),\n          tokens = _tokenizer$processTok.tokens,\n          searchToken = _tokenizer$processTok.searchToken;\n\n      var _gl$FilteredSearchVis2 = gl.FilteredSearchVisualTokens.getLastVisualTokenBeforeInput(),\n          isLastVisualTokenValid = _gl$FilteredSearchVis2.isLastVisualTokenValid;\n\n      if (isLastVisualTokenValid) {\n        tokens.forEach(function (t) {\n          input.value = input.value.replace(t.key + ':' + t.symbol + t.value, '');\n          gl.FilteredSearchVisualTokens.addFilterVisualToken(t.key, '' + t.symbol + t.value);\n        });\n\n        var fragments = searchToken.split(':');\n        if (fragments.length > 1) {\n          var inputValues = fragments[0].split(' ');\n          var tokenKey = inputValues.last();\n\n          if (inputValues.length > 1) {\n            inputValues.pop();\n            var searchTerms = inputValues.join(' ');\n\n            input.value = input.value.replace(searchTerms, '');\n            gl.FilteredSearchVisualTokens.addSearchVisualToken(searchTerms);\n          }\n\n          gl.FilteredSearchVisualTokens.addFilterVisualToken(tokenKey);\n          input.value = input.value.replace(tokenKey + ':', '');\n        }\n      } else {\n        // Keep listening to token until we determine that the user is done typing the token value\n        var valueCompletedRegex = /([~%@]{0,1}\".+\")|([~%@]{0,1}'.+')|^((?![~%@]')(?![~%@]\")(?!')(?!\")).*/g;\n\n        if (searchToken.match(valueCompletedRegex) && input.value[input.value.length - 1] === ' ') {\n          gl.FilteredSearchVisualTokens.addFilterVisualToken(searchToken);\n\n          // Trim the last space as seen in the if statement above\n          input.value = input.value.replace(searchToken, '').trim();\n        }\n      }\n    }\n  }, {\n    key: 'handleFormSubmit',\n    value: function handleFormSubmit(e) {\n      e.preventDefault();\n      this.search();\n    }\n  }, {\n    key: 'saveCurrentSearchQuery',\n    value: function saveCurrentSearchQuery() {\n      var _this2 = this;\n\n      // Don't save before we have fetched the already saved searches\n      this.fetchingRecentSearchesPromise.then(function () {\n        var searchQuery = gl.DropdownUtils.getSearchQuery();\n        if (searchQuery.length > 0) {\n          var resultantSearches = _this2.recentSearchesStore.addRecentSearch(searchQuery);\n          _this2.recentSearchesService.save(resultantSearches);\n        }\n      }).catch(function () {\n        // https://gitlab.com/gitlab-org/gitlab-ce/issues/30821\n      });\n    }\n  }, {\n    key: 'loadSearchParamsFromURL',\n    value: function loadSearchParamsFromURL() {\n      var _this3 = this;\n\n      var params = gl.utils.getUrlParamsArray();\n      var usernameParams = this.getUsernameParams();\n      var hasFilteredSearch = false;\n\n      params.forEach(function (p) {\n        var split = p.split('=');\n        var keyParam = decodeURIComponent(split[0]);\n        var value = split[1];\n\n        // Check if it matches edge conditions listed in this.filteredSearchTokenKeys\n        var condition = _this3.filteredSearchTokenKeys.searchByConditionUrl(p);\n\n        if (condition) {\n          hasFilteredSearch = true;\n          var canEdit = _this3.canEdit && _this3.canEdit(condition.tokenKey);\n          gl.FilteredSearchVisualTokens.addFilterVisualToken(condition.tokenKey, condition.value, canEdit);\n        } else {\n          // Sanitize value since URL converts spaces into +\n          // Replace before decode so that we know what was originally + versus the encoded +\n          var sanitizedValue = value ? decodeURIComponent(value.replace(/\\+/g, ' ')) : value;\n          var match = _this3.filteredSearchTokenKeys.searchByKeyParam(keyParam);\n\n          if (match) {\n            var indexOf = keyParam.indexOf('_');\n            var sanitizedKey = indexOf !== -1 ? keyParam.slice(0, keyParam.indexOf('_')) : keyParam;\n            var symbol = match.symbol;\n            var quotationsToUse = '';\n\n            if (sanitizedValue.indexOf(' ') !== -1) {\n              // Prefer \", but use ' if required\n              quotationsToUse = sanitizedValue.indexOf('\"') === -1 ? '\"' : '\\'';\n            }\n\n            hasFilteredSearch = true;\n            var _canEdit = _this3.canEdit && _this3.canEdit(sanitizedKey);\n            gl.FilteredSearchVisualTokens.addFilterVisualToken(sanitizedKey, '' + symbol + quotationsToUse + sanitizedValue + quotationsToUse, _canEdit);\n          } else if (!match && keyParam === 'assignee_id') {\n            var id = parseInt(value, 10);\n            if (usernameParams[id]) {\n              hasFilteredSearch = true;\n              var tokenName = 'assignee';\n              var _canEdit2 = _this3.canEdit && _this3.canEdit(tokenName);\n              gl.FilteredSearchVisualTokens.addFilterVisualToken(tokenName, '@' + usernameParams[id], _canEdit2);\n            }\n          } else if (!match && keyParam === 'author_id') {\n            var _id = parseInt(value, 10);\n            if (usernameParams[_id]) {\n              hasFilteredSearch = true;\n              var _tokenName = 'author';\n              var _canEdit3 = _this3.canEdit && _this3.canEdit(_tokenName);\n              gl.FilteredSearchVisualTokens.addFilterVisualToken(_tokenName, '@' + usernameParams[_id], _canEdit3);\n            }\n          } else if (!match && keyParam === 'search') {\n            hasFilteredSearch = true;\n            _this3.filteredSearchInput.value = sanitizedValue;\n          }\n        }\n      });\n\n      this.saveCurrentSearchQuery();\n\n      if (hasFilteredSearch) {\n        this.clearSearchButton.classList.remove('hidden');\n        this.handleInputPlaceholder();\n      }\n    }\n  }, {\n    key: 'searchState',\n    value: function searchState(e) {\n      e.preventDefault();\n      var target = e.currentTarget;\n      // remove focus outline after click\n      target.blur();\n\n      var state = target.dataset && target.dataset.state;\n\n      if (state) {\n        this.search(state);\n      }\n    }\n  }, {\n    key: 'search',\n    value: function search() {\n      var _this4 = this;\n\n      var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\n      var paths = [];\n      var searchQuery = gl.DropdownUtils.getSearchQuery();\n\n      this.saveCurrentSearchQuery();\n\n      var _tokenizer$processTok2 = this.tokenizer.processTokens(searchQuery, this.filteredSearchTokenKeys.getKeys()),\n          tokens = _tokenizer$processTok2.tokens,\n          searchToken = _tokenizer$processTok2.searchToken;\n\n      var currentState = state || gl.utils.getParameterByName('state') || 'opened';\n      paths.push('state=' + currentState);\n\n      tokens.forEach(function (token) {\n        var condition = _this4.filteredSearchTokenKeys.searchByConditionKeyValue(token.key, token.value.toLowerCase());\n\n        var _ref = _this4.filteredSearchTokenKeys.searchByKey(token.key) || {},\n            param = _ref.param;\n\n        var keyParam = param ? token.key + '_' + param : token.key;\n        var tokenPath = '';\n\n        if (condition) {\n          tokenPath = condition.url;\n        } else {\n          var tokenValue = token.value;\n\n          if (tokenValue[0] === '\\'' && tokenValue[tokenValue.length - 1] === '\\'' || tokenValue[0] === '\"' && tokenValue[tokenValue.length - 1] === '\"') {\n            tokenValue = tokenValue.slice(1, tokenValue.length - 1);\n          }\n\n          tokenPath = keyParam + '=' + encodeURIComponent(tokenValue);\n        }\n\n        paths.push(tokenPath);\n      });\n\n      if (searchToken) {\n        var sanitized = searchToken.split(' ').map(function (t) {\n          return encodeURIComponent(t);\n        }).join('+');\n        paths.push('search=' + sanitized);\n      }\n\n      var parameterizedUrl = '?scope=all&utf8=%E2%9C%93&' + paths.join('&');\n\n      if (this.updateObject) {\n        this.updateObject(parameterizedUrl);\n      } else {\n        gl.utils.visitUrl(parameterizedUrl);\n      }\n    }\n  }, {\n    key: 'getUsernameParams',\n    value: function getUsernameParams() {\n      var usernamesById = {};\n      try {\n        var attribute = this.filteredSearchInput.getAttribute('data-username-params');\n        JSON.parse(attribute).forEach(function (user) {\n          usernamesById[user.id] = user.username;\n        });\n      } catch (e) {\n        // do nothing\n      }\n      return usernamesById;\n    }\n  }, {\n    key: 'tokenChange',\n    value: function tokenChange() {\n      var dropdown = this.dropdownManager.mapping[this.dropdownManager.currentDropdown];\n\n      if (dropdown) {\n        var currentDropdownRef = dropdown.reference;\n\n        this.setDropdownWrapper();\n        currentDropdownRef.dispatchInputEvent();\n      }\n    }\n  }, {\n    key: 'onrecentSearchesItemSelected',\n    value: function onrecentSearchesItemSelected(text) {\n      this.clearSearch();\n      this.filteredSearchInput.value = text;\n      this.filteredSearchInput.dispatchEvent(new CustomEvent('input'));\n      this.search();\n    }\n\n    // eslint-disable-next-line class-methods-use-this\n\n  }, {\n    key: 'canEdit',\n    value: function canEdit() {\n      return true;\n    }\n  }]);\n\n  return FilteredSearchManager;\n}();\n\nwindow.gl = window.gl || {};\ngl.FilteredSearchManager = FilteredSearchManager;\n\n/***/ }),\n\n/***/ \"./filtered_search/filtered_search_token_keys.js\":\n/***/ (function(module, exports) {\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar tokenKeys = [{\n  key: 'author',\n  type: 'string',\n  param: 'username',\n  symbol: '@',\n  icon: 'pencil'\n}, {\n  key: 'assignee',\n  type: 'string',\n  param: 'username',\n  symbol: '@',\n  icon: 'user'\n}, {\n  key: 'milestone',\n  type: 'string',\n  param: 'title',\n  symbol: '%',\n  icon: 'clock-o'\n}, {\n  key: 'label',\n  type: 'array',\n  param: 'name[]',\n  symbol: '~',\n  icon: 'tag'\n}];\n\nvar alternativeTokenKeys = [{\n  key: 'label',\n  type: 'string',\n  param: 'name',\n  symbol: '~'\n}];\n\nvar tokenKeysWithAlternative = tokenKeys.concat(alternativeTokenKeys);\n\nvar conditions = [{\n  url: 'assignee_id=0',\n  tokenKey: 'assignee',\n  value: 'none'\n}, {\n  url: 'milestone_title=No+Milestone',\n  tokenKey: 'milestone',\n  value: 'none'\n}, {\n  url: 'milestone_title=%23upcoming',\n  tokenKey: 'milestone',\n  value: 'upcoming'\n}, {\n  url: 'milestone_title=%23started',\n  tokenKey: 'milestone',\n  value: 'started'\n}, {\n  url: 'label_name[]=No+Label',\n  tokenKey: 'label',\n  value: 'none'\n}];\n\nvar FilteredSearchTokenKeys = function () {\n  function FilteredSearchTokenKeys() {\n    _classCallCheck(this, FilteredSearchTokenKeys);\n  }\n\n  _createClass(FilteredSearchTokenKeys, null, [{\n    key: 'get',\n    value: function get() {\n      return tokenKeys;\n    }\n  }, {\n    key: 'getKeys',\n    value: function getKeys() {\n      return tokenKeys.map(function (i) {\n        return i.key;\n      });\n    }\n  }, {\n    key: 'getAlternatives',\n    value: function getAlternatives() {\n      return alternativeTokenKeys;\n    }\n  }, {\n    key: 'getConditions',\n    value: function getConditions() {\n      return conditions;\n    }\n  }, {\n    key: 'searchByKey',\n    value: function searchByKey(key) {\n      return tokenKeys.find(function (tokenKey) {\n        return tokenKey.key === key;\n      }) || null;\n    }\n  }, {\n    key: 'searchBySymbol',\n    value: function searchBySymbol(symbol) {\n      return tokenKeys.find(function (tokenKey) {\n        return tokenKey.symbol === symbol;\n      }) || null;\n    }\n  }, {\n    key: 'searchByKeyParam',\n    value: function searchByKeyParam(keyParam) {\n      return tokenKeysWithAlternative.find(function (tokenKey) {\n        var tokenKeyParam = tokenKey.key;\n\n        if (tokenKey.param) {\n          tokenKeyParam += '_' + tokenKey.param;\n        }\n\n        return keyParam === tokenKeyParam;\n      }) || null;\n    }\n  }, {\n    key: 'searchByConditionUrl',\n    value: function searchByConditionUrl(url) {\n      return conditions.find(function (condition) {\n        return condition.url === url;\n      }) || null;\n    }\n  }, {\n    key: 'searchByConditionKeyValue',\n    value: function searchByConditionKeyValue(key, value) {\n      return conditions.find(function (condition) {\n        return condition.tokenKey === key && condition.value === value;\n      }) || null;\n    }\n  }]);\n\n  return FilteredSearchTokenKeys;\n}();\n\nwindow.gl = window.gl || {};\ngl.FilteredSearchTokenKeys = FilteredSearchTokenKeys;\n\n/***/ }),\n\n/***/ \"./filtered_search/filtered_search_tokenizer.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__filtered_search_token_keys__ = __webpack_require__(\"./filtered_search/filtered_search_token_keys.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__filtered_search_token_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__filtered_search_token_keys__);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\nvar FilteredSearchTokenizer = function () {\n  function FilteredSearchTokenizer() {\n    _classCallCheck(this, FilteredSearchTokenizer);\n  }\n\n  _createClass(FilteredSearchTokenizer, null, [{\n    key: 'processTokens',\n    value: function processTokens(input, allowedKeys) {\n      // Regex extracts `(token):(symbol)(value)`\n      // Values that start with a double quote must end in a double quote (same for single)\n      var tokenRegex = new RegExp('(' + allowedKeys.join('|') + '):([~%@]?)(?:(\\'[^\\']*\\'{0,1})|(\"[^\"]*\"{0,1})|(\\\\S+))', 'g');\n      var tokens = [];\n      var tokenIndexes = []; // stores key+value for simple search\n      var lastToken = null;\n      var searchToken = input.replace(tokenRegex, function (match, key, symbol, v1, v2, v3) {\n        var tokenValue = v1 || v2 || v3;\n        var tokenSymbol = symbol;\n        var tokenIndex = '';\n\n        if (tokenValue === '~' || tokenValue === '%' || tokenValue === '@') {\n          tokenSymbol = tokenValue;\n          tokenValue = '';\n        }\n\n        tokenIndex = key + ':' + tokenValue;\n\n        // Prevent adding duplicates\n        if (tokenIndexes.indexOf(tokenIndex) === -1) {\n          tokenIndexes.push(tokenIndex);\n\n          tokens.push({\n            key: key,\n            value: tokenValue || '',\n            symbol: tokenSymbol || ''\n          });\n        }\n\n        return '';\n      }).replace(/\\s{2,}/g, ' ').trim() || '';\n\n      if (tokens.length > 0) {\n        var last = tokens[tokens.length - 1];\n        var lastString = last.key + ':' + last.symbol + last.value;\n        lastToken = input.lastIndexOf(lastString) === input.length - lastString.length ? last : searchToken;\n      } else {\n        lastToken = searchToken;\n      }\n\n      return {\n        tokens: tokens,\n        lastToken: lastToken,\n        searchToken: searchToken\n      };\n    }\n  }]);\n\n  return FilteredSearchTokenizer;\n}();\n\nwindow.gl = window.gl || {};\ngl.FilteredSearchTokenizer = FilteredSearchTokenizer;\n\n/***/ }),\n\n/***/ \"./filtered_search/filtered_search_visual_tokens.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__lib_utils_ajax_cache__ = __webpack_require__(\"./lib/utils/ajax_cache.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__flash__ = __webpack_require__(\"./flash.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__flash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__flash__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__container__ = __webpack_require__(\"./filtered_search/container.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__lib_utils_users_cache__ = __webpack_require__(\"./lib/utils/users_cache.js\");\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n /* global Flash */\n\n\n\nvar FilteredSearchVisualTokens = function () {\n  function FilteredSearchVisualTokens() {\n    _classCallCheck(this, FilteredSearchVisualTokens);\n  }\n\n  _createClass(FilteredSearchVisualTokens, null, [{\n    key: 'getLastVisualTokenBeforeInput',\n    value: function getLastVisualTokenBeforeInput() {\n      var inputLi = __WEBPACK_IMPORTED_MODULE_2__container__[\"a\" /* default */].container.querySelector('.input-token');\n      var lastVisualToken = inputLi && inputLi.previousElementSibling;\n\n      return {\n        lastVisualToken: lastVisualToken,\n        isLastVisualTokenValid: lastVisualToken === null || lastVisualToken.className.indexOf('filtered-search-term') !== -1 || lastVisualToken && lastVisualToken.querySelector('.value') !== null\n      };\n    }\n  }, {\n    key: 'unselectTokens',\n    value: function unselectTokens() {\n      var otherTokens = __WEBPACK_IMPORTED_MODULE_2__container__[\"a\" /* default */].container.querySelectorAll('.js-visual-token .selectable.selected');\n      [].forEach.call(otherTokens, function (t) {\n        return t.classList.remove('selected');\n      });\n    }\n  }, {\n    key: 'selectToken',\n    value: function selectToken(tokenButton) {\n      var forceSelection = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      var selected = tokenButton.classList.contains('selected');\n      FilteredSearchVisualTokens.unselectTokens();\n\n      if (!selected || forceSelection) {\n        tokenButton.classList.add('selected');\n      }\n    }\n  }, {\n    key: 'removeSelectedToken',\n    value: function removeSelectedToken() {\n      var selected = __WEBPACK_IMPORTED_MODULE_2__container__[\"a\" /* default */].container.querySelector('.js-visual-token .selected');\n\n      if (selected) {\n        var li = selected.closest('.js-visual-token');\n        li.parentElement.removeChild(li);\n      }\n    }\n  }, {\n    key: 'createVisualTokenElementHTML',\n    value: function createVisualTokenElementHTML() {\n      var canEdit = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n      var removeTokenMarkup = '';\n      if (canEdit) {\n        removeTokenMarkup = '\\n        <div class=\"remove-token\" role=\"button\">\\n          <i class=\"fa fa-close\"></i>\\n        </div>\\n      ';\n      }\n\n      return '\\n      <div class=\"selectable\" role=\"button\">\\n        <div class=\"name\"></div>\\n        <div class=\"value-container\">\\n          <div class=\"value\"></div>\\n          ' + removeTokenMarkup + '\\n        </div>\\n      </div>\\n    ';\n    }\n  }, {\n    key: 'updateLabelTokenColor',\n    value: function updateLabelTokenColor(tokenValueContainer, tokenValue) {\n      var filteredSearchInput = __WEBPACK_IMPORTED_MODULE_2__container__[\"a\" /* default */].container.querySelector('.filtered-search');\n      var baseEndpoint = filteredSearchInput.dataset.baseEndpoint;\n      var labelsEndpoint = baseEndpoint + '/labels.json';\n\n      return __WEBPACK_IMPORTED_MODULE_0__lib_utils_ajax_cache__[\"a\" /* default */].retrieve(labelsEndpoint).then(function (labels) {\n        var matchingLabel = (labels || []).find(function (label) {\n          return '~' + gl.DropdownUtils.getEscapedText(label.title) === tokenValue;\n        });\n\n        if (!matchingLabel) {\n          return;\n        }\n\n        var tokenValueStyle = tokenValueContainer.style;\n        tokenValueStyle.backgroundColor = matchingLabel.color;\n        tokenValueStyle.color = matchingLabel.text_color;\n\n        if (matchingLabel.text_color === '#FFFFFF') {\n          var removeToken = tokenValueContainer.querySelector('.remove-token');\n          removeToken.classList.add('inverted');\n        }\n      }).catch(function () {\n        return new Flash('An error occurred while fetching label colors.');\n      });\n    }\n  }, {\n    key: 'updateUserTokenAppearance',\n    value: function updateUserTokenAppearance(tokenValueContainer, tokenValueElement, tokenValue) {\n      if (tokenValue === 'none') {\n        return Promise.resolve();\n      }\n\n      var username = tokenValue.replace(/^@/, '');\n      return __WEBPACK_IMPORTED_MODULE_3__lib_utils_users_cache__[\"a\" /* default */].retrieve(username).then(function (user) {\n        if (!user) {\n          return;\n        }\n\n        /* eslint-disable no-param-reassign */\n        tokenValueContainer.dataset.originalValue = tokenValue;\n        tokenValueElement.innerHTML = '\\n          <img class=\"avatar s20\" src=\"' + user.avatar_url + '\" alt=\"' + user.name + '\\'s avatar\">\\n          ' + user.name + '\\n        ';\n        /* eslint-enable no-param-reassign */\n      })\n      // ignore error and leave username in the search bar\n      .catch(function () {});\n    }\n  }, {\n    key: 'renderVisualTokenValue',\n    value: function renderVisualTokenValue(parentElement, tokenName, tokenValue) {\n      var tokenValueContainer = parentElement.querySelector('.value-container');\n      var tokenValueElement = tokenValueContainer.querySelector('.value');\n      tokenValueElement.innerText = tokenValue;\n\n      var tokenType = tokenName.toLowerCase();\n      if (tokenType === 'label') {\n        FilteredSearchVisualTokens.updateLabelTokenColor(tokenValueContainer, tokenValue);\n      } else if (tokenType === 'author' || tokenType === 'assignee') {\n        FilteredSearchVisualTokens.updateUserTokenAppearance(tokenValueContainer, tokenValueElement, tokenValue);\n      }\n    }\n  }, {\n    key: 'addVisualTokenElement',\n    value: function addVisualTokenElement(name, value, isSearchTerm, canEdit) {\n      var li = document.createElement('li');\n      li.classList.add('js-visual-token');\n      li.classList.add(isSearchTerm ? 'filtered-search-term' : 'filtered-search-token');\n\n      if (value) {\n        li.innerHTML = FilteredSearchVisualTokens.createVisualTokenElementHTML(canEdit);\n        FilteredSearchVisualTokens.renderVisualTokenValue(li, name, value);\n      } else {\n        li.innerHTML = '<div class=\"name\"></div>';\n      }\n      li.querySelector('.name').innerText = name;\n\n      var tokensContainer = __WEBPACK_IMPORTED_MODULE_2__container__[\"a\" /* default */].container.querySelector('.tokens-container');\n      var input = __WEBPACK_IMPORTED_MODULE_2__container__[\"a\" /* default */].container.querySelector('.filtered-search');\n      tokensContainer.insertBefore(li, input.parentElement);\n    }\n  }, {\n    key: 'addValueToPreviousVisualTokenElement',\n    value: function addValueToPreviousVisualTokenElement(value) {\n      var _FilteredSearchVisual = FilteredSearchVisualTokens.getLastVisualTokenBeforeInput(),\n          lastVisualToken = _FilteredSearchVisual.lastVisualToken,\n          isLastVisualTokenValid = _FilteredSearchVisual.isLastVisualTokenValid;\n\n      if (!isLastVisualTokenValid && lastVisualToken.classList.contains('filtered-search-token')) {\n        var name = FilteredSearchVisualTokens.getLastTokenPartial();\n        lastVisualToken.innerHTML = FilteredSearchVisualTokens.createVisualTokenElementHTML();\n        lastVisualToken.querySelector('.name').innerText = name;\n        FilteredSearchVisualTokens.renderVisualTokenValue(lastVisualToken, name, value);\n      }\n    }\n  }, {\n    key: 'addFilterVisualToken',\n    value: function addFilterVisualToken(tokenName, tokenValue, canEdit) {\n      var _FilteredSearchVisual2 = FilteredSearchVisualTokens.getLastVisualTokenBeforeInput(),\n          lastVisualToken = _FilteredSearchVisual2.lastVisualToken,\n          isLastVisualTokenValid = _FilteredSearchVisual2.isLastVisualTokenValid;\n\n      var addVisualTokenElement = FilteredSearchVisualTokens.addVisualTokenElement;\n\n      if (isLastVisualTokenValid) {\n        addVisualTokenElement(tokenName, tokenValue, false, canEdit);\n      } else {\n        var previousTokenName = lastVisualToken.querySelector('.name').innerText;\n        var tokensContainer = __WEBPACK_IMPORTED_MODULE_2__container__[\"a\" /* default */].container.querySelector('.tokens-container');\n        tokensContainer.removeChild(lastVisualToken);\n\n        var value = tokenValue || tokenName;\n        addVisualTokenElement(previousTokenName, value, false, canEdit);\n      }\n    }\n  }, {\n    key: 'addSearchVisualToken',\n    value: function addSearchVisualToken(searchTerm) {\n      var _FilteredSearchVisual3 = FilteredSearchVisualTokens.getLastVisualTokenBeforeInput(),\n          lastVisualToken = _FilteredSearchVisual3.lastVisualToken;\n\n      if (lastVisualToken && lastVisualToken.classList.contains('filtered-search-term')) {\n        lastVisualToken.querySelector('.name').innerText += ' ' + searchTerm;\n      } else {\n        FilteredSearchVisualTokens.addVisualTokenElement(searchTerm, null, true);\n      }\n    }\n  }, {\n    key: 'getLastTokenPartial',\n    value: function getLastTokenPartial() {\n      var _FilteredSearchVisual4 = FilteredSearchVisualTokens.getLastVisualTokenBeforeInput(),\n          lastVisualToken = _FilteredSearchVisual4.lastVisualToken;\n\n      if (!lastVisualToken) return '';\n\n      var valueContainer = lastVisualToken.querySelector('.value-container');\n      var originalValue = valueContainer && valueContainer.dataset.originalValue;\n      if (originalValue) {\n        return originalValue;\n      }\n\n      var value = lastVisualToken.querySelector('.value');\n      var name = lastVisualToken.querySelector('.name');\n\n      var valueText = value ? value.innerText : '';\n      var nameText = name ? name.innerText : '';\n\n      return valueText || nameText;\n    }\n  }, {\n    key: 'removeLastTokenPartial',\n    value: function removeLastTokenPartial() {\n      var _FilteredSearchVisual5 = FilteredSearchVisualTokens.getLastVisualTokenBeforeInput(),\n          lastVisualToken = _FilteredSearchVisual5.lastVisualToken;\n\n      if (lastVisualToken) {\n        var value = lastVisualToken.querySelector('.value');\n\n        if (value) {\n          var button = lastVisualToken.querySelector('.selectable');\n          var valueContainer = lastVisualToken.querySelector('.value-container');\n          button.removeChild(valueContainer);\n          lastVisualToken.innerHTML = button.innerHTML;\n        } else {\n          lastVisualToken.closest('.tokens-container').removeChild(lastVisualToken);\n        }\n      }\n    }\n  }, {\n    key: 'tokenizeInput',\n    value: function tokenizeInput() {\n      var input = __WEBPACK_IMPORTED_MODULE_2__container__[\"a\" /* default */].container.querySelector('.filtered-search');\n\n      var _gl$FilteredSearchVis = gl.FilteredSearchVisualTokens.getLastVisualTokenBeforeInput(),\n          isLastVisualTokenValid = _gl$FilteredSearchVis.isLastVisualTokenValid;\n\n      if (input.value) {\n        if (isLastVisualTokenValid) {\n          gl.FilteredSearchVisualTokens.addSearchVisualToken(input.value);\n        } else {\n          FilteredSearchVisualTokens.addValueToPreviousVisualTokenElement(input.value);\n        }\n\n        input.value = '';\n      }\n    }\n  }, {\n    key: 'editToken',\n    value: function editToken(token) {\n      var input = __WEBPACK_IMPORTED_MODULE_2__container__[\"a\" /* default */].container.querySelector('.filtered-search');\n\n      FilteredSearchVisualTokens.tokenizeInput();\n\n      // Replace token with input field\n      var tokenContainer = token.parentElement;\n      var inputLi = input.parentElement;\n      tokenContainer.replaceChild(inputLi, token);\n\n      var nameElement = token.querySelector('.name');\n      var value = void 0;\n\n      if (token.classList.contains('filtered-search-token')) {\n        FilteredSearchVisualTokens.addFilterVisualToken(nameElement.innerText);\n\n        var valueContainerElement = token.querySelector('.value-container');\n        value = valueContainerElement.dataset.originalValue;\n\n        if (!value) {\n          var valueElement = valueContainerElement.querySelector('.value');\n          value = valueElement.innerText;\n        }\n      }\n\n      // token is a search term\n      if (!value) {\n        value = nameElement.innerText;\n      }\n\n      input.value = value;\n\n      // Opens dropdown\n      var inputEvent = new Event('input');\n      input.dispatchEvent(inputEvent);\n\n      // Adds cursor to input\n      input.focus();\n    }\n  }, {\n    key: 'moveInputToTheRight',\n    value: function moveInputToTheRight() {\n      var input = __WEBPACK_IMPORTED_MODULE_2__container__[\"a\" /* default */].container.querySelector('.filtered-search');\n\n      if (!input) return;\n\n      var inputLi = input.parentElement;\n      var tokenContainer = __WEBPACK_IMPORTED_MODULE_2__container__[\"a\" /* default */].container.querySelector('.tokens-container');\n\n      FilteredSearchVisualTokens.tokenizeInput();\n\n      if (!tokenContainer.lastElementChild.isEqualNode(inputLi)) {\n        var _gl$FilteredSearchVis2 = gl.FilteredSearchVisualTokens.getLastVisualTokenBeforeInput(),\n            isLastVisualTokenValid = _gl$FilteredSearchVis2.isLastVisualTokenValid;\n\n        if (!isLastVisualTokenValid) {\n          var lastPartial = gl.FilteredSearchVisualTokens.getLastTokenPartial();\n          gl.FilteredSearchVisualTokens.removeLastTokenPartial();\n          gl.FilteredSearchVisualTokens.addSearchVisualToken(lastPartial);\n        }\n\n        tokenContainer.removeChild(inputLi);\n        tokenContainer.appendChild(inputLi);\n      }\n    }\n  }]);\n\n  return FilteredSearchVisualTokens;\n}();\n\nwindow.gl = window.gl || {};\ngl.FilteredSearchVisualTokens = FilteredSearchVisualTokens;\n\n/***/ }),\n\n/***/ \"./filtered_search/recent_searches_root.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_vue__ = __webpack_require__(\"../../../node_modules/vue/dist/vue.esm.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__components_recent_searches_dropdown_content__ = __webpack_require__(\"./filtered_search/components/recent_searches_dropdown_content.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__event_hub__ = __webpack_require__(\"./filtered_search/event_hub.js\");\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\n\n\nvar RecentSearchesRoot = function () {\n  function RecentSearchesRoot(recentSearchesStore, recentSearchesService, wrapperElement) {\n    _classCallCheck(this, RecentSearchesRoot);\n\n    this.store = recentSearchesStore;\n    this.service = recentSearchesService;\n    this.wrapperElement = wrapperElement;\n  }\n\n  _createClass(RecentSearchesRoot, [{\n    key: 'init',\n    value: function init() {\n      this.bindEvents();\n      this.render();\n    }\n  }, {\n    key: 'bindEvents',\n    value: function bindEvents() {\n      this.onRequestClearRecentSearchesWrapper = this.onRequestClearRecentSearches.bind(this);\n\n      __WEBPACK_IMPORTED_MODULE_2__event_hub__[\"a\" /* default */].$on('requestClearRecentSearches', this.onRequestClearRecentSearchesWrapper);\n    }\n  }, {\n    key: 'unbindEvents',\n    value: function unbindEvents() {\n      __WEBPACK_IMPORTED_MODULE_2__event_hub__[\"a\" /* default */].$off('requestClearRecentSearches', this.onRequestClearRecentSearchesWrapper);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var state = this.store.state;\n      this.vm = new __WEBPACK_IMPORTED_MODULE_0_vue__[\"default\"]({\n        el: this.wrapperElement,\n        data: function data() {\n          return state;\n        },\n\n        template: '\\n        <recent-searches-dropdown-content\\n          :items=\"recentSearches\"\\n          :is-local-storage-available=\"isLocalStorageAvailable\"\\n          :allowed-keys=\"allowedKeys\"\\n          />\\n      ',\n        components: {\n          'recent-searches-dropdown-content': __WEBPACK_IMPORTED_MODULE_1__components_recent_searches_dropdown_content__[\"a\" /* default */]\n        }\n      });\n    }\n  }, {\n    key: 'onRequestClearRecentSearches',\n    value: function onRequestClearRecentSearches() {\n      var resultantSearches = this.store.setRecentSearches([]);\n      this.service.save(resultantSearches);\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {\n      this.unbindEvents();\n      if (this.vm) {\n        this.vm.$destroy();\n      }\n    }\n  }]);\n\n  return RecentSearchesRoot;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (RecentSearchesRoot);\n\n/***/ }),\n\n/***/ \"./filtered_search/services/recent_searches_service.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__recent_searches_service_error__ = __webpack_require__(\"./filtered_search/services/recent_searches_service_error.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__lib_utils_accessor__ = __webpack_require__(\"./lib/utils/accessor.js\");\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\n\nvar RecentSearchesService = function () {\n  function RecentSearchesService() {\n    var localStorageKey = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'issuable-recent-searches';\n\n    _classCallCheck(this, RecentSearchesService);\n\n    this.localStorageKey = localStorageKey;\n  }\n\n  _createClass(RecentSearchesService, [{\n    key: 'fetch',\n    value: function fetch() {\n      if (!RecentSearchesService.isAvailable()) {\n        var error = new __WEBPACK_IMPORTED_MODULE_0__recent_searches_service_error__[\"a\" /* default */]();\n        return Promise.reject(error);\n      }\n\n      var input = window.localStorage.getItem(this.localStorageKey);\n\n      var searches = [];\n      if (input && input.length > 0) {\n        try {\n          searches = JSON.parse(input);\n        } catch (err) {\n          return Promise.reject(err);\n        }\n      }\n\n      return Promise.resolve(searches);\n    }\n  }, {\n    key: 'save',\n    value: function save() {\n      var searches = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n      if (!RecentSearchesService.isAvailable()) return;\n\n      window.localStorage.setItem(this.localStorageKey, JSON.stringify(searches));\n    }\n  }], [{\n    key: 'isAvailable',\n    value: function isAvailable() {\n      return __WEBPACK_IMPORTED_MODULE_1__lib_utils_accessor__[\"a\" /* default */].isLocalStorageAccessSafe();\n    }\n  }]);\n\n  return RecentSearchesService;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (RecentSearchesService);\n\n/***/ }),\n\n/***/ \"./filtered_search/services/recent_searches_service_error.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar RecentSearchesServiceError = function RecentSearchesServiceError(message) {\n  _classCallCheck(this, RecentSearchesServiceError);\n\n  this.name = 'RecentSearchesServiceError';\n  this.message = message || 'Recent Searches Service is unavailable';\n};\n\n// Can't use `extends` for builtin prototypes and get true inheritance yet\n\n\nRecentSearchesServiceError.prototype = Error.prototype;\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (RecentSearchesServiceError);\n\n/***/ }),\n\n/***/ \"./filtered_search/stores/recent_searches_store.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_underscore__ = __webpack_require__(\"../../../node_modules/underscore/underscore.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_underscore___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_underscore__);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\nvar RecentSearchesStore = function () {\n  function RecentSearchesStore() {\n    var initialState = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var allowedKeys = arguments[1];\n\n    _classCallCheck(this, RecentSearchesStore);\n\n    this.state = Object.assign({\n      isLocalStorageAvailable: true,\n      recentSearches: [],\n      allowedKeys: allowedKeys\n    }, initialState);\n  }\n\n  _createClass(RecentSearchesStore, [{\n    key: 'addRecentSearch',\n    value: function addRecentSearch(newSearch) {\n      this.setRecentSearches([newSearch].concat(this.state.recentSearches));\n\n      return this.state.recentSearches;\n    }\n  }, {\n    key: 'setRecentSearches',\n    value: function setRecentSearches() {\n      var searches = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n      var trimmedSearches = searches.map(function (search) {\n        return search.trim();\n      });\n      this.state.recentSearches = __WEBPACK_IMPORTED_MODULE_0_underscore___default.a.uniq(trimmedSearches).slice(0, 5);\n      return this.state.recentSearches;\n    }\n  }]);\n\n  return RecentSearchesStore;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (RecentSearchesStore);\n\n/***/ }),\n\n/***/ \"./lib/utils/users_cache.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__api__ = __webpack_require__(\"./api.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__cache__ = __webpack_require__(\"./lib/utils/cache.js\");\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\nvar UsersCache = function (_Cache) {\n  _inherits(UsersCache, _Cache);\n\n  function UsersCache() {\n    _classCallCheck(this, UsersCache);\n\n    return _possibleConstructorReturn(this, (UsersCache.__proto__ || Object.getPrototypeOf(UsersCache)).apply(this, arguments));\n  }\n\n  _createClass(UsersCache, [{\n    key: 'retrieve',\n    value: function retrieve(username) {\n      var _this2 = this;\n\n      if (this.hasData(username)) {\n        return Promise.resolve(this.get(username));\n      }\n\n      return __WEBPACK_IMPORTED_MODULE_0__api__[\"a\" /* default */].users('', { username: username }).then(function (users) {\n        if (!users.length) {\n          throw new Error('User \"' + username + '\" could not be found!');\n        }\n\n        if (users.length > 1) {\n          throw new Error('Expected username \"' + username + '\" to be unique!');\n        }\n\n        var user = users[0];\n        _this2.internalStorage[username] = user;\n        return user;\n      });\n      // missing catch is intentional, error handling depends on use case\n    }\n  }]);\n\n  return UsersCache;\n}(__WEBPACK_IMPORTED_MODULE_1__cache__[\"a\" /* default */]);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (new UsersCache());\n\n/***/ })\n\n},[\"./filtered_search/filtered_search_bundle.js\"]);\n\n\n// WEBPACK FOOTER //\n// filtered_search.d55dc50a619b68060e16.bundle.js","/* eslint-disable */\n\nimport AjaxCache from '~/lib/utils/ajax_cache';\n\nconst Ajax = {\n  _loadData: function _loadData(data, config, self) {\n    if (config.loadingTemplate) {\n      var dataLoadingTemplate = self.hook.list.list.querySelector('[data-loading-template]');\n      if (dataLoadingTemplate) dataLoadingTemplate.outerHTML = self.listTemplate;\n    }\n\n    if (!self.destroyed) self.hook.list[config.method].call(self.hook.list, data);\n  },\n  init: function init(hook) {\n    var self = this;\n    self.destroyed = false;\n    var config = hook.config.Ajax;\n    this.hook = hook;\n    if (!config || !config.endpoint || !config.method) {\n      return;\n    }\n    if (config.method !== 'setData' && config.method !== 'addData') {\n      return;\n    }\n    if (config.loadingTemplate) {\n      var dynamicList = hook.list.list.querySelector('[data-dynamic]');\n      var loadingTemplate = document.createElement('div');\n      loadingTemplate.innerHTML = config.loadingTemplate;\n      loadingTemplate.setAttribute('data-loading-template', '');\n      this.listTemplate = dynamicList.outerHTML;\n      dynamicList.outerHTML = loadingTemplate.outerHTML;\n    }\n\n    AjaxCache.retrieve(config.endpoint)\n      .then((data) => self._loadData(data, config, self))\n      .catch(config.onError);\n  },\n  destroy: function() {\n    this.destroyed = true;\n  }\n};\n\nexport default Ajax;\n\n\n\n// WEBPACK FOOTER //\n// ./droplab/plugins/ajax.js","/* eslint-disable */\nimport AjaxCache from '../../lib/utils/ajax_cache';\n\nconst AjaxFilter = {\n  init: function(hook) {\n    this.destroyed = false;\n    this.hook = hook;\n    this.notLoading();\n\n    this.eventWrapper = {};\n    this.eventWrapper.debounceTrigger = this.debounceTrigger.bind(this);\n    this.hook.trigger.addEventListener('keydown.dl', this.eventWrapper.debounceTrigger);\n    this.hook.trigger.addEventListener('focus', this.eventWrapper.debounceTrigger);\n\n    this.trigger(true);\n  },\n\n  notLoading: function notLoading() {\n    this.loading = false;\n  },\n\n  debounceTrigger: function debounceTrigger(e) {\n    var NON_CHARACTER_KEYS = [16, 17, 18, 20, 37, 38, 39, 40, 91, 93];\n    var invalidKeyPressed = NON_CHARACTER_KEYS.indexOf(e.detail.which || e.detail.keyCode) > -1;\n    var focusEvent = e.type === 'focus';\n    if (invalidKeyPressed || this.loading) {\n      return;\n    }\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n    }\n    this.timeout = setTimeout(this.trigger.bind(this, focusEvent), 200);\n  },\n\n  trigger: function trigger(getEntireList) {\n    var config = this.hook.config.AjaxFilter;\n    var searchValue = this.trigger.value;\n    if (!config || !config.endpoint || !config.searchKey) {\n      return;\n    }\n    if (config.searchValueFunction) {\n      searchValue = config.searchValueFunction();\n    }\n    if (config.loadingTemplate && this.hook.list.data === undefined ||\n      this.hook.list.data.length === 0) {\n      var dynamicList = this.hook.list.list.querySelector('[data-dynamic]');\n      var loadingTemplate = document.createElement('div');\n      loadingTemplate.innerHTML = config.loadingTemplate;\n      loadingTemplate.setAttribute('data-loading-template', true);\n      this.listTemplate = dynamicList.outerHTML;\n      dynamicList.outerHTML = loadingTemplate.outerHTML;\n    }\n    if (getEntireList) {\n      searchValue = '';\n    }\n    if (config.searchKey === searchValue) {\n      return this.list.show();\n    }\n    this.loading = true;\n    var params = config.params || {};\n    params[config.searchKey] = searchValue;\n    var url = config.endpoint + this.buildParams(params);\n    return AjaxCache.retrieve(url)\n      .then((data) => {\n        this._loadData(data, config);\n        if (config.onLoadingFinished) {\n          config.onLoadingFinished(data);\n        }\n      })\n      .catch(config.onError);\n  },\n\n  _loadData(data, config) {\n    const list = this.hook.list;\n    if (config.loadingTemplate && list.data === undefined ||\n      list.data.length === 0) {\n      const dataLoadingTemplate = list.list.querySelector('[data-loading-template]');\n      if (dataLoadingTemplate) {\n        dataLoadingTemplate.outerHTML = this.listTemplate;\n      }\n    }\n    if (!this.destroyed) {\n      var hookListChildren = list.list.children;\n      var onlyDynamicList = hookListChildren.length === 1 && hookListChildren[0].hasAttribute('data-dynamic');\n      if (onlyDynamicList && data.length === 0) {\n        list.hide();\n      }\n      list.setData.call(list, data);\n    }\n    this.notLoading();\n    list.currentIndex = 0;\n  },\n\n  buildParams: function(params) {\n    if (!params) return '';\n    var paramsArray = Object.keys(params).map(function(param) {\n      return param + '=' + (params[param] || '');\n    });\n    return '?' + paramsArray.join('&');\n  },\n\n  destroy: function destroy() {\n    if (this.timeout)clearTimeout(this.timeout);\n    this.destroyed = true;\n\n    this.hook.trigger.removeEventListener('keydown.dl', this.eventWrapper.debounceTrigger);\n    this.hook.trigger.removeEventListener('focus', this.eventWrapper.debounceTrigger);\n  }\n};\n\nexport default AjaxFilter;\n\n\n\n// WEBPACK FOOTER //\n// ./droplab/plugins/ajax_filter.js","/* eslint-disable */\n\nconst Filter = {\n  keydown: function(e){\n    if (this.destroyed) return;\n\n    var hiddenCount = 0;\n    var dataHiddenCount = 0;\n\n    var list = e.detail.hook.list;\n    var data = list.data;\n    var value = e.detail.hook.trigger.value.toLowerCase();\n    var config = e.detail.hook.config.Filter;\n    var matches = [];\n    var filterFunction;\n    // will only work on dynamically set data\n    if(!data){\n      return;\n    }\n\n    if (config && config.filterFunction && typeof config.filterFunction === 'function') {\n      filterFunction = config.filterFunction;\n    } else {\n      filterFunction = function(o){\n        // cheap string search\n        o.droplab_hidden = o[config.template].toLowerCase().indexOf(value) === -1;\n        return o;\n      };\n    }\n\n    dataHiddenCount = data.filter(function(o) {\n      return !o.droplab_hidden;\n    }).length;\n\n    matches = data.map(function(o) {\n      return filterFunction(o, value);\n    });\n\n    hiddenCount = matches.filter(function(o) {\n      return !o.droplab_hidden;\n    }).length;\n\n    if (dataHiddenCount !== hiddenCount) {\n      list.setData(matches);\n      list.currentIndex = 0;\n    }\n  },\n\n  debounceKeydown: function debounceKeydown(e) {\n    if ([\n      13, // enter\n      16, // shift\n      17, // ctrl\n      18, // alt\n      20, // caps lock\n      37, // left arrow\n      38, // up arrow\n      39, // right arrow\n      40, // down arrow\n      91, // left window\n      92, // right window\n      93, // select\n    ].indexOf(e.detail.which || e.detail.keyCode) > -1) return;\n\n    if (this.timeout) clearTimeout(this.timeout);\n    this.timeout = setTimeout(this.keydown.bind(this, e), 200);\n  },\n\n  init: function init(hook) {\n    var config = hook.config.Filter;\n\n    if (!config || !config.template) return;\n\n    this.hook = hook;\n    this.destroyed = false;\n\n    this.eventWrapper = {};\n    this.eventWrapper.debounceKeydown = this.debounceKeydown.bind(this);\n\n    this.hook.trigger.addEventListener('keydown.dl', this.eventWrapper.debounceKeydown);\n    this.hook.trigger.addEventListener('mousedown.dl', this.eventWrapper.debounceKeydown);\n\n    this.debounceKeydown({ detail: { hook: this.hook } });\n  },\n\n  destroy: function destroy() {\n    if (this.timeout) clearTimeout(this.timeout);\n    this.destroyed = true;\n\n    this.hook.trigger.removeEventListener('keydown.dl', this.eventWrapper.debounceKeydown);\n    this.hook.trigger.removeEventListener('mousedown.dl', this.eventWrapper.debounceKeydown);\n  }\n};\n\nexport default Filter;\n\n\n\n// WEBPACK FOOTER //\n// ./droplab/plugins/filter.js","import eventHub from '../event_hub';\n\nexport default {\n  name: 'RecentSearchesDropdownContent',\n\n  props: {\n    items: {\n      type: Array,\n      required: true,\n    },\n    isLocalStorageAvailable: {\n      type: Boolean,\n      required: false,\n      default: true,\n    },\n    allowedKeys: {\n      type: Array,\n      required: true,\n    },\n  },\n\n  computed: {\n    processedItems() {\n      return this.items.map((item) => {\n        const { tokens, searchToken }\n          = gl.FilteredSearchTokenizer.processTokens(item, this.allowedKeys);\n\n        const resultantTokens = tokens.map(token => ({\n          prefix: `${token.key}:`,\n          suffix: `${token.symbol}${token.value}`,\n        }));\n\n        return {\n          text: item,\n          tokens: resultantTokens,\n          searchToken,\n        };\n      });\n    },\n    hasItems() {\n      return this.items.length > 0;\n    },\n  },\n\n  methods: {\n    onItemActivated(text) {\n      eventHub.$emit('recentSearchesItemSelected', text);\n    },\n    onRequestClearRecentSearches(e) {\n      // Stop the dropdown from closing\n      e.stopPropagation();\n\n      eventHub.$emit('requestClearRecentSearches');\n    },\n  },\n\n  template: `\n    <div>\n      <div\n        v-if=\"!isLocalStorageAvailable\"\n        class=\"dropdown-info-note\">\n        This feature requires local storage to be enabled\n      </div>\n      <ul v-else-if=\"hasItems\">\n        <li\n          v-for=\"(item, index) in processedItems\"\n          :key=\"index\">\n          <button\n            type=\"button\"\n            class=\"filtered-search-history-dropdown-item\"\n            @click=\"onItemActivated(item.text)\">\n            <span>\n              <span\n                v-for=\"(token, tokenIndex) in item.tokens\"\n                class=\"filtered-search-history-dropdown-token\">\n                <span class=\"name\">{{ token.prefix }}</span><span class=\"value\">{{ token.suffix }}</span>\n              </span>\n            </span>\n            <span class=\"filtered-search-history-dropdown-search-token\">\n              {{ item.searchToken }}\n            </span>\n          </button>\n        </li>\n        <li class=\"divider\"></li>\n        <li>\n          <button\n            type=\"button\"\n            class=\"filtered-search-history-clear-button\"\n            @click=\"onRequestClearRecentSearches($event)\">\n            Clear recent searches\n          </button>\n        </li>\n      </ul>\n      <div\n        v-else\n        class=\"dropdown-info-note\">\n        You don't have any recent searches\n      </div>\n    </div>\n  `,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./filtered_search/components/recent_searches_dropdown_content.js","/* eslint-disable class-methods-use-this */\nlet container = document;\n\nclass FilteredSearchContainerClass {\n  set container(containerParam) {\n    container = containerParam;\n  }\n\n  get container() {\n    return container;\n  }\n}\n\nexport default new FilteredSearchContainerClass();\n\n\n\n// WEBPACK FOOTER //\n// ./filtered_search/container.js","import Filter from '~/droplab/plugins/filter';\nimport './filtered_search_dropdown';\n\nclass DropdownHint extends gl.FilteredSearchDropdown {\n  constructor(droplab, dropdown, input, tokenKeys, filter) {\n    super(droplab, dropdown, input, filter);\n    this.config = {\n      Filter: {\n        template: 'hint',\n        filterFunction: gl.DropdownUtils.filterHint.bind(null, {\n          input,\n          allowedKeys: tokenKeys.getKeys(),\n        }),\n      },\n    };\n    this.tokenKeys = tokenKeys;\n  }\n\n  itemClicked(e) {\n    const { selected } = e.detail;\n\n    if (selected.tagName === 'LI') {\n      if (selected.hasAttribute('data-value')) {\n        this.dismissDropdown();\n      } else if (selected.getAttribute('data-action') === 'submit') {\n        this.dismissDropdown();\n        this.dispatchFormSubmitEvent();\n      } else {\n        const token = selected.querySelector('.js-filter-hint').innerText.trim();\n        const tag = selected.querySelector('.js-filter-tag').innerText.trim();\n\n        if (tag.length) {\n          // Get previous input values in the input field and convert them into visual tokens\n          const previousInputValues = this.input.value.split(' ');\n          const searchTerms = [];\n\n          previousInputValues.forEach((value, index) => {\n            searchTerms.push(value);\n\n            if (index === previousInputValues.length - 1\n              && token.indexOf(value.toLowerCase()) !== -1) {\n              searchTerms.pop();\n            }\n          });\n\n          if (searchTerms.length > 0) {\n            gl.FilteredSearchVisualTokens.addSearchVisualToken(searchTerms.join(' '));\n          }\n\n          gl.FilteredSearchDropdownManager.addWordToInput(token.replace(':', ''), '', false, this.container);\n        }\n        this.dismissDropdown();\n        this.dispatchInputEvent();\n      }\n    }\n  }\n\n  renderContent() {\n    const dropdownData = gl.FilteredSearchTokenKeys.get()\n      .map(tokenKey => ({\n        icon: `fa-${tokenKey.icon}`,\n        hint: tokenKey.key,\n        tag: `<${tokenKey.symbol}${tokenKey.key}>`,\n        type: tokenKey.type,\n      }));\n\n    this.droplab.changeHookList(this.hookId, this.dropdown, [Filter], this.config);\n    this.droplab.setData(this.hookId, dropdownData);\n  }\n\n  init() {\n    this.droplab.addHook(this.input, this.dropdown, [Filter], this.config).init();\n  }\n}\n\nwindow.gl = window.gl || {};\ngl.DropdownHint = DropdownHint;\n\n\n\n// WEBPACK FOOTER //\n// ./filtered_search/dropdown_hint.js","/* global Flash */\n\nimport Ajax from '~/droplab/plugins/ajax';\nimport Filter from '~/droplab/plugins/filter';\nimport './filtered_search_dropdown';\n\nclass DropdownNonUser extends gl.FilteredSearchDropdown {\n  constructor(droplab, dropdown, input, tokenKeys, filter, endpoint, symbol) {\n    super(droplab, dropdown, input, filter);\n    this.symbol = symbol;\n    this.config = {\n      Ajax: {\n        endpoint,\n        method: 'setData',\n        loadingTemplate: this.loadingTemplate,\n        onError() {\n          /* eslint-disable no-new */\n          new Flash('An error occured fetching the dropdown data.');\n          /* eslint-enable no-new */\n        },\n      },\n      Filter: {\n        filterFunction: gl.DropdownUtils.filterWithSymbol.bind(null, this.symbol, input),\n        template: 'title',\n      },\n    };\n  }\n\n  itemClicked(e) {\n    super.itemClicked(e, (selected) => {\n      const title = selected.querySelector('.js-data-value').innerText.trim();\n      return `${this.symbol}${gl.DropdownUtils.getEscapedText(title)}`;\n    });\n  }\n\n  renderContent(forceShowList = false) {\n    this.droplab\n      .changeHookList(this.hookId, this.dropdown, [Ajax, Filter], this.config);\n    super.renderContent(forceShowList);\n  }\n\n  init() {\n    this.droplab\n      .addHook(this.input, this.dropdown, [Ajax, Filter], this.config).init();\n  }\n}\n\nwindow.gl = window.gl || {};\ngl.DropdownNonUser = DropdownNonUser;\n\n\n\n// WEBPACK FOOTER //\n// ./filtered_search/dropdown_non_user.js","/* global Flash */\n\nimport AjaxFilter from '~/droplab/plugins/ajax_filter';\nimport './filtered_search_dropdown';\n\nclass DropdownUser extends gl.FilteredSearchDropdown {\n  constructor(droplab, dropdown, input, tokenKeys, filter) {\n    super(droplab, dropdown, input, filter);\n    this.config = {\n      AjaxFilter: {\n        endpoint: `${gon.relative_url_root || ''}/autocomplete/users.json`,\n        searchKey: 'search',\n        params: {\n          per_page: 20,\n          active: true,\n          project_id: this.getProjectId(),\n          current_user: true,\n        },\n        searchValueFunction: this.getSearchInput.bind(this),\n        loadingTemplate: this.loadingTemplate,\n        onLoadingFinished: () => {\n          this.hideCurrentUser();\n        },\n        onError() {\n          /* eslint-disable no-new */\n          new Flash('An error occured fetching the dropdown data.');\n          /* eslint-enable no-new */\n        },\n      },\n    };\n    this.tokenKeys = tokenKeys;\n  }\n\n  hideCurrentUser() {\n    const currenUserItem = this.dropdown.querySelector('.js-current-user');\n    currenUserItem.classList.add('hidden');\n  }\n\n  itemClicked(e) {\n    super.itemClicked(e,\n      selected => selected.querySelector('.dropdown-light-content').innerText.trim());\n  }\n\n  renderContent(forceShowList = false) {\n    this.droplab.changeHookList(this.hookId, this.dropdown, [AjaxFilter], this.config);\n    super.renderContent(forceShowList);\n  }\n\n  getProjectId() {\n    return this.input.getAttribute('data-project-id');\n  }\n\n  getSearchInput() {\n    const query = gl.DropdownUtils.getSearchInput(this.input);\n    const { lastToken } = gl.FilteredSearchTokenizer.processTokens(query, this.tokenKeys.get());\n\n    let value = lastToken || '';\n\n    if (value[0] === '@') {\n      value = value.slice(1);\n    }\n\n    // Removes the first character if it is a quotation so that we can search\n    // with multiple words\n    if (value[0] === '\"' || value[0] === '\\'') {\n      value = value.slice(1);\n    }\n\n    return value;\n  }\n\n  init() {\n    this.droplab.addHook(this.input, this.dropdown, [AjaxFilter], this.config).init();\n  }\n}\n\nwindow.gl = window.gl || {};\ngl.DropdownUser = DropdownUser;\n\n\n\n// WEBPACK FOOTER //\n// ./filtered_search/dropdown_user.js","import FilteredSearchContainer from './container';\n\nclass DropdownUtils {\n  static getEscapedText(text) {\n    let escapedText = text;\n    const hasSpace = text.indexOf(' ') !== -1;\n    const hasDoubleQuote = text.indexOf('\"') !== -1;\n\n    // Encapsulate value with quotes if it has spaces\n    // Known side effect: values's with both single and double quotes\n    // won't escape properly\n    if (hasSpace) {\n      if (hasDoubleQuote) {\n        escapedText = `'${text}'`;\n      } else {\n        // Encapsulate singleQuotes or if it hasSpace\n        escapedText = `\"${text}\"`;\n      }\n    }\n\n    return escapedText;\n  }\n\n  static filterWithSymbol(filterSymbol, input, item) {\n    const updatedItem = item;\n    const searchInput = gl.DropdownUtils.getSearchInput(input);\n\n    const title = updatedItem.title.toLowerCase();\n    let value = searchInput.toLowerCase();\n    let symbol = '';\n\n    // Remove the symbol for filter\n    if (value[0] === filterSymbol) {\n      symbol = value[0];\n      value = value.slice(1);\n    }\n\n    // Removes the first character if it is a quotation so that we can search\n    // with multiple words\n    if ((value[0] === '\"' || value[0] === '\\'') && title.indexOf(' ') !== -1) {\n      value = value.slice(1);\n    }\n\n    // Eg. filterSymbol = ~ for labels\n    const matchWithoutSymbol = symbol === filterSymbol && title.indexOf(value) !== -1;\n    const match = title.indexOf(`${symbol}${value}`) !== -1;\n\n    updatedItem.droplab_hidden = !match && !matchWithoutSymbol;\n\n    return updatedItem;\n  }\n\n  static filterHint(config, item) {\n    const { input, allowedKeys } = config;\n    const updatedItem = item;\n    const searchInput = gl.DropdownUtils.getSearchQuery(input);\n    const { lastToken, tokens } =\n      gl.FilteredSearchTokenizer.processTokens(searchInput, allowedKeys);\n    const lastKey = lastToken.key || lastToken || '';\n    const allowMultiple = item.type === 'array';\n    const itemInExistingTokens = tokens.some(t => t.key === item.hint);\n\n    if (!allowMultiple && itemInExistingTokens) {\n      updatedItem.droplab_hidden = true;\n    } else if (!lastKey || searchInput.split('').last() === ' ') {\n      updatedItem.droplab_hidden = false;\n    } else if (lastKey) {\n      const split = lastKey.split(':');\n      const tokenName = split[0].split(' ').last();\n\n      const match = updatedItem.hint.indexOf(tokenName.toLowerCase()) === -1;\n      updatedItem.droplab_hidden = tokenName ? match : false;\n    }\n\n    return updatedItem;\n  }\n\n  static setDataValueIfSelected(filter, selected) {\n    const dataValue = selected.getAttribute('data-value');\n\n    if (dataValue) {\n      gl.FilteredSearchDropdownManager.addWordToInput(filter, dataValue, true);\n    }\n\n    // Return boolean based on whether it was set\n    return dataValue !== null;\n  }\n\n  // Determines the full search query (visual tokens + input)\n  static getSearchQuery(untilInput = false) {\n    const container = FilteredSearchContainer.container;\n    const tokens = [].slice.call(container.querySelectorAll('.tokens-container li'));\n    const values = [];\n\n    if (untilInput) {\n      const inputIndex = _.findIndex(tokens, t => t.classList.contains('input-token'));\n      // Add one to include input-token to the tokens array\n      tokens.splice(inputIndex + 1);\n    }\n\n    tokens.forEach((token) => {\n      if (token.classList.contains('js-visual-token')) {\n        const name = token.querySelector('.name');\n        const value = token.querySelector('.value');\n        const valueContainer = token.querySelector('.value-container');\n        const symbol = value && value.dataset.symbol ? value.dataset.symbol : '';\n        let valueText = '';\n\n        if (valueContainer && valueContainer.dataset.originalValue) {\n          valueText = valueContainer.dataset.originalValue;\n        } else if (value && value.innerText) {\n          valueText = value.innerText;\n        }\n\n        if (token.className.indexOf('filtered-search-token') !== -1) {\n          values.push(`${name.innerText.toLowerCase()}:${symbol}${valueText}`);\n        } else {\n          values.push(name.innerText);\n        }\n      } else if (token.classList.contains('input-token')) {\n        const { isLastVisualTokenValid } =\n          gl.FilteredSearchVisualTokens.getLastVisualTokenBeforeInput();\n\n        const input = FilteredSearchContainer.container.querySelector('.filtered-search');\n        const inputValue = input && input.value;\n\n        if (isLastVisualTokenValid) {\n          values.push(inputValue);\n        } else {\n          const previous = values.pop();\n          values.push(`${previous}${inputValue}`);\n        }\n      }\n    });\n\n    return values\n      .map(value => value.trim())\n      .join(' ');\n  }\n\n  static getSearchInput(filteredSearchInput) {\n    const inputValue = filteredSearchInput.value;\n    const { right } = gl.DropdownUtils.getInputSelectionPosition(filteredSearchInput);\n\n    return inputValue.slice(0, right);\n  }\n\n  static getInputSelectionPosition(input) {\n    const selectionStart = input.selectionStart;\n    let inputValue = input.value;\n    // Replace all spaces inside quote marks with underscores\n    // (will continue to match entire string until an end quote is found if any)\n    // This helps with matching the beginning & end of a token:key\n    inputValue = inputValue.replace(/(('[^']*'{0,1})|(\"[^\"]*\"{0,1})|:\\s+)/g, str => str.replace(/\\s/g, '_'));\n\n    // Get the right position for the word selected\n    // Regex matches first space\n    let right = inputValue.slice(selectionStart).search(/\\s/);\n\n    if (right >= 0) {\n      right += selectionStart;\n    } else if (right < 0) {\n      right = inputValue.length;\n    }\n\n    // Get the left position for the word selected\n    // Regex matches last non-whitespace character\n    let left = inputValue.slice(0, right).search(/\\S+$/);\n\n    if (selectionStart === 0) {\n      left = 0;\n    } else if (selectionStart === inputValue.length && left < 0) {\n      left = inputValue.length;\n    } else if (left < 0) {\n      left = selectionStart;\n    }\n\n    return {\n      left,\n      right,\n    };\n  }\n}\n\nwindow.gl = window.gl || {};\ngl.DropdownUtils = DropdownUtils;\n\n\n\n// WEBPACK FOOTER //\n// ./filtered_search/dropdown_utils.js","import Vue from 'vue';\n\nexport default new Vue();\n\n\n\n// WEBPACK FOOTER //\n// ./filtered_search/event_hub.js","const DATA_DROPDOWN_TRIGGER = 'data-dropdown-trigger';\n\nclass FilteredSearchDropdown {\n  constructor(droplab, dropdown, input, filter) {\n    this.droplab = droplab;\n    this.hookId = input && input.id;\n    this.input = input;\n    this.filter = filter;\n    this.dropdown = dropdown;\n    this.loadingTemplate = `<div class=\"filter-dropdown-loading\">\n      <i class=\"fa fa-spinner fa-spin\"></i>\n    </div>`;\n    this.bindEvents();\n  }\n\n  bindEvents() {\n    this.itemClickedWrapper = this.itemClicked.bind(this);\n    this.dropdown.addEventListener('click.dl', this.itemClickedWrapper);\n  }\n\n  unbindEvents() {\n    this.dropdown.removeEventListener('click.dl', this.itemClickedWrapper);\n  }\n\n  getCurrentHook() {\n    return this.droplab.hooks.filter(h => h.id === this.hookId)[0] || null;\n  }\n\n  itemClicked(e, getValueFunction) {\n    const { selected } = e.detail;\n\n    if (selected.tagName === 'LI' && selected.innerHTML) {\n      const dataValueSet = gl.DropdownUtils.setDataValueIfSelected(this.filter, selected);\n\n      if (!dataValueSet) {\n        const value = getValueFunction(selected);\n        gl.FilteredSearchDropdownManager.addWordToInput(this.filter, value, true);\n      }\n\n      this.resetFilters();\n      this.dismissDropdown();\n      this.dispatchInputEvent();\n    }\n  }\n\n  setAsDropdown() {\n    this.input.setAttribute(DATA_DROPDOWN_TRIGGER, `#${this.dropdown.id}`);\n  }\n\n  setOffset(offset = 0) {\n    if (window.innerWidth > 480) {\n      this.dropdown.style.left = `${offset}px`;\n    } else {\n      this.dropdown.style.left = '0px';\n    }\n  }\n\n  renderContent(forceShowList = false) {\n    const currentHook = this.getCurrentHook();\n    if (forceShowList && currentHook && currentHook.list.hidden) {\n      currentHook.list.show();\n    }\n  }\n\n  render(forceRenderContent = false, forceShowList = false) {\n    this.setAsDropdown();\n\n    const currentHook = this.getCurrentHook();\n    const firstTimeInitialized = currentHook === null;\n\n    if (firstTimeInitialized || forceRenderContent) {\n      this.renderContent(forceShowList);\n    } else if (currentHook.list.list.id !== this.dropdown.id) {\n      this.renderContent(forceShowList);\n    }\n  }\n\n  dismissDropdown() {\n    // Focusing on the input will dismiss dropdown\n    // (default droplab functionality)\n    this.input.focus();\n  }\n\n  dispatchInputEvent() {\n    // Propogate input change to FilteredSearchDropdownManager\n    // so that it can determine which dropdowns to open\n    this.input.dispatchEvent(new CustomEvent('input', {\n      bubbles: true,\n      cancelable: true,\n    }));\n  }\n\n  dispatchFormSubmitEvent() {\n    // dispatchEvent() is necessary as form.submit() does not\n    // trigger event handlers\n    this.input.form.dispatchEvent(new Event('submit'));\n  }\n\n  hideDropdown() {\n    const currentHook = this.getCurrentHook();\n    if (currentHook) {\n      currentHook.list.hide();\n    }\n  }\n\n  resetFilters() {\n    const hook = this.getCurrentHook();\n\n    if (hook) {\n      const data = hook.list.data || [];\n      const results = data.map((o) => {\n        const updated = o;\n        updated.droplab_hidden = false;\n        return updated;\n      });\n      hook.list.render(results);\n    }\n  }\n}\n\nwindow.gl = window.gl || {};\ngl.FilteredSearchDropdown = FilteredSearchDropdown;\n\n\n\n// WEBPACK FOOTER //\n// ./filtered_search/filtered_search_dropdown.js","import DropLab from '~/droplab/drop_lab';\nimport FilteredSearchContainer from './container';\n\nclass FilteredSearchDropdownManager {\n  constructor(baseEndpoint = '', tokenizer, page) {\n    this.container = FilteredSearchContainer.container;\n    this.baseEndpoint = baseEndpoint.replace(/\\/$/, '');\n    this.tokenizer = tokenizer;\n    this.filteredSearchTokenKeys = gl.FilteredSearchTokenKeys;\n    this.filteredSearchInput = this.container.querySelector('.filtered-search');\n    this.page = page;\n\n    this.setupMapping();\n\n    this.cleanupWrapper = this.cleanup.bind(this);\n    document.addEventListener('beforeunload', this.cleanupWrapper);\n  }\n\n  cleanup() {\n    if (this.droplab) {\n      this.droplab.destroy();\n      this.droplab = null;\n    }\n\n    this.setupMapping();\n\n    document.removeEventListener('beforeunload', this.cleanupWrapper);\n  }\n\n  setupMapping() {\n    this.mapping = {\n      author: {\n        reference: null,\n        gl: 'DropdownUser',\n        element: this.container.querySelector('#js-dropdown-author'),\n      },\n      assignee: {\n        reference: null,\n        gl: 'DropdownUser',\n        element: this.container.querySelector('#js-dropdown-assignee'),\n      },\n      milestone: {\n        reference: null,\n        gl: 'DropdownNonUser',\n        extraArguments: [`${this.baseEndpoint}/milestones.json`, '%'],\n        element: this.container.querySelector('#js-dropdown-milestone'),\n      },\n      label: {\n        reference: null,\n        gl: 'DropdownNonUser',\n        extraArguments: [`${this.baseEndpoint}/labels.json`, '~'],\n        element: this.container.querySelector('#js-dropdown-label'),\n      },\n      hint: {\n        reference: null,\n        gl: 'DropdownHint',\n        element: this.container.querySelector('#js-dropdown-hint'),\n      },\n    };\n  }\n\n  static addWordToInput(tokenName, tokenValue = '', clicked = false) {\n    const input = FilteredSearchContainer.container.querySelector('.filtered-search');\n\n    gl.FilteredSearchVisualTokens.addFilterVisualToken(tokenName, tokenValue);\n    input.value = '';\n\n    if (clicked) {\n      gl.FilteredSearchVisualTokens.moveInputToTheRight();\n    }\n  }\n\n  updateCurrentDropdownOffset() {\n    this.updateDropdownOffset(this.currentDropdown);\n  }\n\n  updateDropdownOffset(key) {\n    // Always align dropdown with the input field\n    let offset = this.filteredSearchInput.getBoundingClientRect().left - this.container.querySelector('.scroll-container').getBoundingClientRect().left;\n\n    const maxInputWidth = 240;\n    const currentDropdownWidth = this.mapping[key].element.clientWidth || maxInputWidth;\n\n    // Make sure offset never exceeds the input container\n    const offsetMaxWidth = this.container.querySelector('.scroll-container').clientWidth - currentDropdownWidth;\n    if (offsetMaxWidth < offset) {\n      offset = offsetMaxWidth;\n    }\n\n    this.mapping[key].reference.setOffset(offset);\n  }\n\n  load(key, firstLoad = false) {\n    const mappingKey = this.mapping[key];\n    const glClass = mappingKey.gl;\n    const element = mappingKey.element;\n    let forceShowList = false;\n\n    if (!mappingKey.reference) {\n      const dl = this.droplab;\n      const defaultArguments =\n        [null, dl, element, this.filteredSearchInput, this.filteredSearchTokenKeys, key];\n      const glArguments = defaultArguments.concat(mappingKey.extraArguments || []);\n\n      // Passing glArguments to `new gl[glClass](<arguments>)`\n      mappingKey.reference = new (Function.prototype.bind.apply(gl[glClass], glArguments))();\n    }\n\n    if (firstLoad) {\n      mappingKey.reference.init();\n    }\n\n    if (this.currentDropdown === 'hint') {\n      // Force the dropdown to show if it was clicked from the hint dropdown\n      forceShowList = true;\n    }\n\n    this.updateDropdownOffset(key);\n    mappingKey.reference.render(firstLoad, forceShowList);\n\n    this.currentDropdown = key;\n  }\n\n  loadDropdown(dropdownName = '') {\n    let firstLoad = false;\n\n    if (!this.droplab) {\n      firstLoad = true;\n      this.droplab = new DropLab();\n    }\n\n    const match = this.filteredSearchTokenKeys.searchByKey(dropdownName.toLowerCase());\n    const shouldOpenFilterDropdown = match && this.currentDropdown !== match.key\n      && this.mapping[match.key];\n    const shouldOpenHintDropdown = !match && this.currentDropdown !== 'hint';\n\n    if (shouldOpenFilterDropdown || shouldOpenHintDropdown) {\n      const key = match && match.key ? match.key : 'hint';\n      this.load(key, firstLoad);\n    }\n  }\n\n  setDropdown() {\n    const query = gl.DropdownUtils.getSearchQuery(true);\n    const { lastToken, searchToken } =\n      this.tokenizer.processTokens(query, this.filteredSearchTokenKeys.getKeys());\n\n    if (this.currentDropdown) {\n      this.updateCurrentDropdownOffset();\n    }\n\n    if (lastToken === searchToken && lastToken !== null) {\n      // Token is not fully initialized yet because it has no value\n      // Eg. token = 'label:'\n\n      const split = lastToken.split(':');\n      const dropdownName = split[0].split(' ').last();\n      this.loadDropdown(split.length > 1 ? dropdownName : '');\n    } else if (lastToken) {\n      // Token has been initialized into an object because it has a value\n      this.loadDropdown(lastToken.key);\n    } else {\n      this.loadDropdown('hint');\n    }\n  }\n\n  resetDropdowns() {\n    if (!this.currentDropdown) {\n      return;\n    }\n\n    // Force current dropdown to hide\n    this.mapping[this.currentDropdown].reference.hideDropdown();\n\n    // Re-Load dropdown\n    this.setDropdown();\n\n    // Reset filters for current dropdown\n    this.mapping[this.currentDropdown].reference.resetFilters();\n\n    // Reposition dropdown so that it is aligned with cursor\n    this.updateDropdownOffset(this.currentDropdown);\n  }\n\n  destroyDroplab() {\n    this.droplab.destroy();\n  }\n}\n\nwindow.gl = window.gl || {};\ngl.FilteredSearchDropdownManager = FilteredSearchDropdownManager;\n\n\n\n// WEBPACK FOOTER //\n// ./filtered_search/filtered_search_dropdown_manager.js","import FilteredSearchContainer from './container';\nimport RecentSearchesRoot from './recent_searches_root';\nimport RecentSearchesStore from './stores/recent_searches_store';\nimport RecentSearchesService from './services/recent_searches_service';\nimport eventHub from './event_hub';\n\nclass FilteredSearchManager {\n  constructor(page) {\n    this.page = page;\n    this.container = FilteredSearchContainer.container;\n    this.filteredSearchInput = this.container.querySelector('.filtered-search');\n    this.filteredSearchInputForm = this.filteredSearchInput.form;\n    this.clearSearchButton = this.container.querySelector('.clear-search');\n    this.tokensContainer = this.container.querySelector('.tokens-container');\n    this.filteredSearchTokenKeys = gl.FilteredSearchTokenKeys;\n\n    this.recentSearchesStore = new RecentSearchesStore({\n      isLocalStorageAvailable: RecentSearchesService.isAvailable(),\n      allowedKeys: this.filteredSearchTokenKeys.getKeys(),\n    });\n    this.searchHistoryDropdownElement = document.querySelector('.js-filtered-search-history-dropdown');\n    const projectPath = this.searchHistoryDropdownElement ?\n      this.searchHistoryDropdownElement.dataset.projectFullPath : 'project';\n    let recentSearchesPagePrefix = 'issue-recent-searches';\n    if (this.page === 'merge_requests') {\n      recentSearchesPagePrefix = 'merge-request-recent-searches';\n    }\n    const recentSearchesKey = `${projectPath}-${recentSearchesPagePrefix}`;\n    this.recentSearchesService = new RecentSearchesService(recentSearchesKey);\n  }\n\n  setup() {\n    // Fetch recent searches from localStorage\n    this.fetchingRecentSearchesPromise = this.recentSearchesService.fetch()\n      .catch((error) => {\n        if (error.name === 'RecentSearchesServiceError') return undefined;\n        // eslint-disable-next-line no-new\n        new window.Flash('An error occured while parsing recent searches');\n        // Gracefully fail to empty array\n        return [];\n      })\n      .then((searches) => {\n        // Put any searches that may have come in before\n        // we fetched the saved searches ahead of the already saved ones\n        const resultantSearches = this.recentSearchesStore.setRecentSearches(\n          this.recentSearchesStore.state.recentSearches.concat(searches),\n        );\n        this.recentSearchesService.save(resultantSearches);\n      });\n\n    if (this.filteredSearchInput) {\n      this.tokenizer = gl.FilteredSearchTokenizer;\n      this.dropdownManager = new gl.FilteredSearchDropdownManager(this.filteredSearchInput.getAttribute('data-base-endpoint') || '', this.tokenizer, this.page);\n\n      this.recentSearchesRoot = new RecentSearchesRoot(\n        this.recentSearchesStore,\n        this.recentSearchesService,\n        this.searchHistoryDropdownElement,\n      );\n      this.recentSearchesRoot.init();\n\n      this.bindEvents();\n      this.loadSearchParamsFromURL();\n      this.dropdownManager.setDropdown();\n\n      this.cleanupWrapper = this.cleanup.bind(this);\n      document.addEventListener('beforeunload', this.cleanupWrapper);\n    }\n  }\n\n  cleanup() {\n    this.unbindEvents();\n    document.removeEventListener('beforeunload', this.cleanupWrapper);\n\n    if (this.recentSearchesRoot) {\n      this.recentSearchesRoot.destroy();\n    }\n  }\n\n  bindStateEvents() {\n    this.stateFilters = document.querySelector('.container-fluid .issues-state-filters');\n\n    if (this.stateFilters) {\n      this.searchStateWrapper = this.searchState.bind(this);\n\n      this.stateFilters.querySelector('[data-state=\"opened\"]')\n        .addEventListener('click', this.searchStateWrapper);\n      this.stateFilters.querySelector('[data-state=\"closed\"]')\n        .addEventListener('click', this.searchStateWrapper);\n      this.stateFilters.querySelector('[data-state=\"all\"]')\n        .addEventListener('click', this.searchStateWrapper);\n\n      this.mergedState = this.stateFilters.querySelector('[data-state=\"merged\"]');\n      if (this.mergedState) {\n        this.mergedState.addEventListener('click', this.searchStateWrapper);\n      }\n    }\n  }\n\n  unbindStateEvents() {\n    if (this.stateFilters) {\n      this.stateFilters.querySelector('[data-state=\"opened\"]')\n        .removeEventListener('click', this.searchStateWrapper);\n      this.stateFilters.querySelector('[data-state=\"closed\"]')\n        .removeEventListener('click', this.searchStateWrapper);\n      this.stateFilters.querySelector('[data-state=\"all\"]')\n        .removeEventListener('click', this.searchStateWrapper);\n\n      if (this.mergedState) {\n        this.mergedState.removeEventListener('click', this.searchStateWrapper);\n      }\n    }\n  }\n\n  bindEvents() {\n    this.handleFormSubmit = this.handleFormSubmit.bind(this);\n    this.setDropdownWrapper = this.dropdownManager.setDropdown.bind(this.dropdownManager);\n    this.toggleClearSearchButtonWrapper = this.toggleClearSearchButton.bind(this);\n    this.handleInputPlaceholderWrapper = this.handleInputPlaceholder.bind(this);\n    this.handleInputVisualTokenWrapper = this.handleInputVisualToken.bind(this);\n    this.checkForEnterWrapper = this.checkForEnter.bind(this);\n    this.onClearSearchWrapper = this.onClearSearch.bind(this);\n    this.checkForBackspaceWrapper = this.checkForBackspace.bind(this);\n    this.removeSelectedTokenKeydownWrapper = this.removeSelectedTokenKeydown.bind(this);\n    this.unselectEditTokensWrapper = this.unselectEditTokens.bind(this);\n    this.editTokenWrapper = this.editToken.bind(this);\n    this.tokenChange = this.tokenChange.bind(this);\n    this.addInputContainerFocusWrapper = this.addInputContainerFocus.bind(this);\n    this.removeInputContainerFocusWrapper = this.removeInputContainerFocus.bind(this);\n    this.onrecentSearchesItemSelectedWrapper = this.onrecentSearchesItemSelected.bind(this);\n    this.removeTokenWrapper = this.removeToken.bind(this);\n\n    this.filteredSearchInputForm.addEventListener('submit', this.handleFormSubmit);\n    this.filteredSearchInput.addEventListener('input', this.setDropdownWrapper);\n    this.filteredSearchInput.addEventListener('input', this.toggleClearSearchButtonWrapper);\n    this.filteredSearchInput.addEventListener('input', this.handleInputPlaceholderWrapper);\n    this.filteredSearchInput.addEventListener('input', this.handleInputVisualTokenWrapper);\n    this.filteredSearchInput.addEventListener('keydown', this.checkForEnterWrapper);\n    this.filteredSearchInput.addEventListener('keyup', this.checkForBackspaceWrapper);\n    this.filteredSearchInput.addEventListener('click', this.tokenChange);\n    this.filteredSearchInput.addEventListener('keyup', this.tokenChange);\n    this.filteredSearchInput.addEventListener('focus', this.addInputContainerFocusWrapper);\n    this.tokensContainer.addEventListener('click', this.removeTokenWrapper);\n    this.tokensContainer.addEventListener('click', this.editTokenWrapper);\n    this.clearSearchButton.addEventListener('click', this.onClearSearchWrapper);\n    document.addEventListener('click', this.unselectEditTokensWrapper);\n    document.addEventListener('click', this.removeInputContainerFocusWrapper);\n    document.addEventListener('keydown', this.removeSelectedTokenKeydownWrapper);\n    eventHub.$on('recentSearchesItemSelected', this.onrecentSearchesItemSelectedWrapper);\n\n    this.bindStateEvents();\n  }\n\n  unbindEvents() {\n    this.filteredSearchInputForm.removeEventListener('submit', this.handleFormSubmit);\n    this.filteredSearchInput.removeEventListener('input', this.setDropdownWrapper);\n    this.filteredSearchInput.removeEventListener('input', this.toggleClearSearchButtonWrapper);\n    this.filteredSearchInput.removeEventListener('input', this.handleInputPlaceholderWrapper);\n    this.filteredSearchInput.removeEventListener('input', this.handleInputVisualTokenWrapper);\n    this.filteredSearchInput.removeEventListener('keydown', this.checkForEnterWrapper);\n    this.filteredSearchInput.removeEventListener('keyup', this.checkForBackspaceWrapper);\n    this.filteredSearchInput.removeEventListener('click', this.tokenChange);\n    this.filteredSearchInput.removeEventListener('keyup', this.tokenChange);\n    this.filteredSearchInput.removeEventListener('focus', this.addInputContainerFocusWrapper);\n    this.tokensContainer.removeEventListener('click', this.removeTokenWrapper);\n    this.tokensContainer.removeEventListener('click', this.editTokenWrapper);\n    this.clearSearchButton.removeEventListener('click', this.onClearSearchWrapper);\n    document.removeEventListener('click', this.unselectEditTokensWrapper);\n    document.removeEventListener('click', this.removeInputContainerFocusWrapper);\n    document.removeEventListener('keydown', this.removeSelectedTokenKeydownWrapper);\n    eventHub.$off('recentSearchesItemSelected', this.onrecentSearchesItemSelectedWrapper);\n\n    this.unbindStateEvents();\n  }\n\n  checkForBackspace(e) {\n    // 8 = Backspace Key\n    // 46 = Delete Key\n    if (e.keyCode === 8 || e.keyCode === 46) {\n      const { lastVisualToken } = gl.FilteredSearchVisualTokens.getLastVisualTokenBeforeInput();\n\n      const sanitizedTokenName = lastVisualToken && lastVisualToken.querySelector('.name').textContent.trim();\n      const canEdit = sanitizedTokenName && this.canEdit && this.canEdit(sanitizedTokenName);\n      if (this.filteredSearchInput.value === '' && lastVisualToken && canEdit) {\n        this.filteredSearchInput.value = gl.FilteredSearchVisualTokens.getLastTokenPartial();\n        gl.FilteredSearchVisualTokens.removeLastTokenPartial();\n      }\n\n      // Reposition dropdown so that it is aligned with cursor\n      this.dropdownManager.updateCurrentDropdownOffset();\n    }\n  }\n\n  checkForEnter(e) {\n    if (e.keyCode === 38 || e.keyCode === 40) {\n      const selectionStart = this.filteredSearchInput.selectionStart;\n\n      e.preventDefault();\n      this.filteredSearchInput.setSelectionRange(selectionStart, selectionStart);\n    }\n\n    if (e.keyCode === 13) {\n      const dropdown = this.dropdownManager.mapping[this.dropdownManager.currentDropdown];\n      const dropdownEl = dropdown.element;\n      const activeElements = dropdownEl.querySelectorAll('.droplab-item-active');\n\n      e.preventDefault();\n\n      if (!activeElements.length) {\n        if (this.isHandledAsync) {\n          e.stopImmediatePropagation();\n\n          this.filteredSearchInput.blur();\n          this.dropdownManager.resetDropdowns();\n        } else {\n          // Prevent droplab from opening dropdown\n          this.dropdownManager.destroyDroplab();\n        }\n\n        this.search();\n      }\n    }\n  }\n\n  addInputContainerFocus() {\n    const inputContainer = this.filteredSearchInput.closest('.filtered-search-box');\n\n    if (inputContainer) {\n      inputContainer.classList.add('focus');\n    }\n  }\n\n  removeInputContainerFocus(e) {\n    const inputContainer = this.filteredSearchInput.closest('.filtered-search-box');\n    const isElementInFilteredSearch = inputContainer && inputContainer.contains(e.target);\n    const isElementInDynamicFilterDropdown = e.target.closest('.filter-dropdown') !== null;\n    const isElementInStaticFilterDropdown = e.target.closest('ul[data-dropdown]') !== null;\n\n    if (!isElementInFilteredSearch && !isElementInDynamicFilterDropdown &&\n      !isElementInStaticFilterDropdown && inputContainer) {\n      inputContainer.classList.remove('focus');\n    }\n  }\n\n  removeToken(e) {\n    const removeButtonSelected = e.target.closest('.remove-token');\n\n    if (removeButtonSelected) {\n      e.preventDefault();\n      // Prevent editToken from being triggered after token is removed\n      e.stopImmediatePropagation();\n\n      const button = e.target.closest('.selectable');\n      gl.FilteredSearchVisualTokens.selectToken(button, true);\n      this.removeSelectedToken();\n    }\n  }\n\n  unselectEditTokens(e) {\n    const inputContainer = this.container.querySelector('.filtered-search-box');\n    const isElementInFilteredSearch = inputContainer && inputContainer.contains(e.target);\n    const isElementInFilterDropdown = e.target.closest('.filter-dropdown') !== null;\n    const isElementTokensContainer = e.target.classList.contains('tokens-container');\n\n    if ((!isElementInFilteredSearch && !isElementInFilterDropdown) || isElementTokensContainer) {\n      gl.FilteredSearchVisualTokens.moveInputToTheRight();\n      this.dropdownManager.resetDropdowns();\n    }\n  }\n\n  editToken(e) {\n    const token = e.target.closest('.js-visual-token');\n    const sanitizedTokenName = token && token.querySelector('.name').textContent.trim();\n    const canEdit = this.canEdit && this.canEdit(sanitizedTokenName);\n\n    if (token && canEdit) {\n      e.preventDefault();\n      e.stopPropagation();\n      gl.FilteredSearchVisualTokens.editToken(token);\n      this.tokenChange();\n    }\n  }\n\n  toggleClearSearchButton() {\n    const query = gl.DropdownUtils.getSearchQuery();\n    const hidden = 'hidden';\n    const hasHidden = this.clearSearchButton.classList.contains(hidden);\n\n    if (query.length === 0 && !hasHidden) {\n      this.clearSearchButton.classList.add(hidden);\n    } else if (query.length && hasHidden) {\n      this.clearSearchButton.classList.remove(hidden);\n    }\n  }\n\n  handleInputPlaceholder() {\n    const query = gl.DropdownUtils.getSearchQuery();\n    const placeholder = 'Search or filter results...';\n    const currentPlaceholder = this.filteredSearchInput.placeholder;\n\n    if (query.length === 0 && currentPlaceholder !== placeholder) {\n      this.filteredSearchInput.placeholder = placeholder;\n    } else if (query.length > 0 && currentPlaceholder !== '') {\n      this.filteredSearchInput.placeholder = '';\n    }\n  }\n\n  removeSelectedTokenKeydown(e) {\n    // 8 = Backspace Key\n    // 46 = Delete Key\n    if (e.keyCode === 8 || e.keyCode === 46) {\n      this.removeSelectedToken();\n    }\n  }\n\n  removeSelectedToken() {\n    gl.FilteredSearchVisualTokens.removeSelectedToken();\n    this.handleInputPlaceholder();\n    this.toggleClearSearchButton();\n    this.dropdownManager.updateCurrentDropdownOffset();\n  }\n\n  onClearSearch(e) {\n    e.preventDefault();\n    this.clearSearch();\n  }\n\n  clearSearch() {\n    this.filteredSearchInput.value = '';\n\n    const removeElements = [];\n\n    [].forEach.call(this.tokensContainer.children, (t) => {\n      if (t.classList.contains('js-visual-token')) {\n        removeElements.push(t);\n      }\n    });\n\n    removeElements.forEach((el) => {\n      el.parentElement.removeChild(el);\n    });\n\n    this.clearSearchButton.classList.add('hidden');\n    this.handleInputPlaceholder();\n\n    this.dropdownManager.resetDropdowns();\n\n    if (this.isHandledAsync) {\n      this.search();\n    }\n  }\n\n  handleInputVisualToken() {\n    const input = this.filteredSearchInput;\n    const { tokens, searchToken }\n      = this.tokenizer.processTokens(input.value, this.filteredSearchTokenKeys.getKeys());\n    const { isLastVisualTokenValid }\n      = gl.FilteredSearchVisualTokens.getLastVisualTokenBeforeInput();\n\n    if (isLastVisualTokenValid) {\n      tokens.forEach((t) => {\n        input.value = input.value.replace(`${t.key}:${t.symbol}${t.value}`, '');\n        gl.FilteredSearchVisualTokens.addFilterVisualToken(t.key, `${t.symbol}${t.value}`);\n      });\n\n      const fragments = searchToken.split(':');\n      if (fragments.length > 1) {\n        const inputValues = fragments[0].split(' ');\n        const tokenKey = inputValues.last();\n\n        if (inputValues.length > 1) {\n          inputValues.pop();\n          const searchTerms = inputValues.join(' ');\n\n          input.value = input.value.replace(searchTerms, '');\n          gl.FilteredSearchVisualTokens.addSearchVisualToken(searchTerms);\n        }\n\n        gl.FilteredSearchVisualTokens.addFilterVisualToken(tokenKey);\n        input.value = input.value.replace(`${tokenKey}:`, '');\n      }\n    } else {\n      // Keep listening to token until we determine that the user is done typing the token value\n      const valueCompletedRegex = /([~%@]{0,1}\".+\")|([~%@]{0,1}'.+')|^((?![~%@]')(?![~%@]\")(?!')(?!\")).*/g;\n\n      if (searchToken.match(valueCompletedRegex) && input.value[input.value.length - 1] === ' ') {\n        gl.FilteredSearchVisualTokens.addFilterVisualToken(searchToken);\n\n        // Trim the last space as seen in the if statement above\n        input.value = input.value.replace(searchToken, '').trim();\n      }\n    }\n  }\n\n  handleFormSubmit(e) {\n    e.preventDefault();\n    this.search();\n  }\n\n  saveCurrentSearchQuery() {\n    // Don't save before we have fetched the already saved searches\n    this.fetchingRecentSearchesPromise.then(() => {\n      const searchQuery = gl.DropdownUtils.getSearchQuery();\n      if (searchQuery.length > 0) {\n        const resultantSearches = this.recentSearchesStore.addRecentSearch(searchQuery);\n        this.recentSearchesService.save(resultantSearches);\n      }\n    }).catch(() => {\n      // https://gitlab.com/gitlab-org/gitlab-ce/issues/30821\n    });\n  }\n\n  loadSearchParamsFromURL() {\n    const params = gl.utils.getUrlParamsArray();\n    const usernameParams = this.getUsernameParams();\n    let hasFilteredSearch = false;\n\n    params.forEach((p) => {\n      const split = p.split('=');\n      const keyParam = decodeURIComponent(split[0]);\n      const value = split[1];\n\n      // Check if it matches edge conditions listed in this.filteredSearchTokenKeys\n      const condition = this.filteredSearchTokenKeys.searchByConditionUrl(p);\n\n      if (condition) {\n        hasFilteredSearch = true;\n        const canEdit = this.canEdit && this.canEdit(condition.tokenKey);\n        gl.FilteredSearchVisualTokens.addFilterVisualToken(\n          condition.tokenKey,\n          condition.value,\n          canEdit,\n        );\n      } else {\n        // Sanitize value since URL converts spaces into +\n        // Replace before decode so that we know what was originally + versus the encoded +\n        const sanitizedValue = value ? decodeURIComponent(value.replace(/\\+/g, ' ')) : value;\n        const match = this.filteredSearchTokenKeys.searchByKeyParam(keyParam);\n\n        if (match) {\n          const indexOf = keyParam.indexOf('_');\n          const sanitizedKey = indexOf !== -1 ? keyParam.slice(0, keyParam.indexOf('_')) : keyParam;\n          const symbol = match.symbol;\n          let quotationsToUse = '';\n\n          if (sanitizedValue.indexOf(' ') !== -1) {\n            // Prefer \", but use ' if required\n            quotationsToUse = sanitizedValue.indexOf('\"') === -1 ? '\"' : '\\'';\n          }\n\n          hasFilteredSearch = true;\n          const canEdit = this.canEdit && this.canEdit(sanitizedKey);\n          gl.FilteredSearchVisualTokens.addFilterVisualToken(\n            sanitizedKey,\n            `${symbol}${quotationsToUse}${sanitizedValue}${quotationsToUse}`,\n            canEdit,\n          );\n        } else if (!match && keyParam === 'assignee_id') {\n          const id = parseInt(value, 10);\n          if (usernameParams[id]) {\n            hasFilteredSearch = true;\n            const tokenName = 'assignee';\n            const canEdit = this.canEdit && this.canEdit(tokenName);\n            gl.FilteredSearchVisualTokens.addFilterVisualToken(tokenName, `@${usernameParams[id]}`, canEdit);\n          }\n        } else if (!match && keyParam === 'author_id') {\n          const id = parseInt(value, 10);\n          if (usernameParams[id]) {\n            hasFilteredSearch = true;\n            const tokenName = 'author';\n            const canEdit = this.canEdit && this.canEdit(tokenName);\n            gl.FilteredSearchVisualTokens.addFilterVisualToken(tokenName, `@${usernameParams[id]}`, canEdit);\n          }\n        } else if (!match && keyParam === 'search') {\n          hasFilteredSearch = true;\n          this.filteredSearchInput.value = sanitizedValue;\n        }\n      }\n    });\n\n    this.saveCurrentSearchQuery();\n\n    if (hasFilteredSearch) {\n      this.clearSearchButton.classList.remove('hidden');\n      this.handleInputPlaceholder();\n    }\n  }\n\n  searchState(e) {\n    e.preventDefault();\n    const target = e.currentTarget;\n    // remove focus outline after click\n    target.blur();\n\n    const state = target.dataset && target.dataset.state;\n\n    if (state) {\n      this.search(state);\n    }\n  }\n\n  search(state = null) {\n    const paths = [];\n    const searchQuery = gl.DropdownUtils.getSearchQuery();\n\n    this.saveCurrentSearchQuery();\n\n    const { tokens, searchToken }\n      = this.tokenizer.processTokens(searchQuery, this.filteredSearchTokenKeys.getKeys());\n    const currentState = state || gl.utils.getParameterByName('state') || 'opened';\n    paths.push(`state=${currentState}`);\n\n    tokens.forEach((token) => {\n      const condition = this.filteredSearchTokenKeys\n        .searchByConditionKeyValue(token.key, token.value.toLowerCase());\n      const { param } = this.filteredSearchTokenKeys.searchByKey(token.key) || {};\n      const keyParam = param ? `${token.key}_${param}` : token.key;\n      let tokenPath = '';\n\n      if (condition) {\n        tokenPath = condition.url;\n      } else {\n        let tokenValue = token.value;\n\n        if ((tokenValue[0] === '\\'' && tokenValue[tokenValue.length - 1] === '\\'') ||\n          (tokenValue[0] === '\"' && tokenValue[tokenValue.length - 1] === '\"')) {\n          tokenValue = tokenValue.slice(1, tokenValue.length - 1);\n        }\n\n        tokenPath = `${keyParam}=${encodeURIComponent(tokenValue)}`;\n      }\n\n      paths.push(tokenPath);\n    });\n\n    if (searchToken) {\n      const sanitized = searchToken.split(' ').map(t => encodeURIComponent(t)).join('+');\n      paths.push(`search=${sanitized}`);\n    }\n\n    const parameterizedUrl = `?scope=all&utf8=%E2%9C%93&${paths.join('&')}`;\n\n    if (this.updateObject) {\n      this.updateObject(parameterizedUrl);\n    } else {\n      gl.utils.visitUrl(parameterizedUrl);\n    }\n  }\n\n  getUsernameParams() {\n    const usernamesById = {};\n    try {\n      const attribute = this.filteredSearchInput.getAttribute('data-username-params');\n      JSON.parse(attribute).forEach((user) => {\n        usernamesById[user.id] = user.username;\n      });\n    } catch (e) {\n      // do nothing\n    }\n    return usernamesById;\n  }\n\n  tokenChange() {\n    const dropdown = this.dropdownManager.mapping[this.dropdownManager.currentDropdown];\n\n    if (dropdown) {\n      const currentDropdownRef = dropdown.reference;\n\n      this.setDropdownWrapper();\n      currentDropdownRef.dispatchInputEvent();\n    }\n  }\n\n  onrecentSearchesItemSelected(text) {\n    this.clearSearch();\n    this.filteredSearchInput.value = text;\n    this.filteredSearchInput.dispatchEvent(new CustomEvent('input'));\n    this.search();\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  canEdit() {\n    return true;\n  }\n}\n\nwindow.gl = window.gl || {};\ngl.FilteredSearchManager = FilteredSearchManager;\n\n\n\n// WEBPACK FOOTER //\n// ./filtered_search/filtered_search_manager.js","const tokenKeys = [{\n  key: 'author',\n  type: 'string',\n  param: 'username',\n  symbol: '@',\n  icon: 'pencil',\n}, {\n  key: 'assignee',\n  type: 'string',\n  param: 'username',\n  symbol: '@',\n  icon: 'user',\n}, {\n  key: 'milestone',\n  type: 'string',\n  param: 'title',\n  symbol: '%',\n  icon: 'clock-o',\n}, {\n  key: 'label',\n  type: 'array',\n  param: 'name[]',\n  symbol: '~',\n  icon: 'tag',\n}];\n\nconst alternativeTokenKeys = [{\n  key: 'label',\n  type: 'string',\n  param: 'name',\n  symbol: '~',\n}];\n\nconst tokenKeysWithAlternative = tokenKeys.concat(alternativeTokenKeys);\n\nconst conditions = [{\n  url: 'assignee_id=0',\n  tokenKey: 'assignee',\n  value: 'none',\n}, {\n  url: 'milestone_title=No+Milestone',\n  tokenKey: 'milestone',\n  value: 'none',\n}, {\n  url: 'milestone_title=%23upcoming',\n  tokenKey: 'milestone',\n  value: 'upcoming',\n}, {\n  url: 'milestone_title=%23started',\n  tokenKey: 'milestone',\n  value: 'started',\n}, {\n  url: 'label_name[]=No+Label',\n  tokenKey: 'label',\n  value: 'none',\n}];\n\nclass FilteredSearchTokenKeys {\n  static get() {\n    return tokenKeys;\n  }\n\n  static getKeys() {\n    return tokenKeys.map(i => i.key);\n  }\n\n  static getAlternatives() {\n    return alternativeTokenKeys;\n  }\n\n  static getConditions() {\n    return conditions;\n  }\n\n  static searchByKey(key) {\n    return tokenKeys.find(tokenKey => tokenKey.key === key) || null;\n  }\n\n  static searchBySymbol(symbol) {\n    return tokenKeys.find(tokenKey => tokenKey.symbol === symbol) || null;\n  }\n\n  static searchByKeyParam(keyParam) {\n    return tokenKeysWithAlternative.find((tokenKey) => {\n      let tokenKeyParam = tokenKey.key;\n\n      if (tokenKey.param) {\n        tokenKeyParam += `_${tokenKey.param}`;\n      }\n\n      return keyParam === tokenKeyParam;\n    }) || null;\n  }\n\n  static searchByConditionUrl(url) {\n    return conditions.find(condition => condition.url === url) || null;\n  }\n\n  static searchByConditionKeyValue(key, value) {\n    return conditions\n      .find(condition => condition.tokenKey === key && condition.value === value) || null;\n  }\n}\n\nwindow.gl = window.gl || {};\ngl.FilteredSearchTokenKeys = FilteredSearchTokenKeys;\n\n\n\n// WEBPACK FOOTER //\n// ./filtered_search/filtered_search_token_keys.js","import './filtered_search_token_keys';\n\nclass FilteredSearchTokenizer {\n  static processTokens(input, allowedKeys) {\n    // Regex extracts `(token):(symbol)(value)`\n    // Values that start with a double quote must end in a double quote (same for single)\n    const tokenRegex = new RegExp(`(${allowedKeys.join('|')}):([~%@]?)(?:('[^']*'{0,1})|(\"[^\"]*\"{0,1})|(\\\\S+))`, 'g');\n    const tokens = [];\n    const tokenIndexes = []; // stores key+value for simple search\n    let lastToken = null;\n    const searchToken = input.replace(tokenRegex, (match, key, symbol, v1, v2, v3) => {\n      let tokenValue = v1 || v2 || v3;\n      let tokenSymbol = symbol;\n      let tokenIndex = '';\n\n      if (tokenValue === '~' || tokenValue === '%' || tokenValue === '@') {\n        tokenSymbol = tokenValue;\n        tokenValue = '';\n      }\n\n      tokenIndex = `${key}:${tokenValue}`;\n\n      // Prevent adding duplicates\n      if (tokenIndexes.indexOf(tokenIndex) === -1) {\n        tokenIndexes.push(tokenIndex);\n\n        tokens.push({\n          key,\n          value: tokenValue || '',\n          symbol: tokenSymbol || '',\n        });\n      }\n\n      return '';\n    }).replace(/\\s{2,}/g, ' ').trim() || '';\n\n    if (tokens.length > 0) {\n      const last = tokens[tokens.length - 1];\n      const lastString = `${last.key}:${last.symbol}${last.value}`;\n      lastToken = input.lastIndexOf(lastString) ===\n        input.length - lastString.length ? last : searchToken;\n    } else {\n      lastToken = searchToken;\n    }\n\n    return {\n      tokens,\n      lastToken,\n      searchToken,\n    };\n  }\n}\n\nwindow.gl = window.gl || {};\ngl.FilteredSearchTokenizer = FilteredSearchTokenizer;\n\n\n\n// WEBPACK FOOTER //\n// ./filtered_search/filtered_search_tokenizer.js","import AjaxCache from '../lib/utils/ajax_cache';\nimport '../flash'; /* global Flash */\nimport FilteredSearchContainer from './container';\nimport UsersCache from '../lib/utils/users_cache';\n\nclass FilteredSearchVisualTokens {\n  static getLastVisualTokenBeforeInput() {\n    const inputLi = FilteredSearchContainer.container.querySelector('.input-token');\n    const lastVisualToken = inputLi && inputLi.previousElementSibling;\n\n    return {\n      lastVisualToken,\n      isLastVisualTokenValid: lastVisualToken === null || lastVisualToken.className.indexOf('filtered-search-term') !== -1 || (lastVisualToken && lastVisualToken.querySelector('.value') !== null),\n    };\n  }\n\n  static unselectTokens() {\n    const otherTokens = FilteredSearchContainer.container.querySelectorAll('.js-visual-token .selectable.selected');\n    [].forEach.call(otherTokens, t => t.classList.remove('selected'));\n  }\n\n  static selectToken(tokenButton, forceSelection = false) {\n    const selected = tokenButton.classList.contains('selected');\n    FilteredSearchVisualTokens.unselectTokens();\n\n    if (!selected || forceSelection) {\n      tokenButton.classList.add('selected');\n    }\n  }\n\n  static removeSelectedToken() {\n    const selected = FilteredSearchContainer.container.querySelector('.js-visual-token .selected');\n\n    if (selected) {\n      const li = selected.closest('.js-visual-token');\n      li.parentElement.removeChild(li);\n    }\n  }\n\n  static createVisualTokenElementHTML(canEdit = true) {\n    let removeTokenMarkup = '';\n    if (canEdit) {\n      removeTokenMarkup = `\n        <div class=\"remove-token\" role=\"button\">\n          <i class=\"fa fa-close\"></i>\n        </div>\n      `;\n    }\n\n    return `\n      <div class=\"selectable\" role=\"button\">\n        <div class=\"name\"></div>\n        <div class=\"value-container\">\n          <div class=\"value\"></div>\n          ${removeTokenMarkup}\n        </div>\n      </div>\n    `;\n  }\n\n  static updateLabelTokenColor(tokenValueContainer, tokenValue) {\n    const filteredSearchInput = FilteredSearchContainer.container.querySelector('.filtered-search');\n    const baseEndpoint = filteredSearchInput.dataset.baseEndpoint;\n    const labelsEndpoint = `${baseEndpoint}/labels.json`;\n\n    return AjaxCache.retrieve(labelsEndpoint)\n    .then((labels) => {\n      const matchingLabel = (labels || []).find(label => `~${gl.DropdownUtils.getEscapedText(label.title)}` === tokenValue);\n\n      if (!matchingLabel) {\n        return;\n      }\n\n      const tokenValueStyle = tokenValueContainer.style;\n      tokenValueStyle.backgroundColor = matchingLabel.color;\n      tokenValueStyle.color = matchingLabel.text_color;\n\n      if (matchingLabel.text_color === '#FFFFFF') {\n        const removeToken = tokenValueContainer.querySelector('.remove-token');\n        removeToken.classList.add('inverted');\n      }\n    })\n    .catch(() => new Flash('An error occurred while fetching label colors.'));\n  }\n\n  static updateUserTokenAppearance(tokenValueContainer, tokenValueElement, tokenValue) {\n    if (tokenValue === 'none') {\n      return Promise.resolve();\n    }\n\n    const username = tokenValue.replace(/^@/, '');\n    return UsersCache.retrieve(username)\n      .then((user) => {\n        if (!user) {\n          return;\n        }\n\n        /* eslint-disable no-param-reassign */\n        tokenValueContainer.dataset.originalValue = tokenValue;\n        tokenValueElement.innerHTML = `\n          <img class=\"avatar s20\" src=\"${user.avatar_url}\" alt=\"${user.name}'s avatar\">\n          ${user.name}\n        `;\n        /* eslint-enable no-param-reassign */\n      })\n      // ignore error and leave username in the search bar\n      .catch(() => { });\n  }\n\n  static renderVisualTokenValue(parentElement, tokenName, tokenValue) {\n    const tokenValueContainer = parentElement.querySelector('.value-container');\n    const tokenValueElement = tokenValueContainer.querySelector('.value');\n    tokenValueElement.innerText = tokenValue;\n\n    const tokenType = tokenName.toLowerCase();\n    if (tokenType === 'label') {\n      FilteredSearchVisualTokens.updateLabelTokenColor(tokenValueContainer, tokenValue);\n    } else if ((tokenType === 'author') || (tokenType === 'assignee')) {\n      FilteredSearchVisualTokens.updateUserTokenAppearance(\n        tokenValueContainer, tokenValueElement, tokenValue,\n      );\n    }\n  }\n\n  static addVisualTokenElement(name, value, isSearchTerm, canEdit) {\n    const li = document.createElement('li');\n    li.classList.add('js-visual-token');\n    li.classList.add(isSearchTerm ? 'filtered-search-term' : 'filtered-search-token');\n\n    if (value) {\n      li.innerHTML = FilteredSearchVisualTokens.createVisualTokenElementHTML(canEdit);\n      FilteredSearchVisualTokens.renderVisualTokenValue(li, name, value);\n    } else {\n      li.innerHTML = '<div class=\"name\"></div>';\n    }\n    li.querySelector('.name').innerText = name;\n\n    const tokensContainer = FilteredSearchContainer.container.querySelector('.tokens-container');\n    const input = FilteredSearchContainer.container.querySelector('.filtered-search');\n    tokensContainer.insertBefore(li, input.parentElement);\n  }\n\n  static addValueToPreviousVisualTokenElement(value) {\n    const { lastVisualToken, isLastVisualTokenValid } =\n      FilteredSearchVisualTokens.getLastVisualTokenBeforeInput();\n\n    if (!isLastVisualTokenValid && lastVisualToken.classList.contains('filtered-search-token')) {\n      const name = FilteredSearchVisualTokens.getLastTokenPartial();\n      lastVisualToken.innerHTML = FilteredSearchVisualTokens.createVisualTokenElementHTML();\n      lastVisualToken.querySelector('.name').innerText = name;\n      FilteredSearchVisualTokens.renderVisualTokenValue(lastVisualToken, name, value);\n    }\n  }\n\n  static addFilterVisualToken(tokenName, tokenValue, canEdit) {\n    const { lastVisualToken, isLastVisualTokenValid }\n      = FilteredSearchVisualTokens.getLastVisualTokenBeforeInput();\n    const addVisualTokenElement = FilteredSearchVisualTokens.addVisualTokenElement;\n\n    if (isLastVisualTokenValid) {\n      addVisualTokenElement(tokenName, tokenValue, false, canEdit);\n    } else {\n      const previousTokenName = lastVisualToken.querySelector('.name').innerText;\n      const tokensContainer = FilteredSearchContainer.container.querySelector('.tokens-container');\n      tokensContainer.removeChild(lastVisualToken);\n\n      const value = tokenValue || tokenName;\n      addVisualTokenElement(previousTokenName, value, false, canEdit);\n    }\n  }\n\n  static addSearchVisualToken(searchTerm) {\n    const { lastVisualToken } = FilteredSearchVisualTokens.getLastVisualTokenBeforeInput();\n\n    if (lastVisualToken && lastVisualToken.classList.contains('filtered-search-term')) {\n      lastVisualToken.querySelector('.name').innerText += ` ${searchTerm}`;\n    } else {\n      FilteredSearchVisualTokens.addVisualTokenElement(searchTerm, null, true);\n    }\n  }\n\n  static getLastTokenPartial() {\n    const { lastVisualToken } = FilteredSearchVisualTokens.getLastVisualTokenBeforeInput();\n\n    if (!lastVisualToken) return '';\n\n    const valueContainer = lastVisualToken.querySelector('.value-container');\n    const originalValue = valueContainer && valueContainer.dataset.originalValue;\n    if (originalValue) {\n      return originalValue;\n    }\n\n    const value = lastVisualToken.querySelector('.value');\n    const name = lastVisualToken.querySelector('.name');\n\n    const valueText = value ? value.innerText : '';\n    const nameText = name ? name.innerText : '';\n\n    return valueText || nameText;\n  }\n\n  static removeLastTokenPartial() {\n    const { lastVisualToken } = FilteredSearchVisualTokens.getLastVisualTokenBeforeInput();\n\n    if (lastVisualToken) {\n      const value = lastVisualToken.querySelector('.value');\n\n      if (value) {\n        const button = lastVisualToken.querySelector('.selectable');\n        const valueContainer = lastVisualToken.querySelector('.value-container');\n        button.removeChild(valueContainer);\n        lastVisualToken.innerHTML = button.innerHTML;\n      } else {\n        lastVisualToken.closest('.tokens-container').removeChild(lastVisualToken);\n      }\n    }\n  }\n\n  static tokenizeInput() {\n    const input = FilteredSearchContainer.container.querySelector('.filtered-search');\n    const { isLastVisualTokenValid } =\n      gl.FilteredSearchVisualTokens.getLastVisualTokenBeforeInput();\n\n    if (input.value) {\n      if (isLastVisualTokenValid) {\n        gl.FilteredSearchVisualTokens.addSearchVisualToken(input.value);\n      } else {\n        FilteredSearchVisualTokens.addValueToPreviousVisualTokenElement(input.value);\n      }\n\n      input.value = '';\n    }\n  }\n\n  static editToken(token) {\n    const input = FilteredSearchContainer.container.querySelector('.filtered-search');\n\n    FilteredSearchVisualTokens.tokenizeInput();\n\n    // Replace token with input field\n    const tokenContainer = token.parentElement;\n    const inputLi = input.parentElement;\n    tokenContainer.replaceChild(inputLi, token);\n\n    const nameElement = token.querySelector('.name');\n    let value;\n\n    if (token.classList.contains('filtered-search-token')) {\n      FilteredSearchVisualTokens.addFilterVisualToken(nameElement.innerText);\n\n      const valueContainerElement = token.querySelector('.value-container');\n      value = valueContainerElement.dataset.originalValue;\n\n      if (!value) {\n        const valueElement = valueContainerElement.querySelector('.value');\n        value = valueElement.innerText;\n      }\n    }\n\n    // token is a search term\n    if (!value) {\n      value = nameElement.innerText;\n    }\n\n    input.value = value;\n\n    // Opens dropdown\n    const inputEvent = new Event('input');\n    input.dispatchEvent(inputEvent);\n\n    // Adds cursor to input\n    input.focus();\n  }\n\n  static moveInputToTheRight() {\n    const input = FilteredSearchContainer.container.querySelector('.filtered-search');\n\n    if (!input) return;\n\n    const inputLi = input.parentElement;\n    const tokenContainer = FilteredSearchContainer.container.querySelector('.tokens-container');\n\n    FilteredSearchVisualTokens.tokenizeInput();\n\n    if (!tokenContainer.lastElementChild.isEqualNode(inputLi)) {\n      const { isLastVisualTokenValid } =\n        gl.FilteredSearchVisualTokens.getLastVisualTokenBeforeInput();\n\n      if (!isLastVisualTokenValid) {\n        const lastPartial = gl.FilteredSearchVisualTokens.getLastTokenPartial();\n        gl.FilteredSearchVisualTokens.removeLastTokenPartial();\n        gl.FilteredSearchVisualTokens.addSearchVisualToken(lastPartial);\n      }\n\n      tokenContainer.removeChild(inputLi);\n      tokenContainer.appendChild(inputLi);\n    }\n  }\n}\n\nwindow.gl = window.gl || {};\ngl.FilteredSearchVisualTokens = FilteredSearchVisualTokens;\n\n\n\n// WEBPACK FOOTER //\n// ./filtered_search/filtered_search_visual_tokens.js","import Vue from 'vue';\nimport RecentSearchesDropdownContent from './components/recent_searches_dropdown_content';\nimport eventHub from './event_hub';\n\nclass RecentSearchesRoot {\n  constructor(\n    recentSearchesStore,\n    recentSearchesService,\n    wrapperElement,\n  ) {\n    this.store = recentSearchesStore;\n    this.service = recentSearchesService;\n    this.wrapperElement = wrapperElement;\n  }\n\n  init() {\n    this.bindEvents();\n    this.render();\n  }\n\n  bindEvents() {\n    this.onRequestClearRecentSearchesWrapper = this.onRequestClearRecentSearches.bind(this);\n\n    eventHub.$on('requestClearRecentSearches', this.onRequestClearRecentSearchesWrapper);\n  }\n\n  unbindEvents() {\n    eventHub.$off('requestClearRecentSearches', this.onRequestClearRecentSearchesWrapper);\n  }\n\n  render() {\n    const state = this.store.state;\n    this.vm = new Vue({\n      el: this.wrapperElement,\n      data() { return state; },\n      template: `\n        <recent-searches-dropdown-content\n          :items=\"recentSearches\"\n          :is-local-storage-available=\"isLocalStorageAvailable\"\n          :allowed-keys=\"allowedKeys\"\n          />\n      `,\n      components: {\n        'recent-searches-dropdown-content': RecentSearchesDropdownContent,\n      },\n    });\n  }\n\n  onRequestClearRecentSearches() {\n    const resultantSearches = this.store.setRecentSearches([]);\n    this.service.save(resultantSearches);\n  }\n\n  destroy() {\n    this.unbindEvents();\n    if (this.vm) {\n      this.vm.$destroy();\n    }\n  }\n\n}\n\nexport default RecentSearchesRoot;\n\n\n\n// WEBPACK FOOTER //\n// ./filtered_search/recent_searches_root.js","import RecentSearchesServiceError from './recent_searches_service_error';\nimport AccessorUtilities from '../../lib/utils/accessor';\n\nclass RecentSearchesService {\n  constructor(localStorageKey = 'issuable-recent-searches') {\n    this.localStorageKey = localStorageKey;\n  }\n\n  fetch() {\n    if (!RecentSearchesService.isAvailable()) {\n      const error = new RecentSearchesServiceError();\n      return Promise.reject(error);\n    }\n\n    const input = window.localStorage.getItem(this.localStorageKey);\n\n    let searches = [];\n    if (input && input.length > 0) {\n      try {\n        searches = JSON.parse(input);\n      } catch (err) {\n        return Promise.reject(err);\n      }\n    }\n\n    return Promise.resolve(searches);\n  }\n\n  save(searches = []) {\n    if (!RecentSearchesService.isAvailable()) return;\n\n    window.localStorage.setItem(this.localStorageKey, JSON.stringify(searches));\n  }\n\n  static isAvailable() {\n    return AccessorUtilities.isLocalStorageAccessSafe();\n  }\n}\n\nexport default RecentSearchesService;\n\n\n\n// WEBPACK FOOTER //\n// ./filtered_search/services/recent_searches_service.js","class RecentSearchesServiceError {\n  constructor(message) {\n    this.name = 'RecentSearchesServiceError';\n    this.message = message || 'Recent Searches Service is unavailable';\n  }\n}\n\n// Can't use `extends` for builtin prototypes and get true inheritance yet\nRecentSearchesServiceError.prototype = Error.prototype;\n\nexport default RecentSearchesServiceError;\n\n\n\n// WEBPACK FOOTER //\n// ./filtered_search/services/recent_searches_service_error.js","import _ from 'underscore';\n\nclass RecentSearchesStore {\n  constructor(initialState = {}, allowedKeys) {\n    this.state = Object.assign({\n      isLocalStorageAvailable: true,\n      recentSearches: [],\n      allowedKeys,\n    }, initialState);\n  }\n\n  addRecentSearch(newSearch) {\n    this.setRecentSearches([newSearch].concat(this.state.recentSearches));\n\n    return this.state.recentSearches;\n  }\n\n  setRecentSearches(searches = []) {\n    const trimmedSearches = searches.map(search => search.trim());\n    this.state.recentSearches = _.uniq(trimmedSearches).slice(0, 5);\n    return this.state.recentSearches;\n  }\n}\n\nexport default RecentSearchesStore;\n\n\n\n// WEBPACK FOOTER //\n// ./filtered_search/stores/recent_searches_store.js","import Api from '../../api';\nimport Cache from './cache';\n\nclass UsersCache extends Cache {\n  retrieve(username) {\n    if (this.hasData(username)) {\n      return Promise.resolve(this.get(username));\n    }\n\n    return Api.users('', { username })\n      .then((users) => {\n        if (!users.length) {\n          throw new Error(`User \"${username}\" could not be found!`);\n        }\n\n        if (users.length > 1) {\n          throw new Error(`Expected username \"${username}\" to be unique!`);\n        }\n\n        const user = users[0];\n        this.internalStorage[username] = user;\n        return user;\n      });\n      // missing catch is intentional, error handling depends on use case\n  }\n}\n\nexport default new UsersCache();\n\n\n\n// WEBPACK FOOTER //\n// ./lib/utils/users_cache.js"],"sourceRoot":""}