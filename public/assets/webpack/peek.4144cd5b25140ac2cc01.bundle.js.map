{"version":3,"sources":["webpack:///peek.4144cd5b25140ac2cc01.bundle.js","webpack:////var/cache/omnibus/src/gitlab-rails/vendor/assets/javascripts/peek.js","webpack:////var/cache/omnibus/src/gitlab-rails/vendor/assets/javascripts/peek.performance_bar.js","webpack:///./peek.js"],"names":["webpackJsonp","../../../vendor/assets/javascripts/peek.js","module","exports","__webpack_require__","jQuery","$","fetchRequestResults","getRequestId","peekEnabled","toggleBar","updatePerformanceBar","data","length","results","table","tr","duration_td","sql_td","strong","Object","keys","forEach","key","label","document","createElement","i","append","appendChild","createTextNode","className","html","text","trigger","event","wrapper","target","is","which","metaKey","hasClass","removeClass","cookie","addClass","ajax","request_id","success","textStatus","xhr","error","on","this","call","../../../vendor/assets/javascripts/peek.performance_bar.js","PerformanceBar","ajaxStart","renderPerformanceBar","updateStatus","options","k","v","el","width","timing","window","performance","prototype","appInfo","formatTime","value","toFixed","render","serverTime","networkTime","perfNetworkTime","empty","addBar","responseEnd","requestStart","isLoaded","domInteractive","start","navigationStart","end","total","name","color","info","bar","left","offset","time","title","mapH","data-title","data-toggle","data-container","css","background","resp","span","Math","round","timeStamp","ajaxEnd","parseInt","getResponseHeader","setTimeout","now","tech","Date","getTime","domLoading","fn","pjax","remove","./peek.js","__webpack_exports__","defineProperty","__WEBPACK_IMPORTED_MODULE_0_vendor_peek__","__WEBPACK_IMPORTED_MODULE_1_vendor_peek_performance_bar__","n","e","preventDefault","hide","$modal","modal","parents","find","toggle"],"mappings":"AAAAA,cAAc,SAERC,6CACA,SAAUC,EAAQC,EAASC,ICHjC,SAAAC,IAAA,SAAAC,GACA,GAAAC,GAAAC,EAAAC,EAAAC,EAAAC,CACAH,GAAA,WACA,MAAAF,GAAA,SAAAM,KAAA,eAEAH,EAAA,WACA,MAAAH,GAAA,SAAAO,QAEAF,EAAA,SAAAG,GACA,GAAAF,GAAAG,EAAAC,EAAAC,EAAAC,EAAAC,CAgCA,OA9BAC,QAAAC,KAAAP,EAAAF,MAAAU,QAAA,SAAAC,GACAH,OAAAC,KAAAP,EAAAF,KAAAW,IAAAD,QAAA,SAAAE,GAGA,GAFAZ,EAAAE,EAAAF,KAAAW,GAAAC,GAEA,WAAAA,EAAA,CACAT,EAAAU,SAAAC,cAAA,QAEA,QAAAC,GAAA,EAAyBA,EAAAf,EAAAC,OAAiBc,GAAA,EAC1CX,EAAAS,SAAAC,cAAA,MACAT,EAAAQ,SAAAC,cAAA,MACAR,EAAAO,SAAAC,cAAA,MACAP,EAAAM,SAAAC,cAAA,UAEAP,EAAAS,OAAAhB,EAAAe,GAAA,eACAV,EAAAY,YAAAV,GACAH,EAAAa,YAAAZ,GAEAC,EAAAW,YAAAJ,SAAAK,eAAAlB,EAAAe,GAAA,MACAX,EAAAa,YAAAX,GAEAH,EAAAc,YAAAb,EAGAD,GAAAgB,UAAA,QACAzB,EAAA,kBAAAiB,EAAA,IAAAC,EAAA,KAAAQ,KAAAjB,OAEAT,GAAA,kBAAAiB,EAAA,IAAAC,EAAA,KAAAS,KAAAnB,EAAAF,KAAAW,GAAAC,QAIAlB,EAAAmB,UAAAS,QAAA,eAAA1B,IAAAM,KAEAJ,EAAA,SAAAyB,GACA,GAAAC,EACA,KAAA9B,EAAA6B,EAAAE,QAAAC,GAAA,UAGA,YAAAH,EAAAI,OAAAJ,EAAAK,YAAA,IACAJ,EAAA9B,EAAA,SACA8B,EAAAK,SAAA,aACAL,EAAAM,YAAA,YACAjB,SAAAkB,OAAA,sBAEAP,EAAAQ,SAAA,YACAnB,SAAAkB,OAAA,wBAIApC,EAAA,WACA,MAAAD,GAAAuC,KAAA,mBACAjC,MACAkC,WAAAtC,KAEAuC,QAAA,SAAAnC,EAAAoC,EAAAC,GACA,MAAAtC,GAAAC,IAEAsC,MAAA,SAAAD,EAAAD,EAAAE,QAGA5C,EAAAmB,UAAA0B,GAAA,WAAAzC,GACAJ,EAAAmB,UAAA0B,GAAA,cAAA5C,GACAD,EAAA,WACA,GAAAG,IACA,MAAAH,GAAA8C,MAAAlB,QAAA,kBAGC7B,KDO4BgD,KAAKlD,EAASC,EAAoB,iDAIzDkD,6DACA,SAAUpD,EAAQC,EAASC,IEzFjC,SAAAE,GAAA,GAAAiD,GAAAC,EAAAC,EAAAC,CAEAH,GAAA,WAaA,QAAAA,GAAAI,GACA,GAAAC,GAAAC,CACA,OAAAF,IACAA,MAEAP,KAAAU,GAAAxD,EAAA,8CACA,KAAAsD,IAAAD,GACAE,EAAAF,EAAAC,GACAR,KAAAQ,GAAAC,CAEA,OAAAT,KAAAW,QACAX,KAAAW,MAAAX,KAAAU,GAAAC,SAEA,MAAAX,KAAAY,SACAZ,KAAAY,OAAAC,OAAAC,YAAAF,QA0EA,MApGAT,GAAAY,UAAAC,QAAA,KAEAb,EAAAY,UAAAJ,MAAA,KAEAR,EAAAc,WAAA,SAAAC,GACA,MAAAA,IAAA,KACAA,EAAA,KAAAC,QAAA,OAEAD,EAAAC,QAAA,SAsBAhB,EAAAY,UAAAK,OAAA,SAAAC,GACA,GAAAC,GAAAC,CAiBA,OAhBA,OAAAF,IACAA,EAAA,GAEArB,KAAAU,GAAAc,QACAxB,KAAAyB,OAAA,oDACAF,EAAAvB,KAAAY,OAAAc,YAAA1B,KAAAY,OAAAe,aACAN,MAAAE,GACAD,EAAAC,EAAAF,EACArB,KAAAyB,OAAA,gCAAAzB,KAAAY,OAAAe,aAAAN,EAAArB,KAAAY,OAAAe,aAAAN,EAAAC,GACAtB,KAAAyB,OAAA,gBAAAzB,KAAAY,OAAAe,aAAA3B,KAAAY,OAAAe,aAAAN,EAAArB,KAAAgB,UAEAhB,KAAAyB,OAAA,kDAEAzB,KAAAyB,OAAA,mDACAzB,KAAAyB,OAAA,oDACAzB,KAAAyB,OAAA,uDACAzB,KAAAU,IAGAP,EAAAY,UAAAa,SAAA,WACA,MAAA5B,MAAAY,OAAAiB,gBAGA1B,EAAAY,UAAAe,MAAA,WACA,MAAA9B,MAAAY,OAAAmB,iBAGA5B,EAAAY,UAAAiB,IAAA,WACA,MAAAhC,MAAAY,OAAAiB,gBAGA1B,EAAAY,UAAAkB,MAAA,WACA,MAAAjC,MAAAgC,MAAAhC,KAAA8B,SAGA3B,EAAAY,UAAAU,OAAA,SAAAS,EAAAC,EAAAL,EAAAE,EAAAI,GACA,GAAAC,GAAAC,EAAAC,EAAAC,EAAAC,EAAA9B,CAOA,IANA,gBAAAmB,KACAA,EAAA9B,KAAAY,OAAAkB,IAEA,gBAAAE,KACAA,EAAAhC,KAAAY,OAAAoB,IAEA,MAAAF,GAAA,MAAAE,EAkBA,MAfAQ,GAAAR,EAAAF,EACAS,EAAAT,EAAA9B,KAAA8B,QACAQ,EAAAtC,KAAA0C,KAAAH,GACA5B,EAAAX,KAAA0C,KAAAF,GACAC,EAAAP,EAAA,KAAA/B,EAAAc,WAAAuB,GACAH,EAAAnF,EAAA,aACAyF,aAAAF,EACAG,cAAA,UACAC,iBAAA,SAEAR,EAAAS,KACAnC,QAAA,KACA2B,OAAA,KACAS,WAAAZ,IAEAnC,KAAAU,GAAAlC,OAAA6D,IAGAlC,EAAAY,UAAA2B,KAAA,SAAAH,GACA,MAAAA,IAAAvC,KAAAW,MAAAX,KAAAiC,UAGA9B,KAIAE,EAAA,WACA,GAAAgC,GAAAW,EAAAC,EAAAT,CAUA,OATAQ,GAAA9F,EAAA,8BACAsF,EAAAU,KAAAC,MAAA,IAAAH,EAAAxF,KAAA,SACA6E,EAAA,GAAAlC,GACAkC,EAAAjB,OAAAoB,GACAS,EAAA/F,EAAA,UACA0F,cAAA,UACAD,aAAA,uCACAE,iBAAA,SACGhE,KAAAsB,EAAAc,WAAAoB,EAAAJ,UACH3B,EAAA2C,IAGA3C,EAAA,SAAA1B,GACA,MAAA1B,GAAA,gBAAA0B,SAGAwB,EAAA,KAEAlD,EAAAmB,UAAA0B,GAAA,0DAAAhB,GACA,MAAAqB,GAAArB,EAAAqE,YAGAlG,EAAAmB,UAAA0B,GAAA,8CAAAhB,EAAAc,GACA,GAAAwD,GAAAhC,EAAAY,CACA,UAAA7B,EAMA,MAHAiD,GAAAtE,EAAAqE,UACAnB,EAAAoB,EAAAjD,EACAiB,EAAAxB,EAAAyD,SAAAzD,EAAA0D,kBAAA,gBACAC,WAAA,WACA,GAAAnB,GAAAoB,EAAAR,EAAAS,CA+BA,OA9BAD,IAAA,GAAAE,OAAAC,UACAvB,EAAA,GAAAlC,IACAS,QACAe,aAAAvB,EACAsB,YAAA2B,EACAQ,WAAAR,EACAxB,eAAA4B,GAEA7B,SAAA,WACA,UAEAE,MAAA,WACA,MAAA1B,IAEA4B,IAAA,WACA,MAAAyB,MAGApB,EAAAjB,OAAAC,GAEAqC,EADA,MAAAxG,EAAA4G,GAAAC,KACA,OAEA,aAEAd,EAAA/F,EAAA,UACA0F,cAAA,UACAD,aAAAe,EAAA,mBACAb,iBAAA,SACKhE,KAAAsB,EAAAc,WAAAgB,IACL3B,EAAA2C,GACA7C,EAAA,MACG,KAGHlD,EAAA,WACA,MAAA2D,QAAAC,YACAT,IAEAnD,EAAA,8BAAA8G,aF+F6B/D,KAAKlD,EAASC,EAAoB,iDAIzDiH,YACA,SAAUnH,EAAQoH,EAAqBlH,GAE7C,YACAgB,QAAOmG,eAAeD,EAAqB,cAAgBhD,OAAO,IACtC,SAAShE,GAAyB,GAAIkH,GAA4CpH,EAAoB,8CAEzGqH,GADoDrH,EAAoBsH,EAAEF,GACdpH,EAAoB,8DACZA,GAAoBsH,EAAED,EG3RnHnH,GAAEmB,UAAU0B,GAAG,QAAS,qBAAsB,SAACwE,GAC7CA,EAAEC,iBACFtH,EAAE,0BAA0BuH,MAC5B,IAAMC,GAASxH,EAAE,yBACbwH,GAAOjH,QACTiH,EAAOC,MAAM,YAIjBzH,EAAEmB,UAAU0B,GAAG,QAAS,oBAAqB,SAACwE,GAC5CA,EAAEC,iBACFtH,EAAEqH,EAAEtF,QAAQ2F,QAAQ,yBAAyBC,KAAK,SAASC,YHiShC7E,KAAKiE,EAAqBlH,EAAoB,mDAIxE","file":"peek.4144cd5b25140ac2cc01.bundle.js","sourcesContent":["webpackJsonp([\"peek\"],{\n\n/***/ \"../../../vendor/assets/javascripts/peek.js\":\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(jQuery) {(function($) {\n  var fetchRequestResults, getRequestId, peekEnabled, toggleBar, updatePerformanceBar;\n  getRequestId = function() {\n    return $('#peek').data('request-id');\n  };\n  peekEnabled = function() {\n    return $('#peek').length;\n  };\n  updatePerformanceBar = function(results) {\n    var key, label, data, table, html, tr, duration_td, sql_td, strong;\n\n    Object.keys(results.data).forEach(function(key) {\n      Object.keys(results.data[key]).forEach(function(label) {\n        data = results.data[key][label];\n\n        if (label == 'queries') {\n          table = document.createElement('table');\n\n          for (var i = 0; i < data.length; i += 1) {\n            tr = document.createElement('tr');\n            duration_td = document.createElement('td');\n            sql_td = document.createElement('td');\n            strong = document.createElement('strong');\n\n            strong.append(data[i]['duration'] + 'ms');\n            duration_td.appendChild(strong);\n            tr.appendChild(duration_td);\n\n            sql_td.appendChild(document.createTextNode(data[i]['sql']));\n            tr.appendChild(sql_td);\n\n            table.appendChild(tr);\n          }\n\n          table.className = 'table';\n          $(\"[data-defer-to=\" + key + \"-\" + label + \"]\").html(table);\n        } else {\n          $(\"[data-defer-to=\" + key + \"-\" + label + \"]\").text(results.data[key][label]);\n        }\n      });\n    });\n    return $(document).trigger('peek:render', [getRequestId(), results]);\n  };\n  toggleBar = function(event) {\n    var wrapper;\n    if ($(event.target).is(':input')) {\n      return;\n    }\n    if (event.which === 96 && !event.metaKey) {\n      wrapper = $('#peek');\n      if (wrapper.hasClass('disabled')) {\n        wrapper.removeClass('disabled');\n        return document.cookie = \"peek=true; path=/\";\n      } else {\n        wrapper.addClass('disabled');\n        return document.cookie = \"peek=false; path=/\";\n      }\n    }\n  };\n  fetchRequestResults = function() {\n    return $.ajax('/-/peek/results', {\n      data: {\n        request_id: getRequestId()\n      },\n      success: function(data, textStatus, xhr) {\n        return updatePerformanceBar(data);\n      },\n      error: function(xhr, textStatus, error) {}\n    });\n  };\n  $(document).on('keypress', toggleBar);\n  $(document).on('peek:update', fetchRequestResults);\n  return $(function() {\n    if (peekEnabled()) {\n      return $(this).trigger('peek:update');\n    }\n  });\n})(jQuery);\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(\"../../../node_modules/jquery/dist/jquery.js\")))\n\n/***/ }),\n\n/***/ \"../../../vendor/assets/javascripts/peek.performance_bar.js\":\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function($) {var PerformanceBar, ajaxStart, renderPerformanceBar, updateStatus;\n\nPerformanceBar = (function() {\n  PerformanceBar.prototype.appInfo = null;\n\n  PerformanceBar.prototype.width = null;\n\n  PerformanceBar.formatTime = function(value) {\n    if (value >= 1000) {\n      return ((value / 1000).toFixed(3)) + \"s\";\n    } else {\n      return (value.toFixed(0)) + \"ms\";\n    }\n  };\n\n  function PerformanceBar(options) {\n    var k, v;\n    if (options == null) {\n      options = {};\n    }\n    this.el = $('#peek-view-performance-bar .performance-bar');\n    for (k in options) {\n      v = options[k];\n      this[k] = v;\n    }\n    if (this.width == null) {\n      this.width = this.el.width();\n    }\n    if (this.timing == null) {\n      this.timing = window.performance.timing;\n    }\n  }\n\n  PerformanceBar.prototype.render = function(serverTime) {\n    var networkTime, perfNetworkTime;\n    if (serverTime == null) {\n      serverTime = 0;\n    }\n    this.el.empty();\n    this.addBar('frontend', '#90d35b', 'domLoading', 'domInteractive');\n    perfNetworkTime = this.timing.responseEnd - this.timing.requestStart;\n    if (serverTime && serverTime <= perfNetworkTime) {\n      networkTime = perfNetworkTime - serverTime;\n      this.addBar('latency / receiving', '#f1faff', this.timing.requestStart + serverTime, this.timing.requestStart + serverTime + networkTime);\n      this.addBar('app', '#90afcf', this.timing.requestStart, this.timing.requestStart + serverTime, this.appInfo);\n    } else {\n      this.addBar('backend', '#c1d7ee', 'requestStart', 'responseEnd');\n    }\n    this.addBar('tcp / ssl', '#45688e', 'connectStart', 'connectEnd');\n    this.addBar('redirect', '#0c365e', 'redirectStart', 'redirectEnd');\n    this.addBar('dns', '#082541', 'domainLookupStart', 'domainLookupEnd');\n    return this.el;\n  };\n\n  PerformanceBar.prototype.isLoaded = function() {\n    return this.timing.domInteractive;\n  };\n\n  PerformanceBar.prototype.start = function() {\n    return this.timing.navigationStart;\n  };\n\n  PerformanceBar.prototype.end = function() {\n    return this.timing.domInteractive;\n  };\n\n  PerformanceBar.prototype.total = function() {\n    return this.end() - this.start();\n  };\n\n  PerformanceBar.prototype.addBar = function(name, color, start, end, info) {\n    var bar, left, offset, time, title, width;\n    if (typeof start === 'string') {\n      start = this.timing[start];\n    }\n    if (typeof end === 'string') {\n      end = this.timing[end];\n    }\n    if (!((start != null) && (end != null))) {\n      return;\n    }\n    time = end - start;\n    offset = start - this.start();\n    left = this.mapH(offset);\n    width = this.mapH(time);\n    title = name + \": \" + (PerformanceBar.formatTime(time));\n    bar = $('<li></li>', {\n      'data-title': title,\n      'data-toggle': 'tooltip',\n      'data-container': 'body'\n    });\n    bar.css({\n      width: width + \"px\",\n      left: left + \"px\",\n      background: color\n    });\n    return this.el.append(bar);\n  };\n\n  PerformanceBar.prototype.mapH = function(offset) {\n    return offset * (this.width / this.total());\n  };\n\n  return PerformanceBar;\n\n})();\n\nrenderPerformanceBar = function() {\n  var bar, resp, span, time;\n  resp = $('#peek-server_response_time');\n  time = Math.round(resp.data('time') * 1000);\n  bar = new PerformanceBar;\n  bar.render(time);\n  span = $('<span>', {\n    'data-toggle': 'tooltip',\n    'data-title': 'Total navigation time for this page.',\n    'data-container': 'body'\n  }).text(PerformanceBar.formatTime(bar.total()));\n  return updateStatus(span);\n};\n\nupdateStatus = function(html) {\n  return $('#serverstats').html(html);\n};\n\najaxStart = null;\n\n$(document).on('pjax:start page:fetch turbolinks:request-start', function(event) {\n  return ajaxStart = event.timeStamp;\n});\n\n$(document).on('pjax:end page:load turbolinks:load', function(event, xhr) {\n  var ajaxEnd, serverTime, total;\n  if (ajaxStart == null) {\n    return;\n  }\n  ajaxEnd = event.timeStamp;\n  total = ajaxEnd - ajaxStart;\n  serverTime = xhr ? parseInt(xhr.getResponseHeader('X-Runtime')) : 0;\n  return setTimeout(function() {\n    var bar, now, span, tech;\n    now = new Date().getTime();\n    bar = new PerformanceBar({\n      timing: {\n        requestStart: ajaxStart,\n        responseEnd: ajaxEnd,\n        domLoading: ajaxEnd,\n        domInteractive: now\n      },\n      isLoaded: function() {\n        return true;\n      },\n      start: function() {\n        return ajaxStart;\n      },\n      end: function() {\n        return now;\n      }\n    });\n    bar.render(serverTime);\n    if ($.fn.pjax != null) {\n      tech = 'PJAX';\n    } else {\n      tech = 'Turbolinks';\n    }\n    span = $('<span>', {\n      'data-toggle': 'tooltip',\n      'data-title': tech + \" navigation time\",\n      'data-container': 'body'\n    }).text(PerformanceBar.formatTime(total));\n    updateStatus(span);\n    return ajaxStart = null;\n  }, 0);\n});\n\n$(function() {\n  if (window.performance) {\n    return renderPerformanceBar();\n  } else {\n    return $('#peek-view-performance-bar').remove();\n  }\n});\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(\"../../../node_modules/jquery/dist/jquery.js\")))\n\n/***/ }),\n\n/***/ \"./peek.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* WEBPACK VAR INJECTION */(function($) {/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_vendor_peek__ = __webpack_require__(\"../../../vendor/assets/javascripts/peek.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_vendor_peek___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_vendor_peek__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_vendor_peek_performance_bar__ = __webpack_require__(\"../../../vendor/assets/javascripts/peek.performance_bar.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_vendor_peek_performance_bar___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_vendor_peek_performance_bar__);\n\n\n\n$(document).on('click', '#peek-show-queries', function (e) {\n  e.preventDefault();\n  $('.peek-rblineprof-modal').hide();\n  var $modal = $('#modal-peek-pg-queries');\n  if ($modal.length) {\n    $modal.modal('toggle');\n  }\n});\n\n$(document).on('click', '.js-lineprof-file', function (e) {\n  e.preventDefault();\n  $(e.target).parents('.peek-rblineprof-file').find('.data').toggle();\n});\n/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(\"../../../node_modules/jquery/dist/jquery.js\")))\n\n/***/ })\n\n},[\"./peek.js\"]);\n\n\n// WEBPACK FOOTER //\n// peek.4144cd5b25140ac2cc01.bundle.js","(function($) {\n  var fetchRequestResults, getRequestId, peekEnabled, toggleBar, updatePerformanceBar;\n  getRequestId = function() {\n    return $('#peek').data('request-id');\n  };\n  peekEnabled = function() {\n    return $('#peek').length;\n  };\n  updatePerformanceBar = function(results) {\n    var key, label, data, table, html, tr, duration_td, sql_td, strong;\n\n    Object.keys(results.data).forEach(function(key) {\n      Object.keys(results.data[key]).forEach(function(label) {\n        data = results.data[key][label];\n\n        if (label == 'queries') {\n          table = document.createElement('table');\n\n          for (var i = 0; i < data.length; i += 1) {\n            tr = document.createElement('tr');\n            duration_td = document.createElement('td');\n            sql_td = document.createElement('td');\n            strong = document.createElement('strong');\n\n            strong.append(data[i]['duration'] + 'ms');\n            duration_td.appendChild(strong);\n            tr.appendChild(duration_td);\n\n            sql_td.appendChild(document.createTextNode(data[i]['sql']));\n            tr.appendChild(sql_td);\n\n            table.appendChild(tr);\n          }\n\n          table.className = 'table';\n          $(\"[data-defer-to=\" + key + \"-\" + label + \"]\").html(table);\n        } else {\n          $(\"[data-defer-to=\" + key + \"-\" + label + \"]\").text(results.data[key][label]);\n        }\n      });\n    });\n    return $(document).trigger('peek:render', [getRequestId(), results]);\n  };\n  toggleBar = function(event) {\n    var wrapper;\n    if ($(event.target).is(':input')) {\n      return;\n    }\n    if (event.which === 96 && !event.metaKey) {\n      wrapper = $('#peek');\n      if (wrapper.hasClass('disabled')) {\n        wrapper.removeClass('disabled');\n        return document.cookie = \"peek=true; path=/\";\n      } else {\n        wrapper.addClass('disabled');\n        return document.cookie = \"peek=false; path=/\";\n      }\n    }\n  };\n  fetchRequestResults = function() {\n    return $.ajax('/-/peek/results', {\n      data: {\n        request_id: getRequestId()\n      },\n      success: function(data, textStatus, xhr) {\n        return updatePerformanceBar(data);\n      },\n      error: function(xhr, textStatus, error) {}\n    });\n  };\n  $(document).on('keypress', toggleBar);\n  $(document).on('peek:update', fetchRequestResults);\n  return $(function() {\n    if (peekEnabled()) {\n      return $(this).trigger('peek:update');\n    }\n  });\n})(jQuery);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /var/cache/omnibus/src/gitlab-rails/vendor/assets/javascripts/peek.js\n// module id = ../../../vendor/assets/javascripts/peek.js\n// module chunks = peek","var PerformanceBar, ajaxStart, renderPerformanceBar, updateStatus;\n\nPerformanceBar = (function() {\n  PerformanceBar.prototype.appInfo = null;\n\n  PerformanceBar.prototype.width = null;\n\n  PerformanceBar.formatTime = function(value) {\n    if (value >= 1000) {\n      return ((value / 1000).toFixed(3)) + \"s\";\n    } else {\n      return (value.toFixed(0)) + \"ms\";\n    }\n  };\n\n  function PerformanceBar(options) {\n    var k, v;\n    if (options == null) {\n      options = {};\n    }\n    this.el = $('#peek-view-performance-bar .performance-bar');\n    for (k in options) {\n      v = options[k];\n      this[k] = v;\n    }\n    if (this.width == null) {\n      this.width = this.el.width();\n    }\n    if (this.timing == null) {\n      this.timing = window.performance.timing;\n    }\n  }\n\n  PerformanceBar.prototype.render = function(serverTime) {\n    var networkTime, perfNetworkTime;\n    if (serverTime == null) {\n      serverTime = 0;\n    }\n    this.el.empty();\n    this.addBar('frontend', '#90d35b', 'domLoading', 'domInteractive');\n    perfNetworkTime = this.timing.responseEnd - this.timing.requestStart;\n    if (serverTime && serverTime <= perfNetworkTime) {\n      networkTime = perfNetworkTime - serverTime;\n      this.addBar('latency / receiving', '#f1faff', this.timing.requestStart + serverTime, this.timing.requestStart + serverTime + networkTime);\n      this.addBar('app', '#90afcf', this.timing.requestStart, this.timing.requestStart + serverTime, this.appInfo);\n    } else {\n      this.addBar('backend', '#c1d7ee', 'requestStart', 'responseEnd');\n    }\n    this.addBar('tcp / ssl', '#45688e', 'connectStart', 'connectEnd');\n    this.addBar('redirect', '#0c365e', 'redirectStart', 'redirectEnd');\n    this.addBar('dns', '#082541', 'domainLookupStart', 'domainLookupEnd');\n    return this.el;\n  };\n\n  PerformanceBar.prototype.isLoaded = function() {\n    return this.timing.domInteractive;\n  };\n\n  PerformanceBar.prototype.start = function() {\n    return this.timing.navigationStart;\n  };\n\n  PerformanceBar.prototype.end = function() {\n    return this.timing.domInteractive;\n  };\n\n  PerformanceBar.prototype.total = function() {\n    return this.end() - this.start();\n  };\n\n  PerformanceBar.prototype.addBar = function(name, color, start, end, info) {\n    var bar, left, offset, time, title, width;\n    if (typeof start === 'string') {\n      start = this.timing[start];\n    }\n    if (typeof end === 'string') {\n      end = this.timing[end];\n    }\n    if (!((start != null) && (end != null))) {\n      return;\n    }\n    time = end - start;\n    offset = start - this.start();\n    left = this.mapH(offset);\n    width = this.mapH(time);\n    title = name + \": \" + (PerformanceBar.formatTime(time));\n    bar = $('<li></li>', {\n      'data-title': title,\n      'data-toggle': 'tooltip',\n      'data-container': 'body'\n    });\n    bar.css({\n      width: width + \"px\",\n      left: left + \"px\",\n      background: color\n    });\n    return this.el.append(bar);\n  };\n\n  PerformanceBar.prototype.mapH = function(offset) {\n    return offset * (this.width / this.total());\n  };\n\n  return PerformanceBar;\n\n})();\n\nrenderPerformanceBar = function() {\n  var bar, resp, span, time;\n  resp = $('#peek-server_response_time');\n  time = Math.round(resp.data('time') * 1000);\n  bar = new PerformanceBar;\n  bar.render(time);\n  span = $('<span>', {\n    'data-toggle': 'tooltip',\n    'data-title': 'Total navigation time for this page.',\n    'data-container': 'body'\n  }).text(PerformanceBar.formatTime(bar.total()));\n  return updateStatus(span);\n};\n\nupdateStatus = function(html) {\n  return $('#serverstats').html(html);\n};\n\najaxStart = null;\n\n$(document).on('pjax:start page:fetch turbolinks:request-start', function(event) {\n  return ajaxStart = event.timeStamp;\n});\n\n$(document).on('pjax:end page:load turbolinks:load', function(event, xhr) {\n  var ajaxEnd, serverTime, total;\n  if (ajaxStart == null) {\n    return;\n  }\n  ajaxEnd = event.timeStamp;\n  total = ajaxEnd - ajaxStart;\n  serverTime = xhr ? parseInt(xhr.getResponseHeader('X-Runtime')) : 0;\n  return setTimeout(function() {\n    var bar, now, span, tech;\n    now = new Date().getTime();\n    bar = new PerformanceBar({\n      timing: {\n        requestStart: ajaxStart,\n        responseEnd: ajaxEnd,\n        domLoading: ajaxEnd,\n        domInteractive: now\n      },\n      isLoaded: function() {\n        return true;\n      },\n      start: function() {\n        return ajaxStart;\n      },\n      end: function() {\n        return now;\n      }\n    });\n    bar.render(serverTime);\n    if ($.fn.pjax != null) {\n      tech = 'PJAX';\n    } else {\n      tech = 'Turbolinks';\n    }\n    span = $('<span>', {\n      'data-toggle': 'tooltip',\n      'data-title': tech + \" navigation time\",\n      'data-container': 'body'\n    }).text(PerformanceBar.formatTime(total));\n    updateStatus(span);\n    return ajaxStart = null;\n  }, 0);\n});\n\n$(function() {\n  if (window.performance) {\n    return renderPerformanceBar();\n  } else {\n    return $('#peek-view-performance-bar').remove();\n  }\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /var/cache/omnibus/src/gitlab-rails/vendor/assets/javascripts/peek.performance_bar.js\n// module id = ../../../vendor/assets/javascripts/peek.performance_bar.js\n// module chunks = peek","import 'vendor/peek';\nimport 'vendor/peek.performance_bar';\n\n$(document).on('click', '#peek-show-queries', (e) => {\n  e.preventDefault();\n  $('.peek-rblineprof-modal').hide();\n  const $modal = $('#modal-peek-pg-queries');\n  if ($modal.length) {\n    $modal.modal('toggle');\n  }\n});\n\n$(document).on('click', '.js-lineprof-file', (e) => {\n  e.preventDefault();\n  $(e.target).parents('.peek-rblineprof-file').find('.data').toggle();\n});\n\n\n\n// WEBPACK FOOTER //\n// ./peek.js"],"sourceRoot":""}