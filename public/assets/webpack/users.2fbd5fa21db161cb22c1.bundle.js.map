{"version":3,"sources":["webpack:///users.2fbd5fa21db161cb22c1.bundle.js","webpack:///./users/calendar.js"],"names":["webpackJsonp","./users/calendar.js","module","__webpack_exports__","__webpack_require__","$","__WEBPACK_IMPORTED_MODULE_0_d3__","__WEBPACK_IMPORTED_MODULE_0_d3___default","n","this","Calendar","timestamps","calendar_activities_path","clickDay","bind","currentSelectedDate","daySpace","daySize","daySizeWithSpace","monthNames","months","timestampsTmp","group","today","Date","setHours","oneYearAgo","setFullYear","getFullYear","days","gl","utils","getDayDifference","i","date","setDate","getDate","day","getDay","count","format","push","colorKey","initColorKey","color","initColor","renderSvg","renderDays","renderMonths","renderDayTitles","renderKey","initTooltips","prototype","getExtraWidthPadding","extraWidthPadding","getMonth","width","svg","a","select","append","attr","selectAll","data","enter","_this","_","each","stamp","lastMonth","lastMonthX","month","x","last","contribText","dateText","getDayName","Math","min","on","text","y","_this2","keyValues","keyColors","colorRange","scale","threshold","domain","range","linear","formatted_date","ajax","url","cache","dataType","beforeSend","html","success","tooltip","call","window","./users/users_bundle.js","Object","defineProperty","value"],"mappings":"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","file":"users.2fbd5fa21db161cb22c1.bundle.js","sourcesContent":["webpackJsonp([\"users\"],{\n\n/***/ \"./users/calendar.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function($) {/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_d3__ = __webpack_require__(\"../../../node_modules/d3/d3.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_d3___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_d3__);\n/* eslint-disable func-names, space-before-function-paren, no-var, prefer-rest-params, wrap-iife, camelcase, vars-on-top, object-shorthand, comma-dangle, eqeqeq, no-mixed-operators, no-return-assign, newline-per-chained-call, prefer-arrow-callback, consistent-return, one-var, one-var-declaration-per-line, prefer-template, quotes, no-unused-vars, no-else-return, max-len */\n\n\n\n(function () {\n  this.Calendar = function () {\n    function Calendar(timestamps, calendar_activities_path) {\n      this.calendar_activities_path = calendar_activities_path;\n      this.clickDay = this.clickDay.bind(this);\n      this.currentSelectedDate = '';\n      this.daySpace = 1;\n      this.daySize = 15;\n      this.daySizeWithSpace = this.daySize + this.daySpace * 2;\n      this.monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n      this.months = [];\n      // Loop through the timestamps to create a group of objects\n      // The group of objects will be grouped based on the day of the week they are\n      this.timestampsTmp = [];\n      var group = 0;\n\n      var today = new Date();\n      today.setHours(0, 0, 0, 0, 0);\n\n      var oneYearAgo = new Date(today);\n      oneYearAgo.setFullYear(today.getFullYear() - 1);\n\n      var days = gl.utils.getDayDifference(oneYearAgo, today);\n\n      for (var i = 0; i <= days; i += 1) {\n        var date = new Date(oneYearAgo);\n        date.setDate(date.getDate() + i);\n\n        var day = date.getDay();\n        var count = timestamps[date.format('yyyy-mm-dd')];\n\n        // Create a new group array if this is the first day of the week\n        // or if is first object\n        if (day === 0 && i !== 0 || i === 0) {\n          this.timestampsTmp.push([]);\n          group += 1;\n        }\n\n        var innerArray = this.timestampsTmp[group - 1];\n        // Push to the inner array the values that will be used to render map\n        innerArray.push({\n          count: count || 0,\n          date: date,\n          day: day\n        });\n      }\n\n      // Init color functions\n      this.colorKey = this.initColorKey();\n      this.color = this.initColor();\n      // Init the svg element\n      this.renderSvg(group);\n      this.renderDays();\n      this.renderMonths();\n      this.renderDayTitles();\n      this.renderKey();\n      this.initTooltips();\n    }\n\n    // Add extra padding for the last month label if it is also the last column\n    Calendar.prototype.getExtraWidthPadding = function (group) {\n      var extraWidthPadding = 0;\n      var lastColMonth = this.timestampsTmp[group - 1][0].date.getMonth();\n      var secondLastColMonth = this.timestampsTmp[group - 2][0].date.getMonth();\n\n      if (lastColMonth != secondLastColMonth) {\n        extraWidthPadding = 3;\n      }\n\n      return extraWidthPadding;\n    };\n\n    Calendar.prototype.renderSvg = function (group) {\n      var width = (group + 1) * this.daySizeWithSpace + this.getExtraWidthPadding(group);\n      return this.svg = __WEBPACK_IMPORTED_MODULE_0_d3___default.a.select('.js-contrib-calendar').append('svg').attr('width', width).attr('height', 167).attr('class', 'contrib-calendar');\n    };\n\n    Calendar.prototype.renderDays = function () {\n      return this.svg.selectAll('g').data(this.timestampsTmp).enter().append('g').attr('transform', function (_this) {\n        return function (group, i) {\n          _.each(group, function (stamp, a) {\n            var lastMonth, lastMonthX, month, x;\n            if (a === 0 && stamp.day === 0) {\n              month = stamp.date.getMonth();\n              x = _this.daySizeWithSpace * i + 1 + _this.daySizeWithSpace;\n              lastMonth = _.last(_this.months);\n              if (lastMonth != null) {\n                lastMonthX = lastMonth.x;\n              }\n              if (lastMonth == null) {\n                return _this.months.push({\n                  month: month,\n                  x: x\n                });\n              } else if (month !== lastMonth.month && x - _this.daySizeWithSpace !== lastMonthX) {\n                return _this.months.push({\n                  month: month,\n                  x: x\n                });\n              }\n            }\n          });\n          return \"translate(\" + (_this.daySizeWithSpace * i + 1 + _this.daySizeWithSpace) + \", 18)\";\n        };\n      }(this)).selectAll('rect').data(function (stamp) {\n        return stamp;\n      }).enter().append('rect').attr('x', '0').attr('y', function (_this) {\n        return function (stamp, i) {\n          return _this.daySizeWithSpace * stamp.day;\n        };\n      }(this)).attr('width', this.daySize).attr('height', this.daySize).attr('title', function (_this) {\n        return function (stamp) {\n          var contribText, date, dateText;\n          date = new Date(stamp.date);\n          contribText = 'No contributions';\n          if (stamp.count > 0) {\n            contribText = stamp.count + \" contribution\" + (stamp.count > 1 ? 's' : '');\n          }\n          dateText = date.format('mmm d, yyyy');\n          return contribText + \"<br />\" + gl.utils.getDayName(date) + \" \" + dateText;\n        };\n      }(this)).attr('class', 'user-contrib-cell js-tooltip').attr('fill', function (_this) {\n        return function (stamp) {\n          if (stamp.count !== 0) {\n            return _this.color(Math.min(stamp.count, 40));\n          } else {\n            return '#ededed';\n          }\n        };\n      }(this)).attr('data-container', 'body').on('click', this.clickDay);\n    };\n\n    Calendar.prototype.renderDayTitles = function () {\n      var days;\n      days = [{\n        text: 'M',\n        y: 29 + this.daySizeWithSpace * 1\n      }, {\n        text: 'W',\n        y: 29 + this.daySizeWithSpace * 3\n      }, {\n        text: 'F',\n        y: 29 + this.daySizeWithSpace * 5\n      }];\n      return this.svg.append('g').selectAll('text').data(days).enter().append('text').attr('text-anchor', 'middle').attr('x', 8).attr('y', function (day) {\n        return day.y;\n      }).text(function (day) {\n        return day.text;\n      }).attr('class', 'user-contrib-text');\n    };\n\n    Calendar.prototype.renderMonths = function () {\n      return this.svg.append('g').attr('direction', 'ltr').selectAll('text').data(this.months).enter().append('text').attr('x', function (date) {\n        return date.x;\n      }).attr('y', 10).attr('class', 'user-contrib-text').text(function (_this) {\n        return function (date) {\n          return _this.monthNames[date.month];\n        };\n      }(this));\n    };\n\n    Calendar.prototype.renderKey = function () {\n      var _this2 = this;\n\n      var keyValues = ['no contributions', '1-9 contributions', '10-19 contributions', '20-29 contributions', '30+ contributions'];\n      var keyColors = ['#ededed', this.colorKey(0), this.colorKey(1), this.colorKey(2), this.colorKey(3)];\n\n      this.svg.append('g').attr('transform', 'translate(18, ' + (this.daySizeWithSpace * 8 + 16) + ')').selectAll('rect').data(keyColors).enter().append('rect').attr('width', this.daySize).attr('height', this.daySize).attr('x', function (color, i) {\n        return _this2.daySizeWithSpace * i;\n      }).attr('y', 0).attr('fill', function (color) {\n        return color;\n      }).attr('class', 'js-tooltip').attr('title', function (color, i) {\n        return keyValues[i];\n      }).attr('data-container', 'body');\n    };\n\n    Calendar.prototype.initColor = function () {\n      var colorRange;\n      colorRange = ['#ededed', this.colorKey(0), this.colorKey(1), this.colorKey(2), this.colorKey(3)];\n      return __WEBPACK_IMPORTED_MODULE_0_d3___default.a.scale.threshold().domain([0, 10, 20, 30]).range(colorRange);\n    };\n\n    Calendar.prototype.initColorKey = function () {\n      return __WEBPACK_IMPORTED_MODULE_0_d3___default.a.scale.linear().range(['#acd5f2', '#254e77']).domain([0, 3]);\n    };\n\n    Calendar.prototype.clickDay = function (stamp) {\n      var formatted_date;\n      if (this.currentSelectedDate !== stamp.date) {\n        this.currentSelectedDate = stamp.date;\n        formatted_date = this.currentSelectedDate.getFullYear() + \"-\" + (this.currentSelectedDate.getMonth() + 1) + \"-\" + this.currentSelectedDate.getDate();\n        return $.ajax({\n          url: this.calendar_activities_path,\n          data: {\n            date: formatted_date\n          },\n          cache: false,\n          dataType: 'html',\n          beforeSend: function beforeSend() {\n            return $('.user-calendar-activities').html('<div class=\"text-center\"><i class=\"fa fa-spinner fa-spin user-calendar-activities-loading\"></i></div>');\n          },\n          success: function success(data) {\n            return $('.user-calendar-activities').html(data);\n          }\n        });\n      } else {\n        this.currentSelectedDate = '';\n        return $('.user-calendar-activities').html('');\n      }\n    };\n\n    Calendar.prototype.initTooltips = function () {\n      return $('.js-contrib-calendar .js-tooltip').tooltip({\n        html: true\n      });\n    };\n\n    return Calendar;\n  }();\n}).call(window);\n/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(\"../../../node_modules/jquery/dist/jquery.js\")))\n\n/***/ }),\n\n/***/ \"./users/users_bundle.js\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__calendar__ = __webpack_require__(\"./users/calendar.js\");\n\n\n/***/ })\n\n},[\"./users/users_bundle.js\"]);\n\n\n// WEBPACK FOOTER //\n// users.2fbd5fa21db161cb22c1.bundle.js","/* eslint-disable func-names, space-before-function-paren, no-var, prefer-rest-params, wrap-iife, camelcase, vars-on-top, object-shorthand, comma-dangle, eqeqeq, no-mixed-operators, no-return-assign, newline-per-chained-call, prefer-arrow-callback, consistent-return, one-var, one-var-declaration-per-line, prefer-template, quotes, no-unused-vars, no-else-return, max-len */\n\nimport d3 from 'd3';\n\n(function() {\n  this.Calendar = (function() {\n    function Calendar(timestamps, calendar_activities_path) {\n      this.calendar_activities_path = calendar_activities_path;\n      this.clickDay = this.clickDay.bind(this);\n      this.currentSelectedDate = '';\n      this.daySpace = 1;\n      this.daySize = 15;\n      this.daySizeWithSpace = this.daySize + (this.daySpace * 2);\n      this.monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n      this.months = [];\n      // Loop through the timestamps to create a group of objects\n      // The group of objects will be grouped based on the day of the week they are\n      this.timestampsTmp = [];\n      var group = 0;\n\n      var today = new Date();\n      today.setHours(0, 0, 0, 0, 0);\n\n      var oneYearAgo = new Date(today);\n      oneYearAgo.setFullYear(today.getFullYear() - 1);\n\n      var days = gl.utils.getDayDifference(oneYearAgo, today);\n\n      for (var i = 0; i <= days; i += 1) {\n        var date = new Date(oneYearAgo);\n        date.setDate(date.getDate() + i);\n\n        var day = date.getDay();\n        var count = timestamps[date.format('yyyy-mm-dd')];\n\n        // Create a new group array if this is the first day of the week\n        // or if is first object\n        if ((day === 0 && i !== 0) || i === 0) {\n          this.timestampsTmp.push([]);\n          group += 1;\n        }\n\n        var innerArray = this.timestampsTmp[group - 1];\n        // Push to the inner array the values that will be used to render map\n        innerArray.push({\n          count: count || 0,\n          date: date,\n          day: day\n        });\n      }\n\n      // Init color functions\n      this.colorKey = this.initColorKey();\n      this.color = this.initColor();\n      // Init the svg element\n      this.renderSvg(group);\n      this.renderDays();\n      this.renderMonths();\n      this.renderDayTitles();\n      this.renderKey();\n      this.initTooltips();\n    }\n\n    // Add extra padding for the last month label if it is also the last column\n    Calendar.prototype.getExtraWidthPadding = function(group) {\n      var extraWidthPadding = 0;\n      var lastColMonth = this.timestampsTmp[group - 1][0].date.getMonth();\n      var secondLastColMonth = this.timestampsTmp[group - 2][0].date.getMonth();\n\n      if (lastColMonth != secondLastColMonth) {\n        extraWidthPadding = 3;\n      }\n\n      return extraWidthPadding;\n    };\n\n    Calendar.prototype.renderSvg = function(group) {\n      var width = (group + 1) * this.daySizeWithSpace + this.getExtraWidthPadding(group);\n      return this.svg = d3.select('.js-contrib-calendar').append('svg').attr('width', width).attr('height', 167).attr('class', 'contrib-calendar');\n    };\n\n    Calendar.prototype.renderDays = function() {\n      return this.svg.selectAll('g').data(this.timestampsTmp).enter().append('g').attr('transform', (function(_this) {\n        return function(group, i) {\n          _.each(group, function(stamp, a) {\n            var lastMonth, lastMonthX, month, x;\n            if (a === 0 && stamp.day === 0) {\n              month = stamp.date.getMonth();\n              x = (_this.daySizeWithSpace * i + 1) + _this.daySizeWithSpace;\n              lastMonth = _.last(_this.months);\n              if (lastMonth != null) {\n                lastMonthX = lastMonth.x;\n              }\n              if (lastMonth == null) {\n                return _this.months.push({\n                  month: month,\n                  x: x\n                });\n              } else if (month !== lastMonth.month && x - _this.daySizeWithSpace !== lastMonthX) {\n                return _this.months.push({\n                  month: month,\n                  x: x\n                });\n              }\n            }\n          });\n          return \"translate(\" + ((_this.daySizeWithSpace * i + 1) + _this.daySizeWithSpace) + \", 18)\";\n        };\n      })(this)).selectAll('rect').data(function(stamp) {\n        return stamp;\n      }).enter().append('rect').attr('x', '0').attr('y', (function(_this) {\n        return function(stamp, i) {\n          return _this.daySizeWithSpace * stamp.day;\n        };\n      })(this)).attr('width', this.daySize).attr('height', this.daySize).attr('title', (function(_this) {\n        return function(stamp) {\n          var contribText, date, dateText;\n          date = new Date(stamp.date);\n          contribText = 'No contributions';\n          if (stamp.count > 0) {\n            contribText = stamp.count + \" contribution\" + (stamp.count > 1 ? 's' : '');\n          }\n          dateText = date.format('mmm d, yyyy');\n          return contribText + \"<br />\" + (gl.utils.getDayName(date)) + \" \" + dateText;\n        };\n      })(this)).attr('class', 'user-contrib-cell js-tooltip').attr('fill', (function(_this) {\n        return function(stamp) {\n          if (stamp.count !== 0) {\n            return _this.color(Math.min(stamp.count, 40));\n          } else {\n            return '#ededed';\n          }\n        };\n      })(this)).attr('data-container', 'body').on('click', this.clickDay);\n    };\n\n    Calendar.prototype.renderDayTitles = function() {\n      var days;\n      days = [\n        {\n          text: 'M',\n          y: 29 + (this.daySizeWithSpace * 1)\n        }, {\n          text: 'W',\n          y: 29 + (this.daySizeWithSpace * 3)\n        }, {\n          text: 'F',\n          y: 29 + (this.daySizeWithSpace * 5)\n        }\n      ];\n      return this.svg.append('g').selectAll('text').data(days).enter().append('text').attr('text-anchor', 'middle').attr('x', 8).attr('y', function(day) {\n        return day.y;\n      }).text(function(day) {\n        return day.text;\n      }).attr('class', 'user-contrib-text');\n    };\n\n    Calendar.prototype.renderMonths = function() {\n      return this.svg.append('g').attr('direction', 'ltr').selectAll('text').data(this.months).enter().append('text').attr('x', function(date) {\n        return date.x;\n      }).attr('y', 10).attr('class', 'user-contrib-text').text((function(_this) {\n        return function(date) {\n          return _this.monthNames[date.month];\n        };\n      })(this));\n    };\n\n    Calendar.prototype.renderKey = function() {\n      const keyValues = ['no contributions', '1-9 contributions', '10-19 contributions', '20-29 contributions', '30+ contributions'];\n      const keyColors = ['#ededed', this.colorKey(0), this.colorKey(1), this.colorKey(2), this.colorKey(3)];\n\n      this.svg.append('g')\n        .attr('transform', `translate(18, ${this.daySizeWithSpace * 8 + 16})`)\n        .selectAll('rect')\n          .data(keyColors)\n          .enter()\n          .append('rect')\n            .attr('width', this.daySize)\n            .attr('height', this.daySize)\n            .attr('x', (color, i) => this.daySizeWithSpace * i)\n            .attr('y', 0)\n            .attr('fill', color => color)\n            .attr('class', 'js-tooltip')\n            .attr('title', (color, i) => keyValues[i])\n            .attr('data-container', 'body');\n    };\n\n    Calendar.prototype.initColor = function() {\n      var colorRange;\n      colorRange = ['#ededed', this.colorKey(0), this.colorKey(1), this.colorKey(2), this.colorKey(3)];\n      return d3.scale.threshold().domain([0, 10, 20, 30]).range(colorRange);\n    };\n\n    Calendar.prototype.initColorKey = function() {\n      return d3.scale.linear().range(['#acd5f2', '#254e77']).domain([0, 3]);\n    };\n\n    Calendar.prototype.clickDay = function(stamp) {\n      var formatted_date;\n      if (this.currentSelectedDate !== stamp.date) {\n        this.currentSelectedDate = stamp.date;\n        formatted_date = this.currentSelectedDate.getFullYear() + \"-\" + (this.currentSelectedDate.getMonth() + 1) + \"-\" + this.currentSelectedDate.getDate();\n        return $.ajax({\n          url: this.calendar_activities_path,\n          data: {\n            date: formatted_date\n          },\n          cache: false,\n          dataType: 'html',\n          beforeSend: function() {\n            return $('.user-calendar-activities').html('<div class=\"text-center\"><i class=\"fa fa-spinner fa-spin user-calendar-activities-loading\"></i></div>');\n          },\n          success: function(data) {\n            return $('.user-calendar-activities').html(data);\n          }\n        });\n      } else {\n        this.currentSelectedDate = '';\n        return $('.user-calendar-activities').html('');\n      }\n    };\n\n    Calendar.prototype.initTooltips = function() {\n      return $('.js-contrib-calendar .js-tooltip').tooltip({\n        html: true\n      });\n    };\n\n    return Calendar;\n  })();\n}).call(window);\n\n\n\n// WEBPACK FOOTER //\n// ./users/calendar.js"],"sourceRoot":""}