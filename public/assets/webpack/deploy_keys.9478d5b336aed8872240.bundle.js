webpackJsonp(["deploy_keys"],{"../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./deploy_keys/components/action_btn.vue":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("./deploy_keys/eventhub.js"),s=n("./vue_shared/components/loading_icon.vue"),i=n.n(s);t.default={data:function(){return{isLoading:!1}},props:{deployKey:{type:Object,required:!0},type:{type:String,required:!0},btnCssClass:{type:String,required:!1,default:"btn-default"}},components:{loadingIcon:i.a},methods:{doAction:function(){this.isLoading=!0,o.a.$emit(this.type+".key",this.deployKey)}},computed:{text:function(){return""+this.type.charAt(0).toUpperCase()+this.type.slice(1)}}}},"../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./deploy_keys/components/app.vue":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("./deploy_keys/eventhub.js"),s=n("./deploy_keys/service/index.js"),i=n("./deploy_keys/store/index.js"),l=n("./deploy_keys/components/keys_panel.vue"),d=n.n(l),r=n("./vue_shared/components/loading_icon.vue"),a=n.n(r);t.default={data:function(){return{isLoading:!1,store:new i.a}},props:{endpoint:{type:String,required:!0}},computed:{hasKeys:function(){return Object.keys(this.keys).length},keys:function(){return this.store.keys}},components:{keysPanel:d.a,loadingIcon:a.a},methods:{fetchKeys:function(){var e=this;this.isLoading=!0,this.service.getKeys().then(function(t){e.isLoading=!1,e.store.keys=t}).catch(function(){return new Flash("Error getting deploy keys")})},enableKey:function(e){var t=this;this.service.enableKey(e.id).then(function(){return t.fetchKeys()}).catch(function(){return new Flash("Error enabling deploy key")})},disableKey:function(e){var t=this;confirm("You are going to remove this deploy key. Are you sure?")&&this.service.disableKey(e.id).then(function(){return t.fetchKeys()}).catch(function(){return new Flash("Error removing deploy key")})}},created:function(){this.service=new s.a(this.endpoint),o.a.$on("enable.key",this.enableKey),o.a.$on("remove.key",this.disableKey),o.a.$on("disable.key",this.disableKey)},mounted:function(){this.fetchKeys()},beforeDestroy:function(){o.a.$off("enable.key",this.enableKey),o.a.$off("remove.key",this.disableKey),o.a.$off("disable.key",this.disableKey)}}},"../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./deploy_keys/components/key.vue":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("./deploy_keys/components/action_btn.vue"),s=n.n(o);t.default={props:{deployKey:{type:Object,required:!0},store:{type:Object,required:!0},endpoint:{type:String,required:!0}},components:{actionBtn:s.a},computed:{timeagoDate:function(){return gl.utils.getTimeago().format(this.deployKey.created_at)},editDeployKeyPath:function(){return this.endpoint+"/"+this.deployKey.id+"/edit"}},methods:{isEnabled:function(e){return void 0!==this.store.findEnabledKey(e)}}}},"../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./deploy_keys/components/keys_panel.vue":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("./deploy_keys/components/key.vue"),s=n.n(o);t.default={props:{title:{type:String,required:!0},keys:{type:Array,required:!0},showHelpBox:{type:Boolean,required:!1,default:!0},store:{type:Object,required:!0},endpoint:{type:String,required:!0}},components:{key:s.a}}},"../../../node_modules/vue-loader/lib/component-normalizer.js":function(e,t){e.exports=function(e,t,n,o){var s,i=e=e||{},l=typeof e.default;"object"!==l&&"function"!==l||(s=e,i=e.default);var d="function"==typeof i?i.options:i;if(t&&(d.render=t.render,d.staticRenderFns=t.staticRenderFns),n&&(d._scopeId=n),o){var r=Object.create(d.computed||null);Object.keys(o).forEach(function(e){var t=o[e];r[e]=function(){return t}}),d.computed=r}return{esModule:s,exports:i,options:d}}},'../../../node_modules/vue-loader/lib/template-compiler/index.js?{"id":"data-v-0cc2cf20"}!../../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./deploy_keys/components/key.vue':function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._m(0),e._v(" "),n("div",{staticClass:"deploy-key-content key-list-item-info"},[n("strong",{staticClass:"title"},[e._v("\n      "+e._s(e.deployKey.title)+"\n    ")]),e._v(" "),n("div",{staticClass:"description"},[e._v("\n      "+e._s(e.deployKey.fingerprint)+"\n    ")]),e._v(" "),e.deployKey.can_push?n("div",{staticClass:"write-access-allowed"},[e._v("\n      Write access allowed\n    ")]):e._e()]),e._v(" "),n("div",{staticClass:"deploy-key-content prepend-left-default deploy-key-projects"},e._l(e.deployKey.projects,function(t){return n("a",{staticClass:"label deploy-project-label",attrs:{href:t.full_path}},[e._v("\n      "+e._s(t.full_name)+"\n    ")])})),e._v(" "),n("div",{staticClass:"deploy-key-content"},[n("span",{staticClass:"key-created-at"},[e._v("\n      created "+e._s(e.timeagoDate)+"\n    ")]),e._v(" "),e.deployKey.can_edit?n("a",{staticClass:"btn btn-small",attrs:{href:e.editDeployKeyPath}},[e._v("\n      Edit\n    ")]):e._e(),e._v(" "),e.isEnabled(e.deployKey.id)?e.deployKey.destroyed_when_orphaned&&e.deployKey.almost_orphaned?n("action-btn",{attrs:{"deploy-key":e.deployKey,"btn-css-class":"btn-warning",type:"remove"}}):n("action-btn",{attrs:{"deploy-key":e.deployKey,"btn-css-class":"btn-warning",type:"disable"}}):n("action-btn",{attrs:{"deploy-key":e.deployKey,type:"enable"}})],1)])},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pull-left append-right-10 hidden-xs"},[n("i",{staticClass:"fa fa-key key-icon",attrs:{"aria-hidden":"true"}})])}]}},'../../../node_modules/vue-loader/lib/template-compiler/index.js?{"id":"data-v-0e0af9e2"}!../../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./deploy_keys/components/app.vue':function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"append-bottom-default deploy-keys"},[e.isLoading&&!e.hasKeys?n("loading-icon",{attrs:{size:"2",label:"Loading deploy keys"}}):e.hasKeys?n("div",[n("keys-panel",{attrs:{title:"Enabled deploy keys for this project",keys:e.keys.enabled_keys,store:e.store,endpoint:e.endpoint}}),e._v(" "),n("keys-panel",{attrs:{title:"Deploy keys from projects you have access to",keys:e.keys.available_project_keys,store:e.store,endpoint:e.endpoint}}),e._v(" "),e.keys.public_keys.length?n("keys-panel",{attrs:{title:"Public deploy keys available to any project",keys:e.keys.public_keys,store:e.store,endpoint:e.endpoint}}):e._e()],1):e._e()],1)},staticRenderFns:[]}},'../../../node_modules/vue-loader/lib/template-compiler/index.js?{"id":"data-v-3feb27bc"}!../../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./deploy_keys/components/action_btn.vue':function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{staticClass:"btn btn-sm prepend-left-10",class:[{disabled:e.isLoading},e.btnCssClass],attrs:{disabled:e.isLoading},on:{click:e.doAction}},[e._v("\n  "+e._s(e.text)+"\n  "),e.isLoading?n("loading-icon"):e._e()],1)},staticRenderFns:[]}},'../../../node_modules/vue-loader/lib/template-compiler/index.js?{"id":"data-v-c828c770"}!../../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./deploy_keys/components/keys_panel.vue':function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"deploy-keys-panel"},[n("h5",[e._v("\n    "+e._s(e.title)+"\n    ("+e._s(e.keys.length)+")\n  ")]),e._v(" "),e.keys.length?n("ul",{staticClass:"well-list"},e._l(e.keys,function(t){return n("li",{key:t.id},[n("key",{attrs:{"deploy-key":t,store:e.store,endpoint:e.endpoint}})],1)})):e.showHelpBox?n("div",{staticClass:"settings-message text-center"},[e._v("\n    No deploy keys found. Create one with the form above.\n  ")]):e._e()])},staticRenderFns:[]}},"./deploy_keys/components/action_btn.vue":function(e,t,n){var o=n("../../../node_modules/vue-loader/lib/component-normalizer.js")(n("../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./deploy_keys/components/action_btn.vue"),n('../../../node_modules/vue-loader/lib/template-compiler/index.js?{"id":"data-v-3feb27bc"}!../../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./deploy_keys/components/action_btn.vue'),null,null);e.exports=o.exports},"./deploy_keys/components/app.vue":function(e,t,n){var o=n("../../../node_modules/vue-loader/lib/component-normalizer.js")(n("../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./deploy_keys/components/app.vue"),n('../../../node_modules/vue-loader/lib/template-compiler/index.js?{"id":"data-v-0e0af9e2"}!../../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./deploy_keys/components/app.vue'),null,null);e.exports=o.exports},"./deploy_keys/components/key.vue":function(e,t,n){var o=n("../../../node_modules/vue-loader/lib/component-normalizer.js")(n("../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./deploy_keys/components/key.vue"),n('../../../node_modules/vue-loader/lib/template-compiler/index.js?{"id":"data-v-0cc2cf20"}!../../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./deploy_keys/components/key.vue'),null,null);e.exports=o.exports},"./deploy_keys/components/keys_panel.vue":function(e,t,n){var o=n("../../../node_modules/vue-loader/lib/component-normalizer.js")(n("../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./deploy_keys/components/keys_panel.vue"),n('../../../node_modules/vue-loader/lib/template-compiler/index.js?{"id":"data-v-c828c770"}!../../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./deploy_keys/components/keys_panel.vue'),null,null);e.exports=o.exports},"./deploy_keys/eventhub.js":function(e,t,n){"use strict";var o=n("../../../node_modules/vue/dist/vue.esm.js");t.a=new o.default},"./deploy_keys/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("../../../node_modules/vue/dist/vue.esm.js"),s=n("./deploy_keys/components/app.vue"),i=n.n(s);document.addEventListener("DOMContentLoaded",function(){return new o.default({el:document.getElementById("js-deploy-keys"),data:function(){return{endpoint:this.$options.el.dataset.endpoint}},components:{deployKeysApp:i.a},render:function(e){return e("deploy-keys-app",{props:{endpoint:this.endpoint}})}})})},"./deploy_keys/service/index.js":function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=n("../../../node_modules/vue/dist/vue.esm.js"),i=n("../../../node_modules/vue-resource/dist/vue-resource.common.js"),l=n.n(i),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();s.default.use(l.a);var r=function(){function e(t){o(this,e),this.endpoint=t,this.resource=s.default.resource(this.endpoint+"{/id}",{},{enable:{method:"PUT",url:this.endpoint+"{/id}/enable"},disable:{method:"PUT",url:this.endpoint+"{/id}/disable"}})}return d(e,[{key:"getKeys",value:function(){return this.resource.get().then(function(e){return e.json()})}},{key:"enableKey",value:function(e){return this.resource.enable({id:e},{})}},{key:"disableKey",value:function(e){return this.resource.disable({id:e},{})}}]),e}();t.a=r},"./deploy_keys/store/index.js":function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=function(){function e(){o(this,e),this.keys={}}return s(e,[{key:"findEnabledKey",value:function(e){return this.keys.enabled_keys.find(function(t){return t.id===e})}}]),e}();t.a=i}},["./deploy_keys/index.js"]);
//# sourceMappingURL=deploy_keys.9478d5b336aed8872240.bundle.js.map